var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:!0,_getScriptLocation:function(){for(var h=/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/,g=document.getElementsByTagName("script"),l,k="",j=0,i=g.length;j<i;j++){if(l=g[j].getAttribute("src")){if(l=l.match(h)){k=l[1];break}}}return function(){return k}}(),ImgPath:""};OpenLayers.Class=function(){var f=arguments.length,e=arguments[0],h=arguments[f-1],g="function"==typeof h.initialize?h.initialize:function(){e.prototype.initialize.apply(this,arguments)};1<f?(f=[g,e].concat(Array.prototype.slice.call(arguments).slice(1,f-1),h),OpenLayers.inherit.apply(null,f)):g.prototype=h;return g};OpenLayers.inherit=function(g,f){var j=function(){};j.prototype=f.prototype;g.prototype=new j;var i,h,j=2;for(i=arguments.length;j<i;j++){h=arguments[j],"function"===typeof h&&(h=h.prototype),OpenLayers.Util.extend(g.prototype,h)}};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.extend=function(f,e){f=f||{};if(e){for(var h in e){var g=e[h];void 0!==g&&(f[h]=g)}!("function"==typeof window.Event&&e instanceof window.Event)&&(e.hasOwnProperty&&e.hasOwnProperty("toString"))&&(f.toString=e.toString)}return f};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(d,c){this.x=parseFloat(d);this.y=parseFloat(c)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(d){var c=!1;null!=d&&(c=this.x==d.x&&this.y==d.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(d.x)&&isNaN(d.y));return c},distanceTo:function(b){return Math.sqrt(Math.pow(this.x-b.x,2)+Math.pow(this.y-b.y,2))},add:function(d,c){if(null==d||null==c){throw new TypeError("Pixel.add cannot receive null values")}return new OpenLayers.Pixel(this.x+d,this.y+c)},offset:function(d){var c=this.clone();d&&(c=this.add(d.x,d.y));return c},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.String={startsWith:function(d,c){return 0==d.indexOf(c)},contains:function(d,c){return -1!=d.indexOf(c)},trim:function(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(g){for(var g=g.split("-"),f=g[0],j=1,i=g.length;j<i;j++){var h=g[j],f=f+(h.charAt(0).toUpperCase()+h.substring(1))}return f},format:function(e,d,f){d||(d=window);return e.replace(OpenLayers.String.tokenRegEx,function(b,k){for(var j,i=k.split(/\.+/),c=0;c<i.length;c++){0==c&&(j=d),j=j[i[c]]}"function"==typeof j&&(j=f?j.apply(null,f):j());return"undefined"==typeof j?"undefined":j})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(b){return OpenLayers.String.numberRegEx.test(b)},numericIf:function(b){return OpenLayers.String.isNumeric(b)?parseFloat(b):b}};OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(e,d){var f=0;0<d&&(f=parseFloat(e.toPrecision(d)));return f},format:function(h,g,l,k){g="undefined"!=typeof g?g:0;l="undefined"!=typeof l?l:OpenLayers.Number.thousandsSeparator;k="undefined"!=typeof k?k:OpenLayers.Number.decimalSeparator;null!=g&&(h=parseFloat(h.toFixed(g)));var j=h.toString().split(".");1==j.length&&null==g&&(g=0);h=j[0];if(l){for(var i=/(-?[0-9]+)([0-9]{3})/;i.test(h);){h=h.replace(i,"$1"+l+"$2")}}0==g?g=h:(l=1<j.length?j[1]:"0",null!=g&&(l+=Array(g-l.length+1).join("0")),g=h+k+l);return g}};OpenLayers.Function={bind:function(e,d){var f=Array.prototype.slice.apply(arguments,[2]);return function(){var a=f.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(d,a)}},bindAsEventListener:function(d,c){return function(a){return d.call(c,a||window.event)}},False:function(){return !1},True:function(){return !0},Void:function(){}};OpenLayers.Array={filter:function(i,h,n){var m=[];if(Array.prototype.filter){m=i.filter(h,n)}else{var l=i.length;if("function"!=typeof h){throw new TypeError}for(var k=0;k<l;k++){if(k in i){var j=i[k];h.call(n,j,k,i)&&m.push(j)}}}return m}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(f,e,h,g){OpenLayers.Util.isArray(f)&&(g=f[3],h=f[2],e=f[1],f=f[0]);null!=f&&(this.left=OpenLayers.Util.toFloat(f));null!=e&&(this.bottom=OpenLayers.Util.toFloat(e));null!=h&&(this.right=OpenLayers.Util.toFloat(h));null!=g&&(this.top=OpenLayers.Util.toFloat(g))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(d){var c=!1;null!=d&&(c=this.left==d.left&&this.right==d.right&&this.top==d.top&&this.bottom==d.bottom);return c},toString:function(){return[this.left,this.bottom,this.right,this.top].join()},toArray:function(b){return !0===b?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(h,g){null==h&&(h=6);var l=Math.pow(10,h),k=Math.round(this.left*l)/l,j=Math.round(this.bottom*l)/l,i=Math.round(this.right*l)/l,l=Math.round(this.top*l)/l;return !0===g?j+","+k+","+l+","+i:k+","+j+","+i+","+l},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2));return this.centerLonLat},scale:function(f,e){null==e&&(e=this.getCenterLonLat());var h,g;"OpenLayers.LonLat"==e.CLASS_NAME?(h=e.lon,g=e.lat):(h=e.x,g=e.y);return new OpenLayers.Bounds((this.left-h)*f+h,(this.bottom-g)*f+g,(this.right-h)*f+h,(this.top-g)*f+g)},add:function(d,c){if(null==d||null==c){throw new TypeError("Bounds.add cannot receive null values")}return new OpenLayers.Bounds(this.left+d,this.bottom+c,this.right+d,this.top+c)},extend:function(d){var c=null;if(d){switch(d.CLASS_NAME){case"OpenLayers.LonLat":c=new OpenLayers.Bounds(d.lon,d.lat,d.lon,d.lat);break;case"OpenLayers.Geometry.Point":c=new OpenLayers.Bounds(d.x,d.y,d.x,d.y);break;case"OpenLayers.Bounds":c=d}if(c){this.centerLonLat=null;if(null==this.left||c.left<this.left){this.left=c.left}if(null==this.bottom||c.bottom<this.bottom){this.bottom=c.bottom}if(null==this.right||c.right>this.right){this.right=c.right}if(null==this.top||c.top>this.top){this.top=c.top}}}},containsLonLat:function(f,e){"boolean"===typeof e&&(e={inclusive:e});var e=e||{},h=this.contains(f.lon,f.lat,e.inclusive),g=e.worldBounds;g&&!h&&(h=g.getWidth(),g=Math.round((f.lon-(g.left+g.right)/2)/h),h=this.containsLonLat({lon:f.lon-g*h,lat:f.lat},{inclusive:e.inclusive}));return h},containsPixel:function(d,c){return this.contains(d.x,d.y,c)},contains:function(f,e,h){null==h&&(h=!0);if(null==f||null==e){return !1}var f=OpenLayers.Util.toFloat(f),e=OpenLayers.Util.toFloat(e),g=!1;return g=h?f>=this.left&&f<=this.right&&e>=this.bottom&&e<=this.top:f>this.left&&f<this.right&&e>this.bottom&&e<this.top},intersectsBounds:function(i,h){"boolean"===typeof h&&(h={inclusive:h});h=h||{};if(h.worldBounds){var n=this.wrapDateLine(h.worldBounds),i=i.wrapDateLine(h.worldBounds)}else{n=this}null==h.inclusive&&(h.inclusive=!0);var m=!1,l=n.left==i.right||n.right==i.left||n.top==i.bottom||n.bottom==i.top;if(h.inclusive||!l){var m=i.top>=n.bottom&&i.top<=n.top||n.top>i.bottom&&n.top<i.top,l=i.left>=n.left&&i.left<=n.right||n.left>=i.left&&n.left<=i.right,k=i.right>=n.left&&i.right<=n.right||n.right>=i.left&&n.right<=i.right,m=(i.bottom>=n.bottom&&i.bottom<=n.top||n.bottom>=i.bottom&&n.bottom<=i.top||m)&&(l||k)}if(h.worldBounds&&!m){var j=h.worldBounds,l=j.getWidth(),k=!j.containsBounds(n),j=!j.containsBounds(i);k&&!j?(i=i.add(-l,0),m=n.intersectsBounds(i,{inclusive:h.inclusive})):j&&!k&&(n=n.add(-l,0),m=i.intersectsBounds(n,{inclusive:h.inclusive}))}return m},containsBounds:function(h,g,l){null==g&&(g=!1);null==l&&(l=!0);var k=this.contains(h.left,h.bottom,l),j=this.contains(h.right,h.bottom,l),i=this.contains(h.left,h.top,l),h=this.contains(h.right,h.top,l);return g?k||j||i||h:k&&j&&i&&h},determineQuadrant:function(e){var d="",f=this.getCenterLonLat(),d=d+(e.lat<f.lat?"b":"t");return d+=e.lon<f.lon?"l":"r"},transform:function(h,g){this.centerLonLat=null;var l=OpenLayers.Projection.transform({x:this.left,y:this.bottom},h,g),k=OpenLayers.Projection.transform({x:this.right,y:this.bottom},h,g),j=OpenLayers.Projection.transform({x:this.left,y:this.top},h,g),i=OpenLayers.Projection.transform({x:this.right,y:this.top},h,g);this.left=Math.min(l.x,j.x);this.bottom=Math.min(l.y,k.y);this.right=Math.max(k.x,i.x);this.top=Math.max(j.y,i.y);return this},wrapDateLine:function(h,g){var g=g||{},l=g.leftTolerance||0,k=g.rightTolerance||0,j=this.clone();if(h){for(var i=h.getWidth();j.left<h.left&&j.right-k<=h.left;){j=j.add(i,0)}for(;j.left+l>=h.right&&j.right>h.right;){j=j.add(-i,0)}l=j.left+l;l<h.right&&(l>h.left&&j.right-k>h.right)&&(j=j.add(-i,0))}return j},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(e,d){var f=e.split(",");return OpenLayers.Bounds.fromArray(f,d)};OpenLayers.Bounds.fromArray=function(d,c){return !0===c?new OpenLayers.Bounds(d[1],d[0],d[3],d[2]):new OpenLayers.Bounds(d[0],d[1],d[2],d[3])};OpenLayers.Bounds.fromSize=function(b){return new OpenLayers.Bounds(0,b.h,b.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(d){var c;c=""+("t"==d.charAt(0)?"b":"t");return c+="l"==d.charAt(1)?"r":"l"};OpenLayers.Element={visible:function(b){return"none"!=OpenLayers.Util.getElement(b).style.display},toggle:function(){for(var f=0,e=arguments.length;f<e;f++){var h=OpenLayers.Util.getElement(arguments[f]),g=OpenLayers.Element.visible(h)?"none":"";h.style.display=g}},remove:function(b){b=OpenLayers.Util.getElement(b);b.parentNode.removeChild(b)},getHeight:function(b){b=OpenLayers.Util.getElement(b);return b.offsetHeight},hasClass:function(e,d){var f=e.className;return !!f&&RegExp("(^|\\s)"+d+"(\\s|$)").test(f)},addClass:function(d,c){OpenLayers.Element.hasClass(d,c)||(d.className+=(d.className?" ":"")+c);return d},removeClass:function(e,d){var f=e.className;f&&(e.className=OpenLayers.String.trim(f.replace(RegExp("(^|\\s+)"+d+"(\\s+|$)")," ")));return e},toggleClass:function(d,c){OpenLayers.Element.hasClass(d,c)?OpenLayers.Element.removeClass(d,c):OpenLayers.Element.addClass(d,c);return d},getStyle:function(f,e){var f=OpenLayers.Util.getElement(f),h=null;if(f&&f.style){h=f.style[OpenLayers.String.camelize(e)];h||(document.defaultView&&document.defaultView.getComputedStyle?h=(h=document.defaultView.getComputedStyle(f,null))?h.getPropertyValue(e):null:f.currentStyle&&(h=f.currentStyle[OpenLayers.String.camelize(e)]));var g=["left","top","right","bottom"];window.opera&&(-1!=OpenLayers.Util.indexOf(g,e)&&"static"==OpenLayers.Element.getStyle(f,"position"))&&(h="auto")}return"auto"==h?null:h}};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(d,c){OpenLayers.Util.isArray(d)&&(c=d[1],d=d[0]);this.lon=OpenLayers.Util.toFloat(d);this.lat=OpenLayers.Util.toFloat(c)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(d,c){if(null==d||null==c){throw new TypeError("LonLat.add cannot receive null values")}return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(d),this.lat+OpenLayers.Util.toFloat(c))},equals:function(d){var c=!1;null!=d&&(c=this.lon==d.lon&&this.lat==d.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(d.lon)&&isNaN(d.lat));return c},transform:function(e,d){var f=OpenLayers.Projection.transform({x:this.lon,y:this.lat},e,d);this.lon=f.x;this.lat=f.y;return this},wrapDateLine:function(d){var c=this.clone();if(d){for(;c.lon<d.left;){c.lon+=d.getWidth()}for(;c.lon>d.right;){c.lon-=d.getWidth()}}return c},CLASS_NAME:"OpenLayers.LonLat"});OpenLayers.LonLat.fromString=function(b){b=b.split(",");return new OpenLayers.LonLat(b[0],b[1])};OpenLayers.LonLat.fromArray=function(d){var c=OpenLayers.Util.isArray(d);return new OpenLayers.LonLat(c&&d[0],c&&d[1])};OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(d,c){this.w=parseFloat(d);this.h=parseFloat(c)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(d){var c=!1;null!=d&&(c=this.w==d.w&&this.h==d.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(d.w)&&isNaN(d.h));return c},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(b){alert(b)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};(function(){for(var e=document.getElementsByTagName("script"),d=0,f=e.length;d<f;++d){if(-1!=e[d].src.indexOf("firebug.js")&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}})();OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(e){var d;e||(e="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);e=e.split("-");e[0]=e[0].toLowerCase();"object"==typeof OpenLayers.Lang[e[0]]&&(d=e[0]);if(e[1]){var f=e[0]+"-"+e[1].toUpperCase();"object"==typeof OpenLayers.Lang[f]&&(d=f)}d||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+e.join("-")+" dictionary, falling back to default language"),d=OpenLayers.Lang.defaultCode);OpenLayers.Lang.code=d},translate:function(e,d){var f=OpenLayers.Lang[OpenLayers.Lang.getCode()];(f=f&&f[e])||(f=e);d&&(f=OpenLayers.String.format(f,d));return f}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){for(var f=[],e=0,h=arguments.length;e<h;e++){var g=arguments[e];"string"==typeof g&&(g=document.getElementById(g));if(1==arguments.length){return g}f.push(g)}return f};OpenLayers.Util.isElement=function(b){return !!(b&&1===b.nodeType)};OpenLayers.Util.isArray=function(b){return"[object Array]"===Object.prototype.toString.call(b)};"undefined"===typeof window.$&&(window.$=OpenLayers.Util.getElement);OpenLayers.Util.removeItem=function(e,d){for(var f=e.length-1;f>=0;f--){e[f]==d&&e.splice(f,1)}return e};OpenLayers.Util.indexOf=function(f,e){if(typeof f.indexOf=="function"){return f.indexOf(e)}for(var h=0,g=f.length;h<g;h++){if(f[h]==e){return h}}return -1};OpenLayers.Util.modifyDOMElement=function(j,i,p,o,n,m,l,k){if(i){j.id=i}if(p){j.style.left=p.x+"px";j.style.top=p.y+"px"}if(o){j.style.width=o.w+"px";j.style.height=o.h+"px"}if(n){j.style.position=n}if(m){j.style.border=m}if(l){j.style.overflow=l}if(parseFloat(k)>=0&&parseFloat(k)<1){j.style.filter="alpha(opacity="+k*100+")";j.style.opacity=k}else{if(parseFloat(k)==1){j.style.filter="";j.style.opacity=""}}};OpenLayers.Util.createDiv=function(r,q,p,o,n,m,l,k){var j=document.createElement("div");if(o){j.style.backgroundImage="url("+o+")"}r||(r=OpenLayers.Util.createUniqueID("OpenLayersDiv"));n||(n="absolute");OpenLayers.Util.modifyDOMElement(j,r,q,p,n,m,l,k);return j};OpenLayers.Util.createImage=function(r,q,p,o,n,m,l,k){var j=document.createElement("img");r||(r=OpenLayers.Util.createUniqueID("OpenLayersDiv"));n||(n="relative");OpenLayers.Util.modifyDOMElement(j,r,q,p,n,m,null,l);if(k){j.style.display="none";q=function(){j.style.display="";OpenLayers.Event.stopObservingElement(j)};OpenLayers.Event.observe(j,"load",q);OpenLayers.Event.observe(j,"error",q)}j.style.alt=r;j.galleryImg="no";if(o){j.src=o}return j};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var e=navigator.appVersion.split("MSIE"),e=parseFloat(e[1]),d=false;try{d=!!document.body.filters}catch(f){}OpenLayers.Util.alphaHackNeeded=d&&e>=5.5&&e<7}return OpenLayers.Util.alphaHackNeeded};OpenLayers.Util.modifyAlphaImageDiv=function(r,q,p,o,n,m,l,k,j){OpenLayers.Util.modifyDOMElement(r,q,p,o,m,null,null,j);q=r.childNodes[0];if(n){q.src=n}OpenLayers.Util.modifyDOMElement(q,r.id+"_innerImage",null,o,"relative",l);if(OpenLayers.Util.alphaHack()){if(r.style.display!="none"){r.style.display="inline-block"}k==null&&(k="scale");r.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+q.src+"', sizingMethod='"+k+"')";if(parseFloat(r.style.opacity)>=0&&parseFloat(r.style.opacity)<1){r.style.filter=r.style.filter+(" alpha(opacity="+r.style.opacity*100+")")}q.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(t,s,r,q,p,o,n,m,l){var k=OpenLayers.Util.createDiv(),l=OpenLayers.Util.createImage(null,null,null,null,null,null,null,l);l.className="olAlphaImg";k.appendChild(l);OpenLayers.Util.modifyAlphaImageDiv(k,t,s,r,q,p,o,n,m);return k};OpenLayers.Util.upperCaseObject=function(e){var d={},f;for(f in e){d[f.toUpperCase()]=e[f]}return d};OpenLayers.Util.applyDefaults=function(f,e){var f=f||{},h=typeof window.Event=="function"&&e instanceof window.Event,g;for(g in e){if(f[g]===void 0||!h&&e.hasOwnProperty&&e.hasOwnProperty(g)&&!f.hasOwnProperty(g)){f[g]=e[g]}}if(!h&&e&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&!f.hasOwnProperty("toString")){f.toString=e.toString}return f};OpenLayers.Util.getParameterString=function(j){var i=[],p;for(p in j){var o=j[p];if(o!=null&&typeof o!="function"){if(typeof o=="object"&&o.constructor==Array){for(var n=[],m,l=0,k=o.length;l<k;l++){m=o[l];n.push(encodeURIComponent(m===null||m===void 0?"":m))}o=n.join(",")}else{o=encodeURIComponent(o)}i.push(encodeURIComponent(p)+"="+o)}}return i.join("&")};OpenLayers.Util.urlAppend=function(f,e){var h=f;if(e){var g=(f+" ").split(/[?&]/),h=h+(g.pop()===" "?e:g.length?"&"+e:"?"+e)}return h};OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(b){return OpenLayers.Util.getImagesLocation()+b};OpenLayers.Util.Try=function(){for(var g=null,f=0,j=arguments.length;f<j;f++){var i=arguments[f];try{g=i();break}catch(h){}}return g};OpenLayers.Util.getXmlNodeValue=function(d){var c=null;OpenLayers.Util.Try(function(){c=d.text;if(!c){c=d.textContent}if(!c){c=d.firstChild.nodeValue}},function(){c=d.textContent});return c};OpenLayers.Util.mouseLeft=function(e,d){for(var f=e.relatedTarget?e.relatedTarget:e.toElement;f!=d&&f!=null;){f=f.parentNode}return f!=d};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(d,c){if(c==null){c=OpenLayers.Util.DEFAULT_PRECISION}typeof d!=="number"&&(d=parseFloat(d));return c===0?d:parseFloat(d.toPrecision(c))};OpenLayers.Util.rad=function(b){return b*Math.PI/180};OpenLayers.Util.deg=function(b){return b*180/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};OpenLayers.Util.distVincenty=function(N,M){for(var L=OpenLayers.Util.VincentyConstants,K=L.a,J=L.b,L=L.f,I=OpenLayers.Util.rad(M.lon-N.lon),H=Math.atan((1-L)*Math.tan(OpenLayers.Util.rad(N.lat))),G=Math.atan((1-L)*Math.tan(OpenLayers.Util.rad(M.lat))),F=Math.sin(H),H=Math.cos(H),E=Math.sin(G),G=Math.cos(G),D=I,z=2*Math.PI,B=20;Math.abs(D-z)>1e-12&&--B>0;){var C=Math.sin(D),A=Math.cos(D),x=Math.sqrt(G*C*G*C+(H*E-F*G*A)*(H*E-F*G*A));if(x==0){return 0}var A=F*E+H*G*A,y=Math.atan2(x,A),w=Math.asin(H*G*C/x),v=Math.cos(w)*Math.cos(w),C=A-2*F*E/v,u=L/16*v*(4+L*(4-3*v)),z=D,D=I+(1-u)*L*Math.sin(w)*(y+u*x*(C+u*A*(-1+2*C*C)))}if(B==0){return NaN}K=v*(K*K-J*J)/(J*J);L=K/1024*(256+K*(-128+K*(74-47*K)));return(J*(1+K/16384*(4096+K*(-768+K*(320-175*K))))*(y-L*x*(C+L/4*(A*(-1+2*C*C)-L/6*C*(-3+4*x*x)*(-3+4*C*C))))).toFixed(3)/1000};OpenLayers.Util.destinationVincenty=function(N,M,L){for(var K=OpenLayers.Util,J=K.VincentyConstants,I=J.a,H=J.b,G=J.f,J=N.lon,N=N.lat,F=K.rad(M),M=Math.sin(F),F=Math.cos(F),N=(1-G)*Math.tan(K.rad(N)),E=1/Math.sqrt(1+N*N),D=N*E,z=Math.atan2(N,F),N=E*M,B=1-N*N,I=B*(I*I-H*H)/(H*H),C=1+I/16384*(4096+I*(-768+I*(320-175*I))),A=I/1024*(256+I*(-128+I*(74-47*I))),I=L/(H*C),x=2*Math.PI;Math.abs(I-x)>1e-12;){var y=Math.cos(2*z+I),w=Math.sin(I),v=Math.cos(I),u=A*w*(y+A/4*(v*(-1+2*y*y)-A/6*y*(-3+4*w*w)*(-3+4*y*y))),x=I,I=L/(H*C)+u}L=D*w-E*v*F;H=Math.atan2(D*v+E*w*F,(1-G)*Math.sqrt(N*N+L*L));M=Math.atan2(w*M,E*v-D*w*F);F=G/16*B*(4+G*(4-3*B));y=M-(1-F)*G*N*(I+F*w*(y+F*v*(-1+2*y*y)));Math.atan2(N,-L);return new OpenLayers.LonLat(J+K.deg(y),K.deg(H))};OpenLayers.Util.getParameters=function(j){var j=j===null||j===void 0?window.location.href:j,i="";if(OpenLayers.String.contains(j,"?")){var i=j.indexOf("?")+1,p=OpenLayers.String.contains(j,"#")?j.indexOf("#"):j.length,i=j.substring(i,p)}for(var j={},i=i.split(/[&;]/),p=0,o=i.length;p<o;++p){var n=i[p].split("=");if(n[0]){var m=n[0];try{m=decodeURIComponent(m)}catch(l){m=unescape(m)}n=(n[1]||"").replace(/\+/g," ");try{n=decodeURIComponent(n)}catch(k){n=unescape(n)}n=n.split(",");n.length==1&&(n=n[0]);j[m]=n}}return j};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(b){b==null&&(b="id_");OpenLayers.Util.lastSeqID=OpenLayers.Util.lastSeqID+1;return b+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;OpenLayers.METERS_PER_INCH=0.0254000508001016;OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:0.0000254/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1000/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":50000/OpenLayers.METERS_PER_INCH,"150kilometers":150000/OpenLayers.METERS_PER_INCH});OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1000,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1000*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(b){return b>1?1/b:b};OpenLayers.Util.getResolutionFromScale=function(e,d){var f;if(e){d==null&&(d="degrees");f=1/(OpenLayers.Util.normalizeScale(e)*OpenLayers.INCHES_PER_UNIT[d]*OpenLayers.DOTS_PER_INCH)}return f};OpenLayers.Util.getScaleFromResolution=function(d,c){c==null&&(c="degrees");return d*OpenLayers.INCHES_PER_UNIT[c]*OpenLayers.DOTS_PER_INCH};OpenLayers.Util.pagePosition=function(g){var f=[0,0],j=OpenLayers.Util.getViewportElement();if(!g||g==window||g==j){return f}var i=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(g,"position")=="absolute"&&(g.style.top==""||g.style.left==""),h=null;if(g.getBoundingClientRect){g=g.getBoundingClientRect();h=j.scrollTop;f[0]=g.left+j.scrollLeft;f[1]=g.top+h}else{if(document.getBoxObjectFor&&!i){g=document.getBoxObjectFor(g);j=document.getBoxObjectFor(j);f[0]=g.screenX-j.screenX;f[1]=g.screenY-j.screenY}else{f[0]=g.offsetLeft;f[1]=g.offsetTop;h=g.offsetParent;if(h!=g){for(;h;){f[0]=f[0]+h.offsetLeft;f[1]=f[1]+h.offsetTop;h=h.offsetParent}}j=OpenLayers.BROWSER_NAME;if(j=="opera"||j=="safari"&&OpenLayers.Element.getStyle(g,"position")=="absolute"){f[1]=f[1]-document.body.offsetTop}for(h=g.offsetParent;h&&h!=document.body;){f[0]=f[0]-h.scrollLeft;if(j!="opera"||h.tagName!="TR"){f[1]=f[1]-h.scrollTop}h=h.offsetParent}}}return f};OpenLayers.Util.getViewportElement=function(){var b=arguments.callee.viewportElement;if(b==void 0){b=OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat"?document.body:document.documentElement;arguments.callee.viewportElement=b}return b};OpenLayers.Util.isEquivalentUrl=function(f,e,h){h=h||{};OpenLayers.Util.applyDefaults(h,{ignoreCase:true,ignorePort80:true,ignoreHash:true});var f=OpenLayers.Util.createUrlObject(f,h),e=OpenLayers.Util.createUrlObject(e,h),g;for(g in f){if(g!=="args"&&f[g]!=e[g]){return false}}for(g in f.args){if(f.args[g]!=e.args[g]){return false}delete e.args[g]}for(g in e.args){return false}return true};OpenLayers.Util.createUrlObject=function(g,f){f=f||{};if(!/^\w+:\/\//.test(g)){var j=window.location,i=j.port?":"+j.port:"",i=j.protocol+"//"+j.host.split(":").shift()+i;if(g.indexOf("/")===0){g=i+g}else{j=j.pathname.split("/");j.pop();g=i+j.join("/")+"/"+g}}f.ignoreCase&&(g=g.toLowerCase());j=document.createElement("a");j.href=g;i={};i.host=j.host.split(":").shift();i.protocol=j.protocol;i.port=f.ignorePort80?j.port=="80"||j.port=="0"?"":j.port:j.port==""||j.port=="0"?"80":j.port;i.hash=f.ignoreHash||j.hash==="#"?"":j.hash;var h=j.search;if(!h){h=g.indexOf("?");h=h!=-1?g.substr(h):""}i.args=OpenLayers.Util.getParameters(h);i.pathname=j.pathname.charAt(0)=="/"?j.pathname:"/"+j.pathname;return i};OpenLayers.Util.removeTail=function(e){var d=null,d=e.indexOf("?"),f=e.indexOf("#");return d=d==-1?f!=-1?e.substr(0,f):e:f!=-1?e.substr(0,Math.min(d,f)):e.substr(0,d)};OpenLayers.IS_GECKO=function(){var b=navigator.userAgent.toLowerCase();return b.indexOf("webkit")==-1&&b.indexOf("gecko")!=-1}();OpenLayers.CANVAS_SUPPORTED=function(){var b=document.createElement("canvas");return !(!b.getContext||!b.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var d="",c=navigator.userAgent.toLowerCase();c.indexOf("opera")!=-1?d="opera":c.indexOf("msie")!=-1?d="msie":c.indexOf("safari")!=-1?d="safari":c.indexOf("mozilla")!=-1&&(d=c.indexOf("firefox")!=-1?"firefox":"mozilla");return d}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};OpenLayers.Util.getRenderedDimensions=function(v,u,t){var s,r,q=document.createElement("div");q.style.visibility="hidden";for(var p=t&&t.containerElement?t.containerElement:document.body,o=false,n=null,m=p;m&&m.tagName.toLowerCase()!="body";){var l=OpenLayers.Element.getStyle(m,"position");if(l=="absolute"){o=true;break}else{if(l&&l!="static"){break}}m=m.parentNode}if(o&&(p.clientHeight===0||p.clientWidth===0)){n=document.createElement("div");n.style.visibility="hidden";n.style.position="absolute";n.style.overflow="visible";n.style.width=document.body.clientWidth+"px";n.style.height=document.body.clientHeight+"px";n.appendChild(q)}q.style.position="absolute";if(u){if(u.w){s=u.w;q.style.width=s+"px"}else{if(u.h){r=u.h;q.style.height=r+"px"}}}if(t&&t.displayClass){q.className=t.displayClass}u=document.createElement("div");u.innerHTML=v;u.style.overflow="visible";if(u.childNodes){v=0;for(t=u.childNodes.length;v<t;v++){if(u.childNodes[v].style){u.childNodes[v].style.overflow="visible"}}}q.appendChild(u);n?p.appendChild(n):p.appendChild(q);if(!s){s=parseInt(u.scrollWidth);q.style.width=s+"px"}r||(r=parseInt(u.scrollHeight));q.removeChild(u);if(n){n.removeChild(q);p.removeChild(n)}else{p.removeChild(q)}return new OpenLayers.Size(s,r)};OpenLayers.Util.getScrollbarWidth=function(){var e=OpenLayers.Util._scrollbarWidth;if(e==null){var d=null,f=null,d=e=0,d=document.createElement("div");d.style.position="absolute";d.style.top="-1000px";d.style.left="-1000px";d.style.width="100px";d.style.height="50px";d.style.overflow="hidden";f=document.createElement("div");f.style.width="100%";f.style.height="200px";d.appendChild(f);document.body.appendChild(d);e=f.offsetWidth;d.style.overflow="scroll";d=f.offsetWidth;document.body.removeChild(document.body.lastChild);OpenLayers.Util._scrollbarWidth=e-d;e=OpenLayers.Util._scrollbarWidth}return e};OpenLayers.Util.getFormattedLonLat=function(h,g,l){l||(l="dms");var h=(h+540)%360-180,k=Math.abs(h),j=Math.floor(k),i=k=(k-j)/(1/60),k=Math.floor(k),i=Math.round((i-k)/(1/60)*10),i=i/10;if(i>=60){i=i-60;k=k+1;if(k>=60){k=k-60;j=j+1}}j<10&&(j="0"+j);j=j+"\u00b0";if(l.indexOf("dm")>=0){k<10&&(k="0"+k);j=j+(k+"'");if(l.indexOf("dms")>=0){i<10&&(i="0"+i);j=j+(i+'"')}}return j=g=="lon"?j+(h<0?OpenLayers.i18n("W"):OpenLayers.i18n("E")):j+(h<0?OpenLayers.i18n("S"):OpenLayers.i18n("N"))};OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(b){return b.target||b.srcElement},isSingleTouch:function(b){return b.touches&&1==b.touches.length},isMultiTouch:function(b){return b.touches&&1<b.touches.length},isLeftClick:function(b){return b.which&&1==b.which||b.button&&1==b.button},isRightClick:function(b){return b.which&&3==b.which||b.button&&2==b.button},stop:function(d,c){c||(d.preventDefault?d.preventDefault():d.returnValue=!1);d.stopPropagation?d.stopPropagation():d.cancelBubble=!0},findElement:function(e,d){for(var f=OpenLayers.Event.element(e);f.parentNode&&(!f.tagName||f.tagName.toUpperCase()!=d.toUpperCase());){f=f.parentNode}return f},observe:function(g,f,j,i){g=OpenLayers.Util.getElement(g);i=i||!1;if("keypress"==f&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||g.attachEvent)){f="keydown"}this.observers||(this.observers={});if(!g._eventCacheID){var h="eventCacheID_";g.id&&(h=g.id+"_"+h);g._eventCacheID=OpenLayers.Util.createUniqueID(h)}h=g._eventCacheID;this.observers[h]||(this.observers[h]=[]);this.observers[h].push({element:g,name:f,observer:j,useCapture:i});g.addEventListener?g.addEventListener(f,j,i):g.attachEvent&&g.attachEvent("on"+f,j)},stopObservingElement:function(b){b=OpenLayers.Util.getElement(b)._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[b])},_removeElementObservers:function(e){if(e){for(var d=e.length-1;0<=d;d--){var f=e[d];OpenLayers.Event.stopObserving.apply(this,[f.element,f.name,f.observer,f.useCapture])}}},stopObserving:function(r,q,p,o){var o=o||!1,r=OpenLayers.Util.getElement(r),n=r._eventCacheID;if("keypress"==q&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||r.detachEvent)){q="keydown"}var m=!1,l=OpenLayers.Event.observers[n];if(l){for(var k=0;!m&&k<l.length;){var j=l[k];if(j.name==q&&j.observer==p&&j.useCapture==o){l.splice(k,1);0==l.length&&delete OpenLayers.Event.observers[n];m=!0;break}k++}}m&&(r.removeEventListener?r.removeEventListener(q,p,o):r&&r.detachEvent&&r.detachEvent("on"+q,p));return m},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var b in OpenLayers.Event.observers){OpenLayers.Event._removeElementObservers.apply(this,[OpenLayers.Event.observers[b]])}OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1);OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:"mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown".split(" "),listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(g,f,j,i,h){OpenLayers.Util.extend(this,h);this.object=g;this.fallThrough=i;this.listeners={};this.extensions={};this.extensionCount={};null!=f&&this.attachToElement(f)},destroy:function(){for(var b in this.extensions){"boolean"!==typeof this.extensions[b]&&this.extensions[b].destroy()}this.extensions=null;this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener));this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(){},attachToElement:function(e){this.element?OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this));this.element=e;for(var d=0,f=this.BROWSER_EVENTS.length;d<f;d++){OpenLayers.Event.observe(e,this.BROWSER_EVENTS[d],this.eventHandler)}OpenLayers.Event.observe(e,"dragstart",OpenLayers.Event.stop)},on:function(d){for(var c in d){"scope"!=c&&d.hasOwnProperty(c)&&this.register(c,d.scope,d[c])}},register:function(g,f,j,i){g in OpenLayers.Events&&!this.extensions[g]&&(this.extensions[g]=new OpenLayers.Events[g](this));if(null!=j){null==f&&(f=this.object);var h=this.listeners[g];h||(h=[],this.listeners[g]=h,this.extensionCount[g]=0);f={obj:f,func:j};i?(h.splice(this.extensionCount[g],0,f),"object"===typeof i&&i.extension&&this.extensionCount[g]++):h.push(f)}},registerPriority:function(e,d,f){this.register(e,d,f,!0)},un:function(d){for(var c in d){"scope"!=c&&d.hasOwnProperty(c)&&this.unregister(c,d.scope,d[c])}},unregister:function(g,f,j){null==f&&(f=this.object);g=this.listeners[g];if(null!=g){for(var i=0,h=g.length;i<h;i++){if(g[i].obj==f&&g[i].func==j){g.splice(i,1);break}}}},remove:function(b){null!=this.listeners[b]&&(this.listeners[b]=[])},triggerEvent:function(h,g){var l=this.listeners[h];if(l&&0!=l.length){null==g&&(g={});g.object=this.object;g.element=this.element;g.type||(g.type=h);for(var l=l.slice(),k,j=0,i=l.length;j<i&&!(k=l[j],k=k.func.apply(k.obj,[g]),void 0!=k&&!1==k);j++){}this.fallThrough||OpenLayers.Event.stop(g,!0);return k}},handleBrowserEvent:function(j){var i=j.type,p=this.listeners[i];if(p&&0!=p.length){if((p=j.touches)&&p[0]){for(var o=0,n=0,m=p.length,l,k=0;k<m;++k){l=p[k],o+=l.clientX,n+=l.clientY}j.clientX=o/m;j.clientY=n/m}this.includeXY&&(j.xy=this.getMousePosition(j));this.triggerEvent(i,j)}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;var b=document.body;if(b&&(!(0!=b.scrollTop||0!=b.scrollLeft)||!navigator.userAgent.match(/iPhone/i))){this.element.offsets=null}},getMousePosition:function(d){this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache();if(!this.element.scrolls){var c=OpenLayers.Util.getViewportElement();this.element.scrolls=[c.scrollLeft,c.scrollTop]}this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]);this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element));return new OpenLayers.Pixel(d.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],d.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:"mousedown mouseup click dblclick touchstart touchmove touchend keydown".split(" "),startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(b){this.target=b;for(b=this.events.length-1;0<=b;--b){this.target.register(this.events[b],this,this.buttonClick,{extension:!0})}},destroy:function(){for(var b=this.events.length-1;0<=b;--b){this.target.unregister(this.events[b],this,this.buttonClick)}delete this.target},getPressedButton:function(e){var d=3,f;do{if(OpenLayers.Element.hasClass(e,"olButton")){f=e;break}e=e.parentNode}while(0<--d&&e);return f},buttonClick:function(e){var d=!0,f=OpenLayers.Event.element(e);if(f&&(OpenLayers.Event.isLeftClick(e)||!~e.type.indexOf("mouse"))){if(f=this.getPressedButton(f)){if("keydown"===e.type){switch(e.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:f}),OpenLayers.Event.stop(e),d=!1}}else{this.startEvt&&(this.completeRegEx.test(e.type)&&(d=OpenLayers.Util.pagePosition(f),this.target.triggerEvent("buttonclick",{buttonElement:f,buttonXY:{x:this.startEvt.clientX-d[0],y:this.startEvt.clientY-d[1]}})),this.cancelRegEx.test(e.type)&&delete this.startEvt,OpenLayers.Event.stop(e),d=!1)}this.startRegEx.test(e.type)&&(this.startEvt=e,OpenLayers.Event.stop(e),d=!1)}else{delete this.startEvt}}return d}});OpenLayers.Animation=function(g){var f=!(!g.requestAnimationFrame&&!g.webkitRequestAnimationFrame&&!g.mozRequestAnimationFrame&&!g.oRequestAnimationFrame&&!g.msRequestAnimationFrame),j=function(){var a=g.requestAnimationFrame||g.webkitRequestAnimationFrame||g.mozRequestAnimationFrame||g.oRequestAnimationFrame||g.msRequestAnimationFrame||function(c){g.setTimeout(c,16)};return function(e,b){a.apply(g,[e,b])}}(),i=0,h={};return{isNative:f,requestFrame:j,start:function(d,c,l){var c=0<c?c:Number.POSITIVE_INFINITY,k=++i,e=+new Date;h[k]=function(){h[k]&&+new Date-e<=c?(d(),h[k]&&j(h[k],l)):delete h[k]};j(h[k],l);return k},stop:function(b){delete h[b]}}}(window);OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:!1,initialize:function(b){this.easing=b?b:OpenLayers.Easing.Expo.easeOut},start:function(f,e,h,g){this.playing=!0;this.begin=f;this.finish=e;this.duration=h;this.callbacks=g.callbacks;this.time=0;OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin);this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var f={},e;for(e in this.begin){var h=this.begin[e],g=this.finish[e];if(null==h||null==g||isNaN(h)||isNaN(g)){throw new TypeError("invalid value for Tween")}f[e]=this.easing.apply(this,[this.time,h,g-h,this.duration])}this.time++;this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,f);this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(f,e,h,g){return h*f/g+e},easeOut:function(f,e,h,g){return h*f/g+e},easeInOut:function(f,e,h,g){return h*f/g+e},CLASS_NAME:"OpenLayers.Easing.Linear"};OpenLayers.Easing.Expo={easeIn:function(f,e,h,g){return 0==f?e:h*Math.pow(2,10*(f/g-1))+e},easeOut:function(f,e,h,g){return f==g?e+h:h*(-Math.pow(2,-10*f/g)+1)+e},easeInOut:function(f,e,h,g){return 0==f?e:f==g?e+h:1>(f/=g/2)?h/2*Math.pow(2,10*(f-1))+e:h/2*(-Math.pow(2,-10*--f)+2)+e},CLASS_NAME:"OpenLayers.Easing.Expo"};OpenLayers.Easing.Quad={easeIn:function(f,e,h,g){return h*(f/=g)*f+e},easeOut:function(f,e,h,g){return -h*(f/=g)*(f-2)+e},easeInOut:function(f,e,h,g){return 1>(f/=g/2)?h/2*f*f+e:-h/2*(--f*(f-2)-1)+e},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(d,c){OpenLayers.Util.extend(this,c);this.projCode=d;window.Proj4js&&(this.proj=new Proj4js.Proj(d))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(d){var c=!1;d&&(d instanceof OpenLayers.Projection||(d=new OpenLayers.Projection(d)),window.Proj4js&&this.proj.defData&&d.proj.defData?c=this.proj.defData.replace(this.titleRegEx,"")==d.proj.defData.replace(this.titleRegEx,""):d.getCode&&(c=this.getCode(),d=d.getCode(),c=c==d||!!OpenLayers.Projection.transforms[c]&&OpenLayers.Projection.transforms[c][d]===OpenLayers.Projection.nullTransform));return c},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}};OpenLayers.Projection.addTransform=function(f,e,h){if(h===OpenLayers.Projection.nullTransform){var g=OpenLayers.Projection.defaults[f];g&&!OpenLayers.Projection.defaults[e]&&(OpenLayers.Projection.defaults[e]=g)}OpenLayers.Projection.transforms[f]||(OpenLayers.Projection.transforms[f]={});OpenLayers.Projection.transforms[f][e]=h};OpenLayers.Projection.transform=function(f,e,h){if(e&&h){if(e instanceof OpenLayers.Projection||(e=new OpenLayers.Projection(e)),h instanceof OpenLayers.Projection||(h=new OpenLayers.Projection(h)),e.proj&&h.proj){f=Proj4js.transform(e.proj,h.proj,f)}else{var e=e.getCode(),h=h.getCode(),g=OpenLayers.Projection.transforms;if(g[e]&&g[e][h]){g[e][h](f)}}}return f};OpenLayers.Projection.nullTransform=function(b){return b};(function(){function i(b){b.x=180*b.x/m;b.y=180/Math.PI*(2*Math.atan(Math.exp(b.y/m*Math.PI))-Math.PI/2);return b}function h(b){b.x=b.x*m/180;b.y=Math.log(Math.tan((90+b.y)*Math.PI/360))/Math.PI*m;return b}function n(v,u){var t=OpenLayers.Projection.addTransform,s=OpenLayers.Projection.nullTransform,r,o,p,b,a;r=0;for(o=u.length;r<o;++r){p=u[r];t(v,p,h);t(p,v,i);for(a=r+1;a<o;++a){b=u[a],t(p,b,s),t(b,p,s)}}}var m=20037508.34,l=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],k=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],j;for(j=l.length-1;0<=j;--j){n(l[j],k)}for(j=k.length-1;0<=j;--j){n(k[j],l)}})();OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1000},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(h,g){1===arguments.length&&"object"===typeof h&&(h=(g=h)&&g.div);this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css";this.options=OpenLayers.Util.extend({},g);OpenLayers.Util.extend(this,g);OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection]);this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds)&&(this.maxExtent=new OpenLayers.Bounds(this.maxExtent));this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds)&&(this.minExtent=new OpenLayers.Bounds(this.minExtent));this.restrictedExtent&&!(this.restrictedExtent instanceof OpenLayers.Bounds)&&(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent));this.center&&!(this.center instanceof OpenLayers.LonLat)&&(this.center=new OpenLayers.LonLat(this.center));this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(h);this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px");OpenLayers.Element.addClass(this.div,"olMap");var l=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(l,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0});l=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(l);this.layerContainerDiv.style.width="100px";this.layerContainerDiv.style.height="100px";this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}9>parseFloat(navigator.appVersion.split("MSIE")[1])?this.events.register("resize",this,this.updateSize):(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){for(var l=!0,k=document.getElementsByTagName("link"),j=0,i=k.length;j<i;++j){if(OpenLayers.Util.isEquivalentUrl(k.item(j).href,this.theme)){l=!1;break}}l&&(l=document.createElement("link"),l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(l))}null==this.controls&&(this.controls=[],null!=OpenLayers.Control&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));j=0;for(i=this.controls.length;j<i;j++){this.addControlToMap(this.controls[j])}this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy);g&&g.layers&&(delete this.center,this.addLayers(g.layers),g.center&&!this.getCenter()&&this.setCenter(g.center,g.zoom))},getViewport:function(){return this.viewPortDiv},render:function(b){this.div=OpenLayers.Util.getElement(b);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy){return !1}this.panTween&&(this.panTween.stop(),this.panTween=null);OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize);this.paddingForPopups=null;if(null!=this.controls){for(var b=this.controls.length-1;0<=b;--b){this.controls[b].destroy()}this.controls=null}if(null!=this.layers){for(b=this.layers.length-1;0<=b;--b){this.layers[b].destroy(!1)}this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv);this.viewPortDiv=null;this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null);this.events.destroy();this.options=this.events=null},setOptions:function(d){var c=this.minPx&&d.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,d);c&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(f,e,h){var g="function"==typeof h.test;return OpenLayers.Array.filter(this[f],function(b){return b[e]==h||g&&h.test(b[e])})},getLayersBy:function(d,c){return this.getBy("layers",d,c)},getLayersByName:function(b){return this.getLayersBy("name",b)},getLayersByClass:function(b){return this.getLayersBy("CLASS_NAME",b)},getControlsBy:function(d,c){return this.getBy("controls",d,c)},getControlsByClass:function(b){return this.getControlsBy("CLASS_NAME",b)},getLayer:function(g){for(var f=null,j=0,i=this.layers.length;j<i;j++){var h=this.layers[j];if(h.id==g){f=h;break}}return f},setLayerZIndex:function(d,c){d.setZIndex(this.Z_INDEX_BASE[d.isBaseLayer?"BaseLayer":"Overlay"]+5*c)},resetLayersZIndex:function(){for(var d=0,c=this.layers.length;d<c;d++){this.setLayerZIndex(this.layers[d],d)}},addLayer:function(e){for(var d=0,f=this.layers.length;d<f;d++){if(this.layers[d]==e){return !1}}if(!1===this.events.triggerEvent("preaddlayer",{layer:e})){return !1}this.allOverlays&&(e.isBaseLayer=!1);e.div.className="olLayerDiv";e.div.style.overflow="";this.setLayerZIndex(e,this.layers.length);e.isFixed?this.viewPortDiv.appendChild(e.div):this.layerContainerDiv.appendChild(e.div);this.layers.push(e);e.setMap(this);e.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(e):e.setVisibility(!1):e.redraw();this.events.triggerEvent("addlayer",{layer:e});e.events.triggerEvent("added",{map:this,layer:e});e.afterAdd();return !0},addLayers:function(e){for(var d=0,f=e.length;d<f;d++){this.addLayer(e[d])}},removeLayer:function(g,f){if(!1!==this.events.triggerEvent("preremovelayer",{layer:g})){null==f&&(f=!0);g.isFixed?this.viewPortDiv.removeChild(g.div):this.layerContainerDiv.removeChild(g.div);OpenLayers.Util.removeItem(this.layers,g);g.removeMap(this);g.map=null;if(this.baseLayer==g&&(this.baseLayer=null,f)){for(var j=0,i=this.layers.length;j<i;j++){var h=this.layers[j];if(h.isBaseLayer||this.allOverlays){this.setBaseLayer(h);break}}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:g});g.events.triggerEvent("removed",{map:this,layer:g})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(b){return OpenLayers.Util.indexOf(this.layers,b)},setLayerIndex:function(f,e){var h=this.getLayerIndex(f);0>e?e=0:e>this.layers.length&&(e=this.layers.length);if(h!=e){this.layers.splice(h,1);this.layers.splice(e,0,f);for(var h=0,g=this.layers.length;h<g;h++){this.setLayerZIndex(this.layers[h],h)}this.events.triggerEvent("changelayer",{layer:f,property:"order"});this.allOverlays&&(0===e?this.setBaseLayer(f):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(e,d){var f=this.getLayerIndex(e)+d;this.setLayerIndex(e,f)},setBaseLayer:function(e){if(e!=this.baseLayer&&-1!=OpenLayers.Util.indexOf(this.layers,e)){var d=this.getCachedCenter(),f=OpenLayers.Util.getResolutionFromScale(this.getScale(),e.units);null!=this.baseLayer&&!this.allOverlays&&this.baseLayer.setVisibility(!1);this.baseLayer=e;if(!this.allOverlays||this.baseLayer.visibility){this.baseLayer.setVisibility(!0),!1===this.baseLayer.inRange&&this.baseLayer.redraw()}null!=d&&(e=this.getZoomForResolution(f||this.resolution,!0),this.setCenter(d,e,!1,!0));this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(d,c){this.controls.push(d);this.addControlToMap(d,c)},addControls:function(g,f){for(var j=1===arguments.length?[]:f,i=0,h=g.length;i<h;i++){this.addControl(g[i],j[i]?j[i]:null)}},addControlToMap:function(e,d){e.outsideViewport=null!=e.div;this.displayProjection&&!e.displayProjection&&(e.displayProjection=this.displayProjection);e.setMap(this);var f=e.draw(d);f&&!e.outsideViewport&&(f.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(f));e.autoActivate&&e.activate()},getControl:function(g){for(var f=null,j=0,i=this.controls.length;j<i;j++){var h=this.controls[j];if(h.id==g){f=h;break}}return f},removeControl:function(b){b&&b==this.getControl(b.id)&&(b.div&&b.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(b.div),OpenLayers.Util.removeItem(this.controls,b))},addPopup:function(e,d){if(d){for(var f=this.popups.length-1;0<=f;--f){this.removePopup(this.popups[f])}}e.map=this;this.popups.push(e);if(f=e.draw()){f.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(f)}},removePopup:function(d){OpenLayers.Util.removeItem(this.popups,d);if(d.div){try{this.layerContainerDiv.removeChild(d.div)}catch(c){}}d.map=null},getSize:function(){var b=null;null!=this.size&&(b=this.size.clone());return b},updateSize:function(){var d=this.getCurrentSize();if(d&&!isNaN(d.h)&&!isNaN(d.w)){this.events.clearMouseCache();var c=this.getSize();null==c&&(this.size=c=d);if(!d.equals(c)){this.size=d;d=0;for(c=this.layers.length;d<c;d++){this.layers[d].onMapResize()}d=this.getCachedCenter();null!=this.baseLayer&&null!=d&&(c=this.getZoom(),this.zoom=null,this.setCenter(d,c))}}},getCurrentSize:function(){var b=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(0==b.w&&0==b.h||isNaN(b.w)&&isNaN(b.h)){b.w=this.div.offsetWidth,b.h=this.div.offsetHeight}if(0==b.w&&0==b.h||isNaN(b.w)&&isNaN(b.h)){b.w=parseInt(this.div.style.width),b.h=parseInt(this.div.style.height)}return b},calculateBounds:function(f,e){var h=null;null==f&&(f=this.getCachedCenter());null==e&&(e=this.getResolution());if(null!=f&&null!=e){var h=this.size.w*e/2,g=this.size.h*e/2,h=new OpenLayers.Bounds(f.lon-h,f.lat-g,f.lon+h,f.lat+g)}return h},getCenter:function(){var d=null,c=this.getCachedCenter();c&&(d=c.clone());return d},getCachedCenter:function(){!this.center&&this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2}));return this.center},getZoom:function(){return this.zoom},pan:function(f,e,h){h=OpenLayers.Util.applyDefaults(h,{animate:!0,dragging:!1});if(h.dragging){(0!=f||0!=e)&&this.moveByPx(f,e)}else{var g=this.getViewPortPxFromLonLat(this.getCachedCenter()),f=g.add(f,e);if(this.dragging||!f.equals(g)){g=this.getLonLatFromViewPortPx(f),h.animate?this.panTo(g):(this.moveTo(g),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}}},panTo:function(g){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(g)){this.panTween||(this.panTween=new OpenLayers.Tween(this.panMethod));var f=this.getCachedCenter();if(!g.equals(f)){var f=this.getPixelFromLonLat(f),j=this.getPixelFromLonLat(g),i=0,h=0;this.panTween.start({x:0,y:0},{x:j.x-f.x,y:j.y-f.y},this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(b){this.moveByPx(b.x-i,b.y-h);i=Math.round(b.x);h=Math.round(b.y)},this),done:OpenLayers.Function.bind(function(){this.moveTo(g);this.dragging=false;this.events.triggerEvent("moveend")},this)}})}}else{this.setCenter(g)}},setCenter:function(f,e,h,g){this.panTween&&this.panTween.stop();this.moveTo(f,e,{dragging:h,forceZoomChange:g})},moveByPx:function(r,q){var p=this.size.w/2,o=this.size.h/2,n=p+r,m=o+q,l=this.baseLayer.wrapDateLine,k=0,j=0;this.restrictedExtent&&(k=p,j=o,l=!1);r=l||n<=this.maxPx.x-k&&n>=this.minPx.x+k?Math.round(r):0;q=m<=this.maxPx.y-j&&m>=this.minPx.y+j?Math.round(q):0;if(r||q){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart"));this.center=null;r&&(this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-r+"px",this.minPx.x-=r,this.maxPx.x-=r);q&&(this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-q+"px",this.minPx.y-=q,this.maxPx.y-=q);o=0;for(n=this.layers.length;o<n;++o){if(p=this.layers[o],p.visibility&&(p===this.baseLayer||p.inRange)){p.moveByPx(r,q),p.events.triggerEvent("move")}}this.events.triggerEvent("move")}},adjustZoom:function(g){var f=this.baseLayer.resolutions,j=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(g)>j){for(var i=g|0,h=f.length;i<h;++i){if(f[i]<=j){g=i;break}}}return g},moveTo:function(t,s,r){null!=t&&!(t instanceof OpenLayers.LonLat)&&(t=new OpenLayers.LonLat(t));r||(r={});null!=s&&(s=parseFloat(s),this.fractionalZoom||(s=Math.round(s)));if(this.baseLayer.wrapDateLine){var q=s,s=this.adjustZoom(s);s!==q&&(t=this.getCenter())}var q=r.dragging||this.dragging,p=r.forceZoomChange;!this.getCachedCenter()&&!this.isValidLonLat(t)&&(t=this.maxExtent.getCenterLonLat(),this.center=t.clone());if(null!=this.restrictedExtent){null==t&&(t=this.center);null==s&&(s=this.getZoom());var o=this.getResolutionForZoom(s),o=this.calculateBounds(t,o);if(!this.restrictedExtent.containsBounds(o)){var n=this.restrictedExtent.getCenterLonLat();o.getWidth()>this.restrictedExtent.getWidth()?t=new OpenLayers.LonLat(n.lon,t.lat):o.left<this.restrictedExtent.left?t=t.add(this.restrictedExtent.left-o.left,0):o.right>this.restrictedExtent.right&&(t=t.add(this.restrictedExtent.right-o.right,0));o.getHeight()>this.restrictedExtent.getHeight()?t=new OpenLayers.LonLat(t.lon,n.lat):o.bottom<this.restrictedExtent.bottom?t=t.add(0,this.restrictedExtent.bottom-o.bottom):o.top>this.restrictedExtent.top&&(t=t.add(0,this.restrictedExtent.top-o.top))}}p=p||this.isValidZoomLevel(s)&&s!=this.getZoom();o=this.isValidLonLat(t)&&!t.equals(this.center);if(p||o||q){q||this.events.triggerEvent("movestart");o&&(!p&&this.center&&this.centerLayerContainer(t),this.center=t.clone());t=p?this.getResolutionForZoom(s):this.getResolution();if(p||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top="0px";var o=this.getMaxExtent({restricted:!0}),m=o.getCenterLonLat(),n=this.center.lon-m.lon,m=m.lat-this.center.lat,l=Math.round(o.getWidth()/t),k=Math.round(o.getHeight()/t);this.minPx={x:(this.size.w-l)/2-n/t,y:(this.size.h-k)/2-m/t};this.maxPx={x:this.minPx.x+Math.round(o.getWidth()/t),y:this.minPx.y+Math.round(o.getHeight()/t)}}p&&(this.zoom=s,this.resolution=t);t=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(t,p,r.dragging),r.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:p}));t=this.baseLayer.getExtent();for(s=this.layers.length-1;0<=s;--s){if(o=this.layers[s],o!==this.baseLayer&&!o.isBaseLayer&&(n=o.calculateInRange(),o.inRange!=n&&((o.inRange=n)||o.display(!1),this.events.triggerEvent("changelayer",{layer:o,property:"visibility"})),n&&o.visibility)){o.moveTo(t,p,r.dragging),r.dragging||o.events.triggerEvent("moveend",{zoomChanged:p})}}this.events.triggerEvent("move");q||this.events.triggerEvent("moveend");if(p){s=0;for(r=this.popups.length;s<r;s++){this.popups[s].updatePosition()}this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(g){var f=this.getViewPortPxFromLonLat(this.layerContainerOrigin),j=this.getViewPortPxFromLonLat(g);if(null!=f&&null!=j){var i=parseInt(this.layerContainerDiv.style.left),g=parseInt(this.layerContainerDiv.style.top),h=Math.round(f.x-j.x),f=Math.round(f.y-j.y);this.layerContainerDiv.style.left=h+"px";this.layerContainerDiv.style.top=f+"px";i-=h;g-=f;this.minPx.x-=i;this.maxPx.x-=i;this.minPx.y-=g;this.maxPx.y-=g}},isValidZoomLevel:function(b){return null!=b&&0<=b&&b<this.getNumZoomLevels()},isValidLonLat:function(d){var c=!1;null!=d&&(c=this.getMaxExtent(),c=c.containsLonLat(d,{worldBounds:this.baseLayer.wrapDateLine&&c}));return c},getProjection:function(){var b=this.getProjectionObject();return b?b.getCode():null},getProjectionObject:function(){var b=null;null!=this.baseLayer&&(b=this.baseLayer.projection);return b},getMaxResolution:function(){var b=null;null!=this.baseLayer&&(b=this.baseLayer.maxResolution);return b},getMaxExtent:function(d){var c=null;d&&d.restricted&&this.restrictedExtent?c=this.restrictedExtent:null!=this.baseLayer&&(c=this.baseLayer.maxExtent);return c},getNumZoomLevels:function(){var b=null;null!=this.baseLayer&&(b=this.baseLayer.numZoomLevels);return b},getExtent:function(){var b=null;null!=this.baseLayer&&(b=this.baseLayer.getExtent());return b},getResolution:function(){var b=null;null!=this.baseLayer?b=this.baseLayer.getResolution():!0===this.allOverlays&&0<this.layers.length&&(b=this.layers[0].getResolution());return b},getUnits:function(){var b=null;null!=this.baseLayer&&(b=this.baseLayer.units);return b},getScale:function(){var b=null;null!=this.baseLayer&&(b=this.getResolution(),b=OpenLayers.Util.getScaleFromResolution(b,this.baseLayer.units));return b},getZoomForExtent:function(e,d){var f=null;null!=this.baseLayer&&(f=this.baseLayer.getZoomForExtent(e,d));return f},getResolutionForZoom:function(d){var c=null;this.baseLayer&&(c=this.baseLayer.getResolutionForZoom(d));return c},getZoomForResolution:function(e,d){var f=null;null!=this.baseLayer&&(f=this.baseLayer.getZoomForResolution(e,d));return f},zoomTo:function(b){this.isValidZoomLevel(b)&&this.setCenter(null,b)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(e,d){e instanceof OpenLayers.Bounds||(e=new OpenLayers.Bounds(e));var f=e.getCenterLonLat();if(this.baseLayer.wrapDateLine){f=this.getMaxExtent();for(e=e.clone();e.right<e.left;){e.right+=f.getWidth()}f=e.getCenterLonLat().wrapDateLine(f)}this.setCenter(f,this.getZoomForExtent(e,d))},zoomToMaxExtent:function(b){this.zoomToExtent(this.getMaxExtent({restricted:b?b.restricted:!0}))},zoomToScale:function(g,f){var j=OpenLayers.Util.getResolutionFromScale(g,this.baseLayer.units),i=this.size.w*j/2,j=this.size.h*j/2,h=this.getCachedCenter();this.zoomToExtent(new OpenLayers.Bounds(h.lon-i,h.lat-j,h.lon+i,h.lat+j),f)},getLonLatFromViewPortPx:function(d){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getLonLatFromViewPortPx(d));return c},getViewPortPxFromLonLat:function(d){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getViewPortPxFromLonLat(d));return c},getLonLatFromPixel:function(b){return this.getLonLatFromViewPortPx(b)},getPixelFromLonLat:function(b){b=this.getViewPortPxFromLonLat(b);b.x=Math.round(b.x);b.y=Math.round(b.y);return b},getGeodesicPixelSize:function(h){var g=h?this.getLonLatFromPixel(h):this.getCachedCenter()||new OpenLayers.LonLat(0,0),l=this.getResolution(),h=g.add(-l/2,0),k=g.add(l/2,0),j=g.add(0,-l/2),g=g.add(0,l/2),l=new OpenLayers.Projection("EPSG:4326"),i=this.getProjectionObject()||l;i.equals(l)||(h.transform(i,l),k.transform(i,l),j.transform(i,l),g.transform(i,l));return new OpenLayers.Size(OpenLayers.Util.distVincenty(h,k),OpenLayers.Util.distVincenty(j,g))},getViewPortPxFromLayerPx:function(e){var d=null;if(null!=e){var d=parseInt(this.layerContainerDiv.style.left),f=parseInt(this.layerContainerDiv.style.top),d=e.add(d,f)}return d},getLayerPxFromViewPortPx:function(e){var d=null;if(null!=e){var d=-parseInt(this.layerContainerDiv.style.left),f=-parseInt(this.layerContainerDiv.style.top),d=e.add(d,f);if(isNaN(d.x)||isNaN(d.y)){d=null}}return d},getLonLatFromLayerPx:function(b){b=this.getViewPortPxFromLayerPx(b);return this.getLonLatFromViewPortPx(b)},getLayerPxFromLonLat:function(b){return this.getLayerPxFromViewPortPx(this.getPixelFromLonLat(b))},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:"scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel".split(" "),events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(d,c){this.metadata={};this.addOptions(c);this.name=d;if(null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div),this.eventListeners instanceof Object)){this.events.on(this.eventListeners)}},destroy:function(b){null==b&&(b=!0);null!=this.map&&this.map.removeLayer(this,b);this.options=this.div=this.name=this.map=this.projection=null;this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy());this.events=this.eventListeners=null},clone:function(b){null==b&&(b=new OpenLayers.Layer(this.name,this.getOptions()));OpenLayers.Util.applyDefaults(b,this);b.map=null;return b},getOptions:function(){var d={},c;for(c in this.options){d[c]=this[c]}return d},setName:function(b){b!=this.name&&(this.name=b,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(g,f){null==this.options&&(this.options={});if(g&&("string"==typeof g.projection&&(g.projection=new OpenLayers.Projection(g.projection)),g.projection&&OpenLayers.Util.applyDefaults(g,OpenLayers.Projection.defaults[g.projection.getCode()]),g.maxExtent&&!(g.maxExtent instanceof OpenLayers.Bounds)&&(g.maxExtent=new OpenLayers.Bounds(g.maxExtent)),g.minExtent&&!(g.minExtent instanceof OpenLayers.Bounds))){g.minExtent=new OpenLayers.Bounds(g.minExtent)}OpenLayers.Util.extend(this.options,g);OpenLayers.Util.extend(this,g);this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits());if(this.map){var j=this.map.getResolution(),i=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]),h;for(h in g){if(g.hasOwnProperty(h)&&0<=OpenLayers.Util.indexOf(i,h)){this.initResolutions();f&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(j),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}}},onMapResize:function(){},redraw:function(){var d=!1;if(this.map){this.inRange=this.calculateInRange();var c=this.getExtent();c&&(this.inRange&&this.visibility)&&(this.moveTo(c,!0,!1),this.events.triggerEvent("moveend",{zoomChanged:!0}),d=!0)}return d},moveTo:function(){var b=this.visibility;this.isBaseLayer||(b=b&&this.inRange);this.display(b)},moveByPx:function(){},setMap:function(b){null==this.map&&(this.map=b,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),this.isBaseLayer||(this.inRange=this.calculateInRange(),this.div.style.display=this.visibility&&this.inRange?"":"none"),this.setTileSize())},afterAdd:function(){},removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(b){this.tileSize=b=b?b:this.tileSize?this.tileSize:this.map.getTileSize();this.gutter&&(this.imageSize=new OpenLayers.Size(b.w+2*this.gutter,b.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(b){b!=this.visibility&&(this.visibility=b,this.display(b),this.redraw(),null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(b){b!=("none"!=this.div.style.display)&&(this.div.style.display=b&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var b=!1;this.alwaysInRange?b=!0:this.map&&(b=this.map.getResolution(),b=b>=this.minResolution&&b<=this.maxResolution);return b},setIsBaseLayer:function(b){b!=this.isBaseLayer&&(this.isBaseLayer=b,null!=this.map&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var i,h,n,m={},l=!0;i=0;for(h=this.RESOLUTION_PROPERTIES.length;i<h;i++){n=this.RESOLUTION_PROPERTIES[i],m[n]=this.options[n],l&&this.options[n]&&(l=!1)}null==this.alwaysInRange&&(this.alwaysInRange=l);null==m.resolutions&&(m.resolutions=this.resolutionsFromScales(m.scales));null==m.resolutions&&(m.resolutions=this.calculateResolutions(m));if(null==m.resolutions){i=0;for(h=this.RESOLUTION_PROPERTIES.length;i<h;i++){n=this.RESOLUTION_PROPERTIES[i],m[n]=null!=this.options[n]?this.options[n]:this.map[n]}null==m.resolutions&&(m.resolutions=this.resolutionsFromScales(m.scales));null==m.resolutions&&(m.resolutions=this.calculateResolutions(m))}var k;this.options.maxResolution&&"auto"!==this.options.maxResolution&&(k=this.options.maxResolution);this.options.minScale&&(k=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var j;this.options.minResolution&&"auto"!==this.options.minResolution&&(j=this.options.minResolution);this.options.maxScale&&(j=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units));m.resolutions&&(m.resolutions.sort(function(d,c){return c-d}),k||(k=m.resolutions[0]),j||(j=m.resolutions[m.resolutions.length-1]));if(this.resolutions=m.resolutions){h=this.resolutions.length;this.scales=Array(h);for(i=0;i<h;i++){this.scales[i]=OpenLayers.Util.getScaleFromResolution(this.resolutions[i],this.units)}this.numZoomLevels=h}if(this.minResolution=j){this.maxScale=OpenLayers.Util.getScaleFromResolution(j,this.units)}if(this.maxResolution=k){this.minScale=OpenLayers.Util.getScaleFromResolution(k,this.units)}},resolutionsFromScales:function(f){if(null!=f){var e,h,g;g=f.length;e=Array(g);for(h=0;h<g;h++){e[h]=OpenLayers.Util.getResolutionFromScale(f[h],this.units)}return e}},calculateResolutions:function(h){var g,l,k=h.maxResolution;null!=h.minScale?k=OpenLayers.Util.getResolutionFromScale(h.minScale,this.units):"auto"==k&&null!=this.maxExtent&&(g=this.map.getSize(),l=this.maxExtent.getWidth()/g.w,g=this.maxExtent.getHeight()/g.h,k=Math.max(l,g));l=h.minResolution;null!=h.maxScale?l=OpenLayers.Util.getResolutionFromScale(h.maxScale,this.units):"auto"==h.minResolution&&null!=this.minExtent&&(g=this.map.getSize(),l=this.minExtent.getWidth()/g.w,g=this.minExtent.getHeight()/g.h,l=Math.max(l,g));"number"!==typeof k&&("number"!==typeof l&&null!=this.maxExtent)&&(k=this.map.getTileSize(),k=Math.max(this.maxExtent.getWidth()/k.w,this.maxExtent.getHeight()/k.h));g=h.maxZoomLevel;h=h.numZoomLevels;"number"===typeof l&&"number"===typeof k&&void 0===h?h=Math.floor(Math.log(k/l)/Math.log(2))+1:void 0===h&&null!=g&&(h=g+1);if(!("number"!==typeof h||0>=h||"number"!==typeof k&&"number"!==typeof l)){g=Array(h);var j=2;"number"==typeof l&&"number"==typeof k&&(j=Math.pow(k/l,1/(h-1)));var i;if("number"===typeof k){for(i=0;i<h;i++){g[i]=k/Math.pow(j,i)}}else{for(i=0;i<h;i++){g[h-1-i]=l*Math.pow(j,i)}}return g}},getResolution:function(){return this.getResolutionForZoom(this.map.getZoom())},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(e,d){var f=this.map.getSize();return this.getZoomForResolution(Math.max(e.getWidth()/f.w,e.getHeight()/f.h),d)},getDataExtent:function(){},getResolutionForZoom:function(e){e=Math.max(0,Math.min(e,this.resolutions.length-1));if(this.map.fractionalZoom){var d=Math.floor(e),f=Math.ceil(e),e=this.resolutions[d]-(e-d)*(this.resolutions[d]-this.resolutions[f])}else{e=this.resolutions[Math.round(e)]}return e},getZoomForResolution:function(j,i){var p,o;if(this.map.fractionalZoom){var n=0,m=this.resolutions[n],l=this.resolutions[this.resolutions.length-1],k;p=0;for(o=this.resolutions.length;p<o;++p){if(k=this.resolutions[p],k>=j&&(m=k,n=p),k<=j){l=k;break}}p=m-l;p=0<p?n+(m-j)/p:n}else{m=Number.POSITIVE_INFINITY;p=0;for(o=this.resolutions.length;p<o;p++){if(i){n=Math.abs(this.resolutions[p]-j);if(n>m){break}m=n}else{if(this.resolutions[p]<j){break}}}p=Math.max(0,p-1)}return p},getLonLatFromViewPortPx:function(f){var e=null,h=this.map;if(null!=f&&h.minPx){var e=h.getResolution(),g=h.getMaxExtent({restricted:!0}),e=new OpenLayers.LonLat((f.x-h.minPx.x)*e+g.left,(h.minPx.y-f.y)*e+g.top);this.wrapDateLine&&(e=e.wrapDateLine(this.maxExtent))}return e},getViewPortPxFromLonLat:function(e,d){var f=null;null!=e&&(d=d||this.map.getResolution(),f=this.map.calculateBounds(null,d),f=new OpenLayers.Pixel(1/d*(e.lon-f.left),1/d*(f.top-e.lat)));return f},setOpacity:function(h){if(h!=this.opacity){this.opacity=h;for(var g=this.div.childNodes,l=0,k=g.length;l<k;++l){var j=g[l].firstChild||g[l],i=g[l].lastChild;i&&"iframe"===i.nodeName.toLowerCase()&&(j=i.parentNode);OpenLayers.Util.modifyDOMElement(j,null,null,null,null,null,null,h)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(b){this.div.style.zIndex=b},adjustBounds:function(d){if(this.gutter){var c=this.gutter*this.map.getResolution(),d=new OpenLayers.Bounds(d.left-c,d.bottom-c,d.right+c,d.top+c)}this.wrapDateLine&&(c={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()},d=d.wrapDateLine(this.maxExtent,c));return d},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var b=null;return b=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(b){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(b){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var b=0;b<=this.MAX_ZOOM_LEVEL;++b){this.RESOLUTIONS[b]=156543.03390625/Math.pow(2,b)}this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var d=new OpenLayers.Projection("EPSG:4326"),c=new OpenLayers.Projection("EPSG:900913");return function(f,b){var a=OpenLayers.Projection.transform({x:f,y:b},d,c);return new OpenLayers.LonLat(a.x,a.y)}}(),inverseMercator:function(){var d=new OpenLayers.Projection("EPSG:4326"),c=new OpenLayers.Projection("EPSG:900913");return function(f,b){var a=OpenLayers.Projection.transform({x:f,y:b},c,d);return new OpenLayers.LonLat(a.x,a.y)}}()};OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(d,c){OpenLayers.Layer.prototype.initialize.apply(this,arguments);null==this.pane&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.pane=this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(b){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";"msie"==OpenLayers.BROWSER_NAME&&(this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")");this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane);this.loadMapObject();null==this.mapObject&&this.loadWarningMessage()},removeMap:function(b){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane);OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var e=this.map.getSize(),d=Math.min(e.w,300),f=Math.min(e.h,200),d=new OpenLayers.Size(d,f),e=(new OpenLayers.Pixel(e.w/2,e.h/2)).add(-d.w/2,-d.h/2),e=OpenLayers.Util.createDiv(this.name+"_warning",e,d,null,null,null,"auto");e.style.padding="7px";e.style.backgroundColor="yellow";e.innerHTML=this.getWarningHTML();this.div.appendChild(e)},getWarningHTML:function(){return""},display:function(b){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(b){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(d,c){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);this.dragPanMapObject?this.dragPanMapObject(d,-c):this.moveTo(this.map.getCachedCenter())},moveTo:function(i,h,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(null!=this.mapObject){var m=this.map.getCenter(),l=this.map.getZoom();if(null!=m){var k=this.getOLLonLatFromMapObjectLonLat(this.getMapObjectCenter()),j=this.getOLZoomFromMapObjectZoom(this.getMapObjectZoom());if(!m.equals(k)||l!=j){!h&&k&&this.dragPanMapObject&&this.smoothDragPan?(l=this.map.getViewPortPxFromLonLat(k),m=this.map.getViewPortPxFromLonLat(m),this.dragPanMapObject(m.x-l.x,l.y-m.y)):(m=this.getMapObjectLonLatFromOLLonLat(m),l=this.getMapObjectZoomFromOLZoom(l),this.setMapObjectCenter(m,l,n))}}}},getLonLatFromViewPortPx:function(d){var c=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(c=this.getOLLonLatFromMapObjectLonLat(this.getMapObjectLonLatFromMapObjectPixel(this.getMapObjectPixelFromOLPixel(d))));return c},getViewPortPxFromLonLat:function(d){var c=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(c=this.getOLPixelFromMapObjectPixel(this.getMapObjectPixelFromMapObjectLonLat(this.getMapObjectLonLatFromOLLonLat(d))));return c},getOLLonLatFromMapObjectLonLat:function(d){var c=null;null!=d&&(c=this.getLongitudeFromMapObjectLonLat(d),d=this.getLatitudeFromMapObjectLonLat(d),c=new OpenLayers.LonLat(c,d));return c},getMapObjectLonLatFromOLLonLat:function(d){var c=null;null!=d&&(c=this.getMapObjectLonLatFromLonLat(d.lon,d.lat));return c},getOLPixelFromMapObjectPixel:function(d){var c=null;null!=d&&(c=this.getXFromMapObjectPixel(d),d=this.getYFromMapObjectPixel(d),c=new OpenLayers.Pixel(c,d));return c},getMapObjectPixelFromOLPixel:function(d){var c=null;null!=d&&(c=this.getMapObjectPixelFromXY(d.x,d.y));return c},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var f=["minZoomLevel","maxZoomLevel","numZoomLevels"],e=0,h=f.length;e<h;e++){var g=f[e];this[g]=null!=this.options[g]?this.options[g]:this.map[g]}if(null==this.minZoomLevel||this.minZoomLevel<this.MIN_ZOOM_LEVEL){this.minZoomLevel=this.MIN_ZOOM_LEVEL}f=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;e=null==this.options.numZoomLevels&&null!=this.options.maxZoomLevel||null==this.numZoomLevels&&null!=this.maxZoomLevel?this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels;this.numZoomLevels=null!=e?Math.min(e,f):f;this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(null!=this.RESOLUTIONS){f=0;this.resolutions=[];for(e=this.minZoomLevel;e<=this.maxZoomLevel;e++){this.resolutions[f++]=this.RESOLUTIONS[e]}this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(null!=this.resolutions){return OpenLayers.Layer.prototype.getResolution.apply(this,arguments)}var e=null,d=this.map.getSize(),f=this.getExtent();null!=d&&null!=f&&(e=Math.max(f.getWidth()/d.w,f.getHeight()/d.h));return e},getExtent:function(){var d=this.map.getSize(),c=this.getLonLatFromViewPortPx({x:0,y:0}),d=this.getLonLatFromViewPortPx({x:d.w,y:d.h});return null!=c&&null!=d?new OpenLayers.Bounds(c.lon,d.lat,d.lon,c.lat):null},getZoomForResolution:function(b){return null!=this.resolutions?OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments):this.getZoomForExtent(OpenLayers.Layer.prototype.getExtent.apply(this,[]))},getOLZoomFromMapObjectZoom:function(d){var c=null;null!=d&&(c=d-this.minZoomLevel,this.map.baseLayer!==this&&(c=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(c))));return c},getMapObjectZoomFromOLZoom:function(d){var c=null;null!=d&&(c=d+this.minZoomLevel,this.map.baseLayer!==this&&(c=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(c))));return c},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031,0.00000536441802978515,0.00000268220901489257,0.000001341104507446289,6.705522537231445e-7],type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(e,d){d=d||{};d.version||(d.version="function"===typeof GMap2?"2":"3");var f=OpenLayers.Layer.Google["v"+d.version.replace(/\./g,"_")];if(f){OpenLayers.Util.applyDefaults(d,f)}else{throw"Unsupported Google Maps API version: "+d.version}OpenLayers.Util.applyDefaults(d,f.DEFAULTS);d.maxExtent&&(d.maxExtent=d.maxExtent.clone());OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[e,d]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,[e,d]);this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(d){var c=null==this.opacity?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(c)},display:function(b){this._dragging||this.setGMapVisibility(b);OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(e,d,f){this._dragging=f;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(d){d!==this.opacity&&(null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=d);if(this.getVisibility()){var c=this.getMapContainer();OpenLayers.Util.modifyDOMElement(c,null,null,null,null,null,null,d)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var b=OpenLayers.Layer.Google.cache[this.map.id];b&&1>=b.count&&this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var d=OpenLayers.Layer.Google.cache[this.map.id];if(d){var c=this.mapObject&&this.getMapContainer();c&&c.parentNode&&c.parentNode.removeChild(c);(c=d.termsOfUse)&&c.parentNode&&c.parentNode.removeChild(c);(d=d.poweredBy)&&d.parentNode&&d.parentNode.removeChild(d)}},removeMap:function(d){this.visibility&&this.mapObject&&this.setGMapVisibility(!1);var c=OpenLayers.Layer.Google.cache[d.id];c&&(1>=c.count?(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[d.id]):--c.count);delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(d){var c=null;null!=d&&(c=d.getSouthWest(),d=d.getNorthEast(),this.sphericalMercator?(c=this.forwardMercator(c.lng(),c.lat()),d=this.forwardMercator(d.lng(),d.lat())):(c=new OpenLayers.LonLat(c.lng(),c.lat()),d=new OpenLayers.LonLat(d.lng(),d.lat())),c=new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat));return c},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(b){return this.sphericalMercator?this.forwardMercator(b.lng(),b.lat()).lon:b.lng()},getLatitudeFromMapObjectLonLat:function(b){return this.sphericalMercator?this.forwardMercator(b.lng(),b.lat()).lat:b.lat()},getXFromMapObjectPixel:function(b){return b.x},getYFromMapObjectPixel:function(b){return b.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var h,g,l,k=OpenLayers.Layer.Google.cache[this.map.id];if(k){h=k.mapObject,g=k.termsOfUse,l=k.poweredBy,++k.count}else{var k=this.map.viewPortDiv,j=document.createElement("div");j.id=this.map.id+"_GMap2Container";j.style.position="absolute";j.style.width="100%";j.style.height="100%";k.appendChild(j);try{h=new GMap2(j),g=j.lastChild,k.appendChild(g),g.style.zIndex="1100",g.style.right="",g.style.bottom="",g.className="olLayerGoogleCopyright",l=j.lastChild,k.appendChild(l),l.style.zIndex="1100",l.style.right="",l.style.bottom="",l.className="olLayerGooglePoweredBy gmnoprint"}catch(i){throw i}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:h,termsOfUse:g,poweredBy:l,count:1}}this.mapObject=h;this.termsOfUse=g;this.poweredBy=l;-1===OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)&&this.mapObject.addMapType(this.type);"function"==typeof h.getDragObject?this.dragObject=h.getDragObject():this.dragPanMapObject=null;!1===this.isBaseLayer&&this.setGMapVisibility("none"!==this.div.style.display)},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded()){this.mapObject.checkResize()}else{if(!this._resized){var d=this,c=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(c);delete d._resized;d.mapObject.checkResize();d.moveTo(d.map.getCenter(),d.map.getZoom())})}this._resized=!0}},setGMapVisibility:function(e){var d=OpenLayers.Layer.Google.cache[this.map.id];if(d){var f=this.mapObject.getContainer();!0===e?(this.mapObject.setMapType(this.type),f.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",d.displayed=this.id):(d.displayed===this.id&&delete d.displayed,d.displayed||(f.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(d){var c=null;null!=d&&(c=this.sphericalMercator?this.inverseMercator(d.bottom,d.left):new OpenLayers.LonLat(d.bottom,d.left),d=this.sphericalMercator?this.inverseMercator(d.top,d.right):new OpenLayers.LonLat(d.top,d.right),c=new GLatLngBounds(new GLatLng(c.lat,c.lon),new GLatLng(d.lat,d.lon)));return c},setMapObjectCenter:function(d,c){this.mapObject.setCenter(d,c)},dragPanMapObject:function(d,c){this.dragObject.moveBy(new GSize(-d,c))},getMapObjectLonLatFromMapObjectPixel:function(b){return this.mapObject.fromContainerPixelToLatLng(b)},getMapObjectPixelFromMapObjectLonLat:function(b){return this.mapObject.fromLatLngToContainerPixel(b)},getMapObjectZoomFromMapObjectBounds:function(b){return this.mapObject.getBoundsZoomLevel(b)},getMapObjectLonLatFromLonLat:function(e,d){var f;this.sphericalMercator?(f=this.inverseMercator(e,d),f=new GLatLng(f.lat,f.lon)):f=new GLatLng(d,e);return f},getMapObjectPixelFromXY:function(d,c){return new GPoint(d,c)}};OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.bounds=this.id=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(b){b&&(this.bounds=b.clone())},clearBounds:function(){this.bounds=null;this.parent&&this.parent.clearBounds()},extendBounds:function(b){this.getBounds()?this.bounds.extend(b):this.setBounds(b)},getBounds:function(){null==this.bounds&&this.calculateBounds();return this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(f,e,h){var g=!1;null!=this.getBounds()&&null!=f&&(e=null!=e?e:0,h=null!=h?h:0,g=(new OpenLayers.Bounds(this.bounds.left-e,this.bounds.bottom-h,this.bounds.right+e,this.bounds.top+h)).containsLonLat(f));return g},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(f){var e;if(OpenLayers.Format&&OpenLayers.Format.WKT){var h=OpenLayers.Geometry.fromWKT.format;h||(h=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=h);f=h.read(f);if(f instanceof OpenLayers.Feature.Vector){e=f.geometry}else{if(OpenLayers.Util.isArray(f)){e=f.length;for(var h=Array(e),g=0;g<e;++g){h[g]=f[g].geometry}e=new OpenLayers.Geometry.Collection(h)}}}return e};OpenLayers.Geometry.segmentsIntersect=function(x,w,v){var u=v&&v.point,v=v&&v.tolerance,t=!1,s=x.x1-w.x1,r=x.y1-w.y1,q=x.x2-x.x1,p=x.y2-x.y1,n=w.y2-w.y1,m=w.x2-w.x1,l=n*q-m*p,n=m*r-n*s,r=q*r-p*s;0==l?0==n&&0==r&&(t=!0):(s=n/l,l=r/l,0<=s&&(1>=s&&0<=l&&1>=l)&&(u?(q=x.x1+s*q,l=x.y1+s*p,t=new OpenLayers.Geometry.Point(q,l)):t=!0));if(v){if(t){if(u){x=[x,w];w=0;x:for(;2>w;++w){s=x[w];for(p=1;3>p;++p){if(q=s["x"+p],l=s["y"+p],u=Math.sqrt(Math.pow(q-t.x,2)+Math.pow(l-t.y,2)),u<v){t.x=q;t.y=l;break x}}}}}else{x=[x,w];w=0;x:for(;2>w;++w){q=x[w];l=x[(w+1)%2];for(p=1;3>p;++p){if(s={x:q["x"+p],y:q["y"+p]},r=OpenLayers.Geometry.distanceToSegment(s,l),r.distance<v){t=u?new OpenLayers.Geometry.Point(s.x,s.y):!0;break x}}}}}return t};OpenLayers.Geometry.distanceToSegment=function(v,u){var t=v.x,s=v.y,r=u.x1,q=u.y1,p=u.x2,o=u.y2,n=p-r,m=o-q,l=(n*(t-r)+m*(s-q))/(Math.pow(n,2)+Math.pow(m,2));0>=l||(1<=l?(r=p,q=o):(r+=l*n,q+=l*m));return{distance:Math.sqrt(Math.pow(r-t,2)+Math.pow(q-s,2)),x:r,y:q}};OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(b){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];null!=b&&this.addComponents(b)},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var a=eval("new "+this.CLASS_NAME+"()"),b=0,c=this.components.length;b<c;b++){a.addComponent(this.components[b].clone())}OpenLayers.Util.applyDefaults(a,this);return a},getComponentsString:function(){for(var e=[],d=0,f=this.components.length;d<f;d++){e.push(this.components[d].toShortString())}return e.join(",")},calculateBounds:function(){this.bounds=null;var f=new OpenLayers.Bounds,e=this.components;if(e){for(var h=0,g=e.length;h<g;h++){f.extend(e[h].getBounds())}}null!=f.left&&(null!=f.bottom&&null!=f.right&&null!=f.top)&&this.setBounds(f)},addComponents:function(e){OpenLayers.Util.isArray(e)||(e=[e]);for(var d=0,f=e.length;d<f;d++){this.addComponent(e[d])}},addComponent:function(f,e){var h=!1;if(f&&(null==this.componentTypes||-1<OpenLayers.Util.indexOf(this.componentTypes,f.CLASS_NAME))){if(null!=e&&e<this.components.length){var h=this.components.slice(0,e),g=this.components.slice(e,this.components.length);h.push(f);this.components=h.concat(g)}else{this.components.push(f)}f.parent=this;this.clearBounds();h=!0}return h},removeComponents:function(e){var d=!1;OpenLayers.Util.isArray(e)||(e=[e]);for(var f=e.length-1;0<=f;--f){d=this.removeComponent(e[f])||d}return d},removeComponent:function(b){OpenLayers.Util.removeItem(this.components,b);this.clearBounds();return !0},getLength:function(){for(var e=0,d=0,f=this.components.length;d<f;d++){e+=this.components[d].getLength()}return e},getArea:function(){for(var e=0,d=0,f=this.components.length;d<f;d++){e+=this.components[d].getArea()}return e},getGeodesicArea:function(f){for(var e=0,h=0,g=this.components.length;h<g;h++){e+=this.components[h].getGeodesicArea(f)}return e},getCentroid:function(r){if(!r){return this.components.length&&this.components[0].getCentroid()}r=this.components.length;if(!r){return !1}for(var q=[],p=[],o=0,n=Number.MAX_VALUE,m,l=0;l<r;++l){m=this.components[l];var k=m.getArea();m=m.getCentroid(!0);!isNaN(k)&&(!isNaN(m.x)&&!isNaN(m.y))&&(q.push(k),o+=k,n=k<n&&0<k?k:n,p.push(m))}r=q.length;if(0===o){for(l=0;l<r;++l){q[l]=1}o=q.length}else{for(l=0;l<r;++l){q[l]/=n}o/=n}for(var j=n=0,l=0;l<r;++l){m=p[l],k=q[l],n+=m.x*k,j+=m.y*k}return new OpenLayers.Geometry.Point(n/o,j/o)},getGeodesicLength:function(f){for(var e=0,h=0,g=this.components.length;h<g;h++){e+=this.components[h].getGeodesicLength(f)}return e},move:function(f,e){for(var h=0,g=this.components.length;h<g;h++){this.components[h].move(f,e)}},rotate:function(f,e){for(var h=0,g=this.components.length;h<g;++h){this.components[h].rotate(f,e)}},resize:function(f,e,h){for(var g=0;g<this.components.length;++g){this.components[g].resize(f,e,h)}return this},distanceTo:function(r,q){for(var p=!(q&&!1===q.edge)&&q&&q.details,o,n,m,l=Number.POSITIVE_INFINITY,k=0,j=this.components.length;k<j&&!(o=this.components[k].distanceTo(r,q),m=p?o.distance:o,m<l&&(l=m,n=o,0==l));++k){}return n},equals:function(f){var e=!0;if(!f||!f.CLASS_NAME||this.CLASS_NAME!=f.CLASS_NAME){e=!1}else{if(!OpenLayers.Util.isArray(f.components)||f.components.length!=this.components.length){e=!1}else{for(var h=0,g=this.components.length;h<g;++h){if(!this.components[h].equals(f.components[h])){e=!1;break}}}}return e},transform:function(f,e){if(f&&e){for(var h=0,g=this.components.length;h<g;h++){this.components[h].transform(f,e)}this.bounds=null}return this},intersects:function(f){for(var e=!1,h=0,g=this.components.length;h<g&&!(e=f.intersects(this.components[h]));++h){}return e},getVertices:function(f){for(var e=[],h=0,g=this.components.length;h<g;++h){Array.prototype.push.apply(e,this.components[h].getVertices(f))}return e},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(d,c){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(d);this.y=parseFloat(c)},clone:function(b){null==b&&(b=new OpenLayers.Geometry.Point(this.x,this.y));OpenLayers.Util.applyDefaults(b,this);return b},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(j,i){var p=!(i&&!1===i.edge)&&i&&i.details,o,n,m,l,k;j instanceof OpenLayers.Geometry.Point?(n=this.x,m=this.y,l=j.x,k=j.y,o=Math.sqrt(Math.pow(n-l,2)+Math.pow(m-k,2)),o=!p?o:{x0:n,y0:m,x1:l,y1:k,distance:o}):(o=j.distanceTo(this,i),p&&(o={x0:o.x1,y0:o.y1,x1:o.x0,y1:o.y0,distance:o.distance}));return o},equals:function(d){var c=!1;null!=d&&(c=this.x==d.x&&this.y==d.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(d.x)&&isNaN(d.y));return c},toShortString:function(){return this.x+", "+this.y},move:function(d,c){this.x+=d;this.y+=c;this.clearBounds()},rotate:function(f,e){var f=f*(Math.PI/180),h=this.distanceTo(e),g=f+Math.atan2(this.y-e.y,this.x-e.x);this.x=e.x+h*Math.cos(g);this.y=e.y+h*Math.sin(g);this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(e,d,f){this.x=d.x+e*(void 0==f?1:f)*(this.x-d.x);this.y=d.y+e*(this.y-d.y);this.clearBounds();return this},intersects:function(d){var c=!1;return c="OpenLayers.Geometry.Point"==d.CLASS_NAME?this.equals(d):d.intersects(this)},transform:function(d,c){d&&c&&(OpenLayers.Projection.transform(this,d,c),this.bounds=null);return this},getVertices:function(){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(d,c){this.addComponent(d,c)},removePoint:function(b){this.removeComponent(b)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var e=0;if(this.components&&1<this.components.length){for(var d=1,f=this.components.length;d<f;d++){e+=this.components[d-1].distanceTo(this.components[d])}}return e},getGeodesicLength:function(h){var g=this;if(h){var l=new OpenLayers.Projection("EPSG:4326");l.equals(h)||(g=this.clone().transform(h,l))}h=0;if(g.components&&1<g.components.length){for(var k,j=1,i=g.components.length;j<i;j++){l=g.components[j-1],k=g.components[j],h+=OpenLayers.Util.distVincenty({lon:l.x,lat:l.y},{lon:k.x,lat:k.y})}}return 1000*h},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(d){var c=this.components&&2<this.components.length;c&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);return c},intersects:function(D){var C=!1,B=D.CLASS_NAME;if("OpenLayers.Geometry.LineString"==B||"OpenLayers.Geometry.LinearRing"==B||"OpenLayers.Geometry.Point"==B){var A=this.getSortedSegments(),D="OpenLayers.Geometry.Point"==B?[{x1:D.x,y1:D.y,x2:D.x,y2:D.y}]:D.getSortedSegments(),z,y,x,w,v,u,t,p=0,r=A.length;D:for(;p<r;++p){B=A[p];z=B.x1;y=B.x2;x=B.y1;w=B.y2;var s=0,q=D.length;for(;s<q;++s){v=D[s];if(v.x1>y){break}if(!(v.x2<z)&&(u=v.y1,t=v.y2,!(Math.min(u,t)>Math.max(x,w))&&!(Math.max(u,t)<Math.min(x,w))&&OpenLayers.Geometry.segmentsIntersect(B,v))){C=!0;break D}}}}else{C=D.intersects(this)}return C},getSortedSegments:function(){for(var g=this.components.length-1,f=Array(g),j,i,h=0;h<g;++h){j=this.components[h],i=this.components[h+1],f[h]=j.x<i.x?{x1:j.x,y1:j.y,x2:i.x,y2:i.y}:{x1:i.x,y1:i.y,x2:j.x,y2:j.y}}return f.sort(function(d,c){return d.x1-c.x1})},splitWithSegment:function(J,I){for(var H=!(I&&!1===I.edge),G=I&&I.tolerance,F=[],E=this.getVertices(),D=[],C=[],B=!1,A,z,v,x={point:!0,tolerance:G},y=null,w=0,t=E.length-2;w<=t;++w){if(G=E[w],D.push(G.clone()),A=E[w+1],z={x1:G.x,y1:G.y,x2:A.x,y2:A.y},z=OpenLayers.Geometry.segmentsIntersect(J,z,x),z instanceof OpenLayers.Geometry.Point&&((v=z.x===J.x1&&z.y===J.y1||z.x===J.x2&&z.y===J.y2||z.equals(G)||z.equals(A)?!0:!1)||H)){z.equals(C[C.length-1])||C.push(z.clone()),!(0===w&&z.equals(G))&&!z.equals(A)&&(B=!0,z.equals(G)||D.push(z),F.push(new OpenLayers.Geometry.LineString(D)),D=[z.clone()])}}B&&(D.push(A.clone()),F.push(new OpenLayers.Geometry.LineString(D)));if(0<C.length){var u=J.x1<J.x2?1:-1,s=J.y1<J.y2?1:-1,y={lines:F,points:C.sort(function(d,c){return u*d.x-u*c.x||s*d.y-s*c.y})}}return y},split:function(N,M){var L=null,K=M&&M.mutual,J,I,H,G;if(N instanceof OpenLayers.Geometry.LineString){var F=this.getVertices(),E,D,z,B,C,A=[];H=[];for(var x=0,y=F.length-2;x<=y;++x){E=F[x];D=F[x+1];z={x1:E.x,y1:E.y,x2:D.x,y2:D.y};G=G||[N];K&&A.push(E.clone());for(var w=0;w<G.length;++w){if(B=G[w].splitWithSegment(z,M)){if(C=B.lines,0<C.length&&(C.unshift(w,1),Array.prototype.splice.apply(G,C),w+=C.length-2),K){for(var v=0,u=B.points.length;v<u;++v){C=B.points[v],C.equals(E)||(A.push(C),H.push(new OpenLayers.Geometry.LineString(A)),A=C.equals(D)?[]:[C.clone()])}}}}}K&&(0<H.length&&0<A.length)&&(A.push(D.clone()),H.push(new OpenLayers.Geometry.LineString(A)))}else{L=N.splitWith(this,M)}G&&1<G.length?I=!0:G=[];H&&1<H.length?J=!0:H=[];if(I||J){L=K?[H,G]:G}return L},splitWith:function(d,c){return d.split(this,c)},getVertices:function(b){return !0===b?[this.components[0],this.components[this.components.length-1]]:!1===b?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(H,G){var F=!(G&&!1===G.edge)&&G&&G.details,E,D={},C=Number.POSITIVE_INFINITY;if(H instanceof OpenLayers.Geometry.Point){for(var B=this.getSortedSegments(),A=H.x,z=H.y,y,x=0,t=B.length;x<t;++x){if(y=B[x],E=OpenLayers.Geometry.distanceToSegment(H,y),E.distance<C){if(C=E.distance,D=E,0===C){break}}else{if(y.x2>A&&(z>y.y1&&z<y.y2||z<y.y1&&z>y.y2)){break}}}D=F?{distance:D.distance,x0:D.x,y0:D.y,x1:A,y1:z}:D.distance}else{if(H instanceof OpenLayers.Geometry.LineString){var B=this.getSortedSegments(),A=H.getSortedSegments(),v,w,u=A.length,r={point:!0},x=0,t=B.length;H:for(;x<t;++x){z=B[x];y=z.x1;w=z.y1;for(var s=0;s<u;++s){if(E=A[s],v=OpenLayers.Geometry.segmentsIntersect(z,E,r)){C=0;D={distance:0,x0:v.x,y0:v.y,x1:v.x,y1:v.y};break H}else{E=OpenLayers.Geometry.distanceToSegment({x:y,y:w},E),E.distance<C&&(C=E.distance,D={distance:C,x0:y,y0:w,x1:E.x,y1:E.y})}}}F||(D=D.distance);0!==C&&z&&(E=H.distanceTo(new OpenLayers.Geometry.Point(z.x2,z.y2),G),x=F?E.distance:E,x<C&&(D=F?{distance:C,x0:E.x1,y0:E.y1,x1:E.x0,y1:E.y0}:x))}else{D=H.distanceTo(this,G),F&&(D={distance:D.distance,x0:D.x1,y0:D.y1,x1:D.x0,y1:D.y0})}}return D},simplify:function(g){if(this&&null!==this){var f=this.getVertices();if(3>f.length){return this}var j=function(w,v,u,t){for(var s=0,r=0,c=v,p;c<u;c++){p=w[v];var q=w[u],e=w[c],e=Math.abs(0.5*(p.x*q.y+q.x*e.y+e.x*p.y-q.x*p.y-e.x*q.y-p.x*e.y));p=Math.sqrt(Math.pow(p.x-q.x,2)+Math.pow(p.y-q.y,2));p=2*(e/p);p>s&&(s=p,r=c)}s>t&&r!=v&&(h.push(r),j(w,v,r,t),j(w,r,u,t))},i=f.length-1,h=[];h.push(0);for(h.push(i);f[0].equals(f[i]);){i--,h.push(i)}j(f,0,i,g);g=[];h.sort(function(d,c){return d-c});for(i=0;i<h.length;i++){g.push(f[h[i]])}return new OpenLayers.Geometry.LineString(g)}return this},CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(f,e){var h=!1,g=this.components.pop();if(null!=e||!f.equals(g)){h=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments)}OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]);return h},removeComponent:function(d){var c=this.components&&3<this.components.length;c&&(this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments),OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]));return c},move:function(f,e){for(var h=0,g=this.components.length;h<g-1;h++){this.components[h].move(f,e)}},rotate:function(f,e){for(var h=0,g=this.components.length;h<g-1;++h){this.components[h].rotate(f,e)}},resize:function(g,f,j){for(var i=0,h=this.components.length;i<h-1;++i){this.components[i].resize(g,f,j)}return this},transform:function(f,e){if(f&&e){for(var h=0,g=this.components.length;h<g-1;h++){this.components[h].transform(f,e)}this.bounds=null}return this},getCentroid:function(){if(this.components&&2<this.components.length){for(var g=0,f=0,j=0;j<this.components.length-1;j++){var i=this.components[j],h=this.components[j+1],g=g+(i.x+h.x)*(i.x*h.y-h.x*i.y),f=f+(i.y+h.y)*(i.x*h.y-h.x*i.y)}j=-1*this.getArea();return new OpenLayers.Geometry.Point(g/(6*j),f/(6*j))}return null},getArea:function(){var g=0;if(this.components&&2<this.components.length){for(var f=g=0,j=this.components.length;f<j-1;f++){var i=this.components[f],h=this.components[f+1],g=g+(i.x+h.x)*(h.y-i.y)}g=-g/2}return g},getGeodesicArea:function(h){var g=this;if(h){var l=new OpenLayers.Projection("EPSG:4326");l.equals(h)||(g=this.clone().transform(h,l))}h=0;l=g.components&&g.components.length;if(2<l){for(var k,j,i=0;i<l-1;i++){k=g.components[i],j=g.components[i+1],h+=OpenLayers.Util.rad(j.x-k.x)*(2+Math.sin(OpenLayers.Util.rad(k.y))+Math.sin(OpenLayers.Util.rad(j.y)))}h=40680631590769*h/2}return h},containsPoint:function(v){for(var u=OpenLayers.Number.limitSigDigs,t=u(v.x,14),v=u(v.y,14),s=this.components.length-1,r,q,p,o,n,m=0,l=0;l<s;++l){if(r=this.components[l],p=u(r.x,14),r=u(r.y,14),q=this.components[l+1],o=u(q.x,14),q=u(q.y,14),r==q){if(v==r&&(p<=o&&t>=p&&t<=o||p>=o&&t<=p&&t>=o)){m=-1;break}}else{n=u((v-q)*((o-p)/(q-r))+o,14);if(n==t&&(r<q&&v>=r&&v<=q||r>q&&v<=r&&v>=q)){m=-1;break}n<=t||p!=o&&(n<Math.min(p,o)||n>Math.max(p,o))||(r<q&&v>=r&&v<q||r>q&&v<r&&v>=q)&&++m}}return -1==m?1:!!(m&1)},intersects:function(f){var e=!1;if("OpenLayers.Geometry.Point"==f.CLASS_NAME){e=this.containsPoint(f)}else{if("OpenLayers.Geometry.LineString"==f.CLASS_NAME){e=f.intersects(this)}else{if("OpenLayers.Geometry.LinearRing"==f.CLASS_NAME){e=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[f])}else{for(var h=0,g=f.components.length;h<g&&!(e=f.components[h].intersects(this));++h){}}}}return e},getVertices:function(b){return !0===b?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(f,e,h,g){OpenLayers.Layer.prototype.initialize.apply(this,[f,g]);this.url=e;this.params||(this.params=OpenLayers.Util.extend({},h))},destroy:function(){this.params=this.url=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(b){null==b&&(b=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions()));return b=OpenLayers.Layer.prototype.clone.apply(this,[b])},setUrl:function(b){this.url=b},mergeNewParams:function(b){this.params=OpenLayers.Util.extend(this.params,b);b=this.redraw();null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return b},redraw:function(b){return b?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(g,f){for(var j=1,i=0,h=g.length;i<h;i++){j*=g.charCodeAt(i)*this.URL_HASH_FACTOR,j-=Math.floor(j)}return f[Math.floor(j*f.length)]},getFullRequestString:function(h,g){var l=g||this.url,k=OpenLayers.Util.extend({},this.params),k=OpenLayers.Util.extend(k,h),j=OpenLayers.Util.getParameterString(k);OpenLayers.Util.isArray(l)&&(l=this.selectUrl(j,l));var j=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(l)),i;for(i in k){i.toUpperCase() in j&&delete k[i]}j=OpenLayers.Util.getParameterString(k);return OpenLayers.Util.urlAppend(l,j)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(h,g,l,k,j,i){this.layer=h;this.position=g.clone();this.setBounds(l);this.url=k;j&&(this.size=j.clone());this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,i);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}},unload:function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("unload"))},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(d){d||this.clear();var c=this.shouldDraw();c&&!d&&(c=!1!==this.events.triggerEvent("beforedraw"));return c},shouldDraw:function(){var e=!1,d=this.layer.maxExtent;if(d){var f=this.layer.map,f=f.baseLayer.wrapDateLine&&f.getMaxExtent();this.bounds.intersectsBounds(d,{inclusive:!1,worldBounds:f})&&(e=!0)}return e||this.layer.displayOutsideMaxExtent},setBounds:function(e){e=e.clone();if(this.layer.map.baseLayer.wrapDateLine){var d=this.layer.map.getMaxExtent(),f=this.layer.map.getResolution(),e=e.wrapDateLine(d,{leftTolerance:f,rightTolerance:f})}this.bounds=e},moveTo:function(e,d,f){null==f&&(f=!0);this.setBounds(e);this.position=d.clone();f&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(h,g,l,k,j,i){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=k;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(null!=this.maxGetUrlLength||this.layer.gutter||this.layerAlphaHack){this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden"}null!=this.maxGetUrlLength&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.frame=this.imgDiv=null);this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var b=OpenLayers.Tile.prototype.draw.apply(this,arguments);b?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.positionTile(),this.renderTile()):this.unload();return b},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var b=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(a){b==this.asyncRequestId&&(this.url=a,this.initImage())},this)}else{this.url=this.layer.getURL(this.bounds),this.initImage()}},positionTile:function(){var d=this.getTile().style,c=this.frame?this.size:this.layer.getImageSize(this.bounds);d.left=this.position.x+"%";d.top=this.position.y+"%";d.width=c.w+"%";d.height=c.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var d=this.imgDiv;if(d){OpenLayers.Event.stopObservingElement(d);var c=this.getTile();c.parentNode===this.layer.div&&this.layer.div.removeChild(c);this.setImgSrc();!0===this.layerAlphaHack&&(d.style.filter="");OpenLayers.Element.removeClass(d,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img");this.imgDiv.className="olTileImage";this.imgDiv.galleryImg="no";var e=this.imgDiv.style;if(this.frame){var d=0,f=0;this.layer.gutter&&(d=100*(this.layer.gutter/this.layer.tileSize.w),f=100*(this.layer.gutter/this.layer.tileSize.h));e.left=-d+"%";e.top=-f+"%";e.width=2*d+100+"%";e.height=2*f+100+"%"}e.visibility="hidden";e.opacity=0;1>this.layer.opacity&&(e.filter="alpha(opacity="+100*this.layer.opacity+")");e.position="absolute";this.layerAlphaHack&&(e.paddingTop=e.height,e.height="0",e.width="100%");this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var d=this.getImage();if(this.url&&d.getAttribute("src")==this.url){this.onImageLoad()}else{var c=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(d);OpenLayers.Event.observe(d,"load",OpenLayers.Function.bind(this.onImageLoad,this));OpenLayers.Event.observe(d,"error",OpenLayers.Function.bind(this.onImageError,this));this.imageReloadAttempts=0;this.setImgSrc(this.url)},this);d.getAttribute("src")==this.blankImageUrl?c():(OpenLayers.Event.observe(d,"load",c),OpenLayers.Event.observe(d,"error",c),this.crossOriginKeyword&&d.removeAttribute("crossorigin"),d.src=this.blankImageUrl)}},setImgSrc:function(d){var c=this.imgDiv;c.style.visibility="hidden";c.style.opacity=0;d&&(this.crossOriginKeyword&&("data:"!==d.substr(0,5)?c.setAttribute("crossorigin",this.crossOriginKeyword):c.removeAttribute("crossorigin")),c.src=d)},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var b;this.frame?(b=this.frame.cloneNode(!1),b.appendChild(this.imgDiv)):b=this.imgDiv;this.imgDiv=null;return b}},onImageLoad:function(){var e=this.imgDiv;OpenLayers.Event.stopObservingElement(e);e.style.visibility="inherit";e.style.opacity=this.layer.opacity;this.isLoading=!1;this.canvasContext=null;this.events.triggerEvent("loadend");if(7>parseFloat(navigator.appVersion.split("MSIE")[1])&&this.layer&&this.layer.div){var d=document.createElement("span");d.style.display="none";var f=this.layer.div;f.appendChild(d);window.setTimeout(function(){d.parentNode===f&&d.parentNode.removeChild(d)},0)}!0===this.layerAlphaHack&&(e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='scale')")},onImageError:function(){var b=this.imgDiv;null!=b.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(b,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var b=document.createElement("canvas");b.width=this.size.w;b.height=this.size.h;this.canvasContext=b.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,initialize:function(f,e,h,g){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this.tileQueue=[];null===this.removeBackBufferDelay&&(this.removeBackBufferDelay=this.singleTile?0:2500);null===this.className&&(this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid");OpenLayers.Animation.isNative||(this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(true);this.moveTimerId=null},this))},setMap:function(b){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,b);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){null!==this.moveTimerId&&(window.clearTimeout(this.moveTimerId),this.moveTimerId=null);this.clearTileQueue();null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null)},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var g=0,f=this.grid.length;g<f;g++){for(var j=this.grid[g],i=0,h=j.length;i<h;i++){this.destroyTile(j[i])}}this.grid=[];this.gridResolution=null}},clone:function(b){null==b&&(b=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions()));b=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[b]);null!=this.tileSize&&(b.tileSize=this.tileSize.clone());b.grid=[];b.gridResolution=null;b.backBuffer=null;b.backBufferTimerId=null;b.tileQueue=[];b.tileQueueId=null;b.loading=!1;b.moveTimerId=null;return b},moveTo:function(i,h,n){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);i=i||this.map.getExtent();if(null!=i){var m=!this.grid.length||h,l=this.getTilesBounds(),k=this.map.getResolution(),j=this.getServerResolution(k);if(this.singleTile){if(m||!n&&!l.containsBounds(i)){h&&"resize"!==this.transitionEffect&&this.removeBackBuffer(),(!h||"resize"===this.transitionEffect)&&this.applyBackBuffer(j),this.initSingleTile(i)}}else{(m=m||!l.intersectsBounds(i,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()}),k!==j?(i=this.map.calculateBounds(null,j),m&&this.transformDiv(j/k)):(this.div.style.width="100%",this.div.style.height="100%",this.div.style.left="0%",this.div.style.top="0%"),m)?(h&&"resize"===this.transitionEffect&&this.applyBackBuffer(j),this.initGriddedTiles(i)):this.moveGriddedTiles()}}},getTileData:function(v){var u=null,t=v.lon,s=v.lat,r=this.grid.length;if(this.map&&r){var q=this.map.getResolution(),v=this.tileSize.w,p=this.tileSize.h,o=this.grid[0][0].bounds,n=o.left,o=o.top;if(t<n&&this.map.baseLayer.wrapDateLine){var m=this.map.getMaxExtent().getWidth(),l=Math.ceil((n-t)/m),t=t+m*l}t=(t-n)/(q*v);s=(o-s)/(q*p);q=Math.floor(t);n=Math.floor(s);0<=n&&n<r&&(r=this.grid[n][q])&&(u={tile:r,i:Math.floor((t-q)*v),j:Math.floor((s-n)*p)})}return u},queueTileDraw:function(b){b=b.object;~OpenLayers.Util.indexOf(this.tileQueue,b)||this.tileQueue.push(b);this.tileQueueId||(this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,this),null,this.div));return !1},drawTileFromQueue:function(){0===this.tileQueue.length?this.clearTileQueue():this.tileQueue.shift().draw(!0)},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId);this.tileQueueId=null;this.tileQueue=[]},destroyTile:function(b){this.removeTileMonitoringHooks(b);b.destroy()},getServerResolution:function(e){e=e||this.map.getResolution();if(this.serverResolutions&&-1===OpenLayers.Util.indexOf(this.serverResolutions,e)){var d,f;for(d=this.serverResolutions.length-1;0<=d;d--){if(f=this.serverResolutions[d],f>e){e=f;break}}if(-1===d){throw"no appropriate resolution in serverResolutions"}}return e},getServerZoom:function(){var b=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,b):this.map.getZoomForResolution(b)+(this.zoomOffset||0)},transformDiv:function(f){this.div.style.width=100*f+"%";this.div.style.height=100*f+"%";var e=this.map.getSize(),h=parseInt(this.map.layerContainerDiv.style.left,10),g=(parseInt(this.map.layerContainerDiv.style.top,10)-e.h/2)*(f-1);this.div.style.left=(h-e.w/2)*(f-1)+"%";this.div.style.top=g+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(f){null!==this.backBufferTimerId&&this.removeBackBuffer();var e=this.backBuffer;if(!e){e=this.createBackBuffer();if(!e){return}this.div.insertBefore(e,this.div.firstChild);this.backBuffer=e;var h=this.grid[0][0].bounds;this.backBufferLonLat={lon:h.left,lat:h.top};this.backBufferResolution=this.gridResolution}var h=e.style,g=this.backBufferResolution/f;h.width=100*g+"%";h.height=100*g+"%";f=this.getViewPortPxFromLonLat(this.backBufferLonLat,f);h=parseInt(this.map.layerContainerDiv.style.left,10);g=parseInt(this.map.layerContainerDiv.style.top,10);e.style.left=Math.round(f.x-h)+"%";e.style.top=Math.round(f.y-g)+"%"},createBackBuffer:function(){var h;if(0<this.grid.length){h=document.createElement("div");h.id=this.div.id+"_bb";h.className="olBackBuffer";h.style.position="absolute";h.style.width="100%";h.style.height="100%";for(var g=0,l=this.grid.length;g<l;g++){for(var k=0,j=this.grid[g].length;k<j;k++){var i=this.grid[g][k].createBackBuffer();i&&(i.style.top=g*this.tileSize.h+"%",i.style.left=k*this.tileSize.w+"%",h.appendChild(i))}}}return h},removeBackBuffer:function(){this.backBuffer&&(this.div.removeChild(this.backBuffer),this.backBufferResolution=this.backBuffer=null,null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(){this.singleTile||this.moveGriddedTiles()},setTileSize:function(b){this.singleTile&&(b=this.map.getSize(),b.h=parseInt(b.h*this.ratio),b.w=parseInt(b.w*this.ratio));OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[b])},getTilesBounds:function(){var e=null,d=this.grid.length;if(d){var e=this.grid[d-1][0].bounds,d=this.grid[0].length*e.getWidth(),f=this.grid.length*e.getHeight(),e=new OpenLayers.Bounds(e.left,e.bottom,e.left+d,e.bottom+f)}return e},initSingleTile:function(e){this.clearTileQueue();var d=e.getCenterLonLat(),f=e.getWidth()*this.ratio,e=e.getHeight()*this.ratio,d=new OpenLayers.Bounds(d.lon-f/2,d.lat-e/2,d.lon+f/2,d.lat+e/2),f=this.map.getLayerPxFromLonLat({lon:d.left,lat:d.top});this.grid.length||(this.grid[0]=[]);(e=this.grid[0][0])?e.moveTo(d,f):(e=this.addTile(d,f),this.addTileMonitoringHooks(e),e.draw(),this.grid[0][0]=e);this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(i,h,n){var m=n*this.tileSize.w,n=n*this.tileSize.h,l=i.left-h.lon,k=Math.floor(l/m)-this.buffer,l=-(l/m-k)*this.tileSize.w,k=h.lon+k*m,i=i.top-(h.lat+n),j=Math.ceil(i/n)+this.buffer;return{tilelon:m,tilelat:n,tileoffsetlon:k,tileoffsetlat:h.lat+j*n,tileoffsetx:l,tileoffsety:-(j-i/n)*this.tileSize.h}},getTileOrigin:function(){var d=this.tileOrigin;if(!d){var d=this.getMaxExtent(),c={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner],d=new OpenLayers.LonLat(d[c[0]],d[c[1]])}return d},initGriddedTiles:function(P){this.clearTileQueue();var O=this.map.getSize(),N=Math.ceil(O.h/this.tileSize.h)+Math.max(1,2*this.buffer),O=Math.ceil(O.w/this.tileSize.w)+Math.max(1,2*this.buffer),M=this.getTileOrigin(),L=this.getServerResolution(),M=this.calculateGridLayout(P,M,L),L=Math.round(M.tileoffsetx),K=Math.round(M.tileoffsety),J=M.tileoffsetlon,I=M.tileoffsetlat,H=M.tilelon,G=M.tilelat,F=L,B=J,D=0,E=parseInt(this.map.layerContainerDiv.style.left),C=parseInt(this.map.layerContainerDiv.style.top),M=[],z=this.map.getCenter();do{var A=this.grid[D++];A||(A=[],this.grid.push(A));var J=B,L=F,y=0;do{var x=new OpenLayers.Bounds(J,I,J+H,I+G),w=L,w=w-E,v=K,v=v-C,v=new OpenLayers.Pixel(w,v);(w=A[y++])?w.moveTo(x,v,!1):(w=this.addTile(x,v),this.addTileMonitoringHooks(w),A.push(w));x=x.getCenterLonLat();M.push({tile:w,distance:Math.pow(x.lon-z.lon,2)+Math.pow(x.lat-z.lat,2)});J+=H;L+=this.tileSize.w}while(J<=P.right+H*this.buffer||y<O);I-=G;K+=this.tileSize.h}while(I>=P.bottom-G*this.buffer||D<N);this.removeExcessTiles(D,y);this.gridResolution=this.getServerResolution();M.sort(function(d,c){return d.distance-c.distance});P=0;for(N=M.length;P<N;++P){M[P].tile.draw()}},getMaxExtent:function(){return this.maxExtent},addTile:function(e,d){var f=new this.tileClass(this,d,e,null,this.tileSize,this.tileOptions);f.events.register("beforedraw",this,this.queueTileDraw);return f},addTileMonitoringHooks:function(b){b.onLoadStart=function(){!1===this.loading&&(this.loading=!0,this.events.triggerEvent("loadstart"));this.events.triggerEvent("tileloadstart",{tile:b});this.numLoadingTiles++};b.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded",{tile:b});0===this.tileQueue.length&&0===this.numLoadingTiles&&(this.loading=!1,this.events.triggerEvent("loadend"),this.backBuffer&&(this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)))};b.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:b})};b.events.on({loadstart:b.onLoadStart,loadend:b.onLoadEnd,unload:b.onLoadEnd,loaderror:b.onLoadError,scope:this})},removeTileMonitoringHooks:function(b){b.unload();b.events.un({loadstart:b.onLoadStart,loadend:b.onLoadEnd,unload:b.onLoadEnd,loaderror:b.onLoadError,scope:this})},moveGriddedTiles:function(h){if(!h&&!OpenLayers.Animation.isNative){null!=this.moveTimerId&&window.clearTimeout(this.moveTimerId),this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay)}else{for(var h=this.buffer||1,g=this.getResolutionScale();;){var l=this.grid[0][0].position.x*g+parseInt(this.div.style.left,10)+parseInt(this.map.layerContainerDiv.style.left),k=this.grid[0][0].position.y*g+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top),j=this.tileSize.w*g,i=this.tileSize.h*g;if(l>-j*(h-1)){this.shiftColumn(!0)}else{if(l<-j*h){this.shiftColumn(!1)}else{if(k>-i*(h-1)){this.shiftRow(!0)}else{if(k<-i*h){this.shiftRow(!1)}else{break}}}}}}},shiftRow:function(t){for(var s=this.grid,r=s[t?0:this.grid.length-1],q=this.getServerResolution(),p=t?-this.tileSize.h:this.tileSize.h,q=q*-p,o=t?s.pop():s.shift(),n=0,m=r.length;n<m;n++){var l=r[n],k=l.bounds.clone(),l=l.position.clone();k.bottom+=q;k.top+=q;l.y+=p;o[n].moveTo(k,l)}t?s.unshift(o):s.push(o)},shiftColumn:function(r){for(var q=r?-this.tileSize.w:this.tileSize.w,p=this.getServerResolution()*q,o=0,n=this.grid.length;o<n;o++){var m=this.grid[o],l=m[r?0:m.length-1],k=l.bounds.clone(),l=l.position.clone();k.left+=p;k.right+=p;l.x+=q;var j=r?this.grid[o].pop():this.grid[o].shift();j.moveTo(k,l);r?m.unshift(j):m.push(j)}},removeExcessTiles:function(h,g){for(var l,k;this.grid.length>h;){var j=this.grid.pop();l=0;for(k=j.length;l<k;l++){var i=j[l];this.destroyTile(i)}}l=0;for(k=this.grid.length;l<k;l++){for(;this.grid[l].length>g;){j=this.grid[l],i=j.pop(),this.destroyTile(i)}}},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(g){var f=this.maxExtent,j=this.getResolution(),i=j*this.tileSize.w,j=j*this.tileSize.h,h=this.getLonLatFromViewPortPx(g),g=f.left+i*Math.floor((h.lon-f.left)/i),f=f.bottom+j*Math.floor((h.lat-f.bottom)/j);return new OpenLayers.Bounds(g,f,g+i,f+j)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(e,d,f){if(f&&f.sphericalMercator||this.sphericalMercator){f=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},f)}OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e||this.name,d||this.url,{},f])},clone:function(b){null==b&&(b=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions()));return b=OpenLayers.Layer.Grid.prototype.clone.apply(this,[b])},getURL:function(d){var d=this.getXYZ(d),c=this.url;OpenLayers.Util.isArray(c)&&(c=this.selectUrl(""+d.x+d.y+d.z,c));return OpenLayers.String.format(c,d)},getXYZ:function(f){var e=this.getServerResolution(),h=Math.round((f.left-this.maxExtent.left)/(e*this.tileSize.w)),f=Math.round((this.maxExtent.top-f.top)/(e*this.tileSize.h)),e=this.getServerZoom();if(this.wrapDateLine){var g=Math.pow(2,e),h=(h%g+g)%g}return{x:h,y:f,z:e}},setMap:function(b){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(e,d,f){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&&this.options.tileOptions)},clone:function(b){null==b&&(b=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions()));return b=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[b])},CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338,0.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',metadata:null,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,initialize:function(b){b=OpenLayers.Util.applyDefaults({sphericalMercator:!0},b);OpenLayers.Layer.XYZ.prototype.initialize.apply(this,[b.name||"Bing "+(b.type||this.type),null,b]);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions);this.loadMetadata()},loadMetadata:function(){this._callbackId="_callback_"+this.id.replace(/\./g,"_");window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var d=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),d="http://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(d),c=document.createElement("script");c.type="text/javascript";c.src=d;c.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(c)},initLayer:function(){var e=this.metadata.resourceSets[0].resources[0],d=e.imageUrl.replace("{quadkey}","${quadkey}"),d=d.replace("{culture}",this.culture);this.url=[];for(var f=0;f<e.imageUrlSubdomains.length;++f){this.url.push(d.replace("{subdomain}",e.imageUrlSubdomains[f]))}this.addOptions({maxResolution:Math.min(this.serverResolutions[e.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(e.zoomMax+1-e.zoomMin,this.numZoomLevels)},!0)},getURL:function(i){if(this.url){for(var h=this.getXYZ(i),i=h.x,n=h.y,h=h.z,m=[],l=h;0<l;--l){var k="0",j=1<<l-1;0!=(i&j)&&k++;0!=(n&j)&&(k++,k++);m.push(k)}m=m.join("");i=this.selectUrl(""+i+n+h,this.url);return OpenLayers.String.format(i,{quadkey:m})}},updateAttribution:function(){var x=this.metadata;if(x.resourceSets&&this.map&&this.map.center){var w=x.resourceSets[0].resources[0],v=this.map.getExtent().transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),w=w.imageryProviders,u=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),t="",s,r,q,p,n,m,l;r=0;for(q=w.length;r<q;++r){s=w[r];p=0;for(n=s.coverageAreas.length;p<n;++p){l=s.coverageAreas[p],m=OpenLayers.Bounds.fromArray(l.bbox,!0),v.intersectsBounds(m)&&(u<=l.zoomMax&&u>=l.zoomMin)&&(t+=s.attribution+" ")}}this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),logo:x.brandLogoUri,copyrights:t});this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments);this.updateAttribution();this.map.events.register("moveend",this,this.updateAttribution)},clone:function(b){null==b&&(b=new OpenLayers.Layer.Bing(this.options));return b=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[b])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution);OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"});OpenLayers.Layer.Bing.processMetadata=function(b){this.metadata=b;this.initLayer();b=document.getElementById(this._callbackId);b.parentNode.removeChild(b);window[this._callbackId]=void 0;delete this._callbackId};OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(e,d,f){OpenLayers.Util.extend(this,f);this.control=e;this.callbacks=d;(e=this.map||e.map)&&this.setMap(e);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(b){this.map=b},checkModifiers:function(b){return null==this.keyMask?!0:((b.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(b.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(b.altKey?OpenLayers.Handler.MOD_ALT:0))==this.keyMask},activate:function(){if(this.active){return !1}for(var e=OpenLayers.Events.prototype.BROWSER_EVENTS,d=0,f=e.length;d<f;d++){this[e[d]]&&this.register(e[d],this[e[d]])}return this.active=!0},deactivate:function(){if(!this.active){return !1}for(var e=OpenLayers.Events.prototype.BROWSER_EVENTS,d=0,f=e.length;d<f;d++){this[e[d]]&&this.unregister(e[d],this[e[d]])}this.active=!1;return !0},callback:function(d,c){d&&this.callbacks[d]&&this.callbacks[d].apply(this.control,c)},register:function(d,c){this.map.events.registerPriority(d,this,c);this.map.events.registerPriority(d,this,this.setEvent)},unregister:function(d,c){this.map.events.unregister(d,this,c);this.map.events.unregister(d,this,this.setEvent)},setEvent:function(b){this.evt=b;return !0},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(e,d,f){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(j){if(this.map&&this.checkModifiers(j)){for(var i=!1,p=!1,o=!1,n=OpenLayers.Event.element(j);null!=n&&!o&&!i;){if(!i){try{var m=n.currentStyle?n.currentStyle.overflow:document.defaultView.getComputedStyle(n,null).getPropertyValue("overflow"),i=m&&"auto"==m||"scroll"==m}catch(l){}}if(!p){for(var o=0,k=this.map.layers.length;o<k;o++){if(n==this.map.layers[o].div||n==this.map.layers[o].pane){p=!0;break}}}o=n==this.map.div;n=n.parentNode}!i&&o&&(p&&((i=0,j||(j=window.event),j.wheelDelta?(i=j.wheelDelta/120,window.opera&&9.2>window.opera.version()&&(i=-i)):j.detail&&(i=-j.detail/3),this.delta+=i,this.interval)?(window.clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(j)},this),this.interval)):this.wheelZoom(j)),OpenLayers.Event.stop(j))}},wheelZoom:function(d){var c=this.delta;this.delta=0;c&&(this.mousePosition&&(d.xy=this.mousePosition),d.xy||(d.xy=this.map.getPixelFromLonLat(this.map.getCenter())),0>c?this.callback("down",[d,this.cumulative?c:-1]):this.callback("up",[d,this.cumulative?c:1]))},mousemove:function(b){this.mousePosition=b.xy},activate:function(d){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var c=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",c);OpenLayers.Event.observe(window,"mousewheel",c);OpenLayers.Event.observe(document,"mousewheel",c);return !0}return !1},deactivate:function(d){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var c=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",c);OpenLayers.Event.stopObserving(window,"mousewheel",c);OpenLayers.Event.stopObserving(document,"mousewheel",c);return !0}return !1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(D,C){for(var B=null,A=C&&C.mutual,z,y,x,w,v=[],u=[D],t=0,p=this.components.length;t<p;++t){y=this.components[t];x=!1;for(var r=0;r<u.length;++r){if(z=y.split(u[r],C)){if(A){x=z[0];for(var s=0,q=x.length;s<q;++s){0===s&&v.length?v[v.length-1].addComponent(x[s]):v.push(new OpenLayers.Geometry.MultiLineString([x[s]]))}x=!0;z=z[1]}if(z.length){z.unshift(r,1);Array.prototype.splice.apply(u,z);break}}}x||(v.length?v[v.length-1].addComponent(y.clone()):v=[new OpenLayers.Geometry.MultiLineString(y.clone())])}v&&1<v.length?x=!0:v=[];u&&1<u.length?w=!0:u=[];if(x||w){B=A?[v,u]:u}return B},splitWith:function(B,A){var z=null,y=A&&A.mutual,x,w,v,u,t,s;if(B instanceof OpenLayers.Geometry.LineString){s=[];t=[B];for(var r=0,n=this.components.length;r<n;++r){v=!1;w=this.components[r];for(var p=0;p<t.length;++p){if(x=t[p].split(w,A)){y&&(v=x[0],v.length&&(v.unshift(p,1),Array.prototype.splice.apply(t,v),p+=v.length-2),x=x[1],0===x.length&&(x=[w.clone()]));v=0;for(var q=x.length;v<q;++v){0===v&&s.length?s[s.length-1].addComponent(x[v]):s.push(new OpenLayers.Geometry.MultiLineString([x[v]]))}v=!0}}v||(s.length?s[s.length-1].addComponent(w.clone()):s=[new OpenLayers.Geometry.MultiLineString([w.clone()])])}}else{z=B.split(this)}t&&1<t.length?u=!0:t=[];s&&1<s.length?v=!0:s=[];if(u||v){z=y?[t,s]:s}return z},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(d,c){this.container=OpenLayers.Util.getElement(d);OpenLayers.Util.extend(this,c)},destroy:function(){this.map=this.resolution=this.size=this.extent=this.container=null},supported:function(){return !1},setExtent:function(e,d){this.extent=e.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var f=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/f);this.extent=e.wrapDateLine(this.map.getMaxExtent()).scale(f)}d&&(this.resolution=null);return !0},setSize:function(b){this.size=b.clone();this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution()},drawFeature:function(i,h){null==h&&(h=i.style);if(i.geometry){var n=i.geometry.getBounds();if(n){var m;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(m=this.map.getMaxExtent());n.intersectsBounds(this.extent,{worldBounds:m})?this.calculateFeatureDx(n,m):h={display:"none"};n=this.drawGeometry(i.geometry,h,i.id);if("none"!=h.display&&h.label&&!1!==n){m=i.geometry.getCentroid();if(h.labelXOffset||h.labelYOffset){var l=isNaN(h.labelXOffset)?0:h.labelXOffset,k=isNaN(h.labelYOffset)?0:h.labelYOffset,j=this.getResolution();m.move(l*j,k*j)}this.drawText(i.id,h,m)}else{this.removeText(i.id)}return n}}},calculateFeatureDx:function(e,d){this.featureDx=0;if(d){var f=d.getWidth();this.featureDx=Math.round(((e.left+e.right)/2-(this.extent.left+this.extent.right)/2)/f)*f}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(f){OpenLayers.Util.isArray(f)||(f=[f]);for(var e=0,h=f.length;e<h;++e){var g=f[e];this.eraseGeometry(g.geometry,g.id);this.removeText(g.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(d){var c=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);!1===d.stroke&&(delete c.strokeWidth,delete c.strokeColor);!1===d.fill&&delete c.fillColor;OpenLayers.Util.extend(c,d);return c},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(b){this.compare=b?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(g){this.exists(g)&&this.remove(g);var f=g.id;this.determineZIndex(g);for(var j=-1,i=this.order.length,h;1<i-j;){h=parseInt((j+i)/2),0<this.compare(this,g,OpenLayers.Util.getElement(this.order[h]))?j=h:i=h}this.order.splice(i,0,f);this.indices[f]=this.getZIndex(g);return this.getNextElement(i)},remove:function(d){var d=d.id,c=OpenLayers.Util.indexOf(this.order,d);0<=c&&(this.order.splice(c,1),delete this.indices[d],this.maxZIndex=0<this.order.length?this.indices[this.order[this.order.length-1]]:0)},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(b){return null!=this.indices[b.id]},getZIndex:function(b){return b._style.graphicZIndex},determineZIndex:function(d){var c=d._style.graphicZIndex;null==c?(c=this.maxZIndex,d._style.graphicZIndex=c):c>this.maxZIndex&&(this.maxZIndex=c)},getNextElement:function(d){d+=1;if(d<this.order.length){var c=OpenLayers.Util.getElement(this.order[d]);void 0==c&&(c=this.getNextElement(d));return c}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"});OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(f,e,h){var e=f.getZIndex(e),g=0;h&&(f=f.getZIndex(h),g=e-f);return g},Z_ORDER_DRAWING_ORDER:function(e,d,f){e=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,d,f);f&&0==e&&(e=1);return e},Z_ORDER_Y_ORDER:function(e,d,f){e=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,d,f);f&&0===e&&(d=f._boundsBottom-d._boundsBottom,e=0===d?1:d);return e}};OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(d,c){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(c&&(c.zIndexing||c.yOrdering)){this.indexer=new OpenLayers.ElementsIndexer(c.yOrdering)}},destroy:function(){this.clear();this.xmlns=this.root=this.rendererRoot=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var d,c=this.vectorRoot;if(c){for(;d=c.firstChild;){c.removeChild(d)}}if(c=this.textRoot){for(;d=c.firstChild;){c.removeChild(d)}}this.indexer&&this.indexer.clear()},setExtent:function(h,g){var l=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),k=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var j,i=h.getWidth()/this.map.getExtent().getWidth(),h=h.scale(1/i),i=this.map.getMaxExtent();i.right>h.left&&i.right<h.right?j=!0:i.left>h.left&&i.left<h.right&&(j=!1);if(j!==this.rightOfDateLine||g){l=!1,this.xOffset=!0===j?i.getWidth()/k:0}this.rightOfDateLine=j}return l},getNodeType:function(){},drawGeometry:function(h,g,l){var k=h.CLASS_NAME,j=!0;if("OpenLayers.Geometry.Collection"==k||"OpenLayers.Geometry.MultiPoint"==k||"OpenLayers.Geometry.MultiLineString"==k||"OpenLayers.Geometry.MultiPolygon"==k){for(var k=0,i=h.components.length;k<i;k++){j=this.drawGeometry(h.components[k],g,l)&&j}return j}k=j=!1;"none"!=g.display&&(g.backgroundGraphic?this.redrawBackgroundNode(h.id,h,g,l):k=!0,j=this.redrawNode(h.id,h,g,l));if(!1==j&&(g=document.getElementById(h.id))){g._style.backgroundGraphic&&(k=!0),g.parentNode.removeChild(g)}k&&(g=document.getElementById(h.id+this.BACKGROUND_ID_SUFFIX))&&g.parentNode.removeChild(g);return j},redrawNode:function(f,e,h,g){h=this.applyDefaultSymbolizer(h);f=this.nodeFactory(f,this.getNodeType(e,h));f._featureId=g;f._boundsBottom=e.getBounds().bottom;f._geometryClass=e.CLASS_NAME;f._style=h;e=this.drawGeometryNode(f,e,h);if(!1===e){return !1}f=e.node;this.indexer?(h=this.indexer.insert(f))?this.vectorRoot.insertBefore(f,h):this.vectorRoot.appendChild(f):f.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(f);this.postDraw(f);return e.complete},redrawBackgroundNode:function(e,d,f){f=OpenLayers.Util.extend({},f);f.externalGraphic=f.backgroundGraphic;f.graphicXOffset=f.backgroundXOffset;f.graphicYOffset=f.backgroundYOffset;f.graphicZIndex=f.backgroundGraphicZIndex;f.graphicWidth=f.backgroundWidth||f.graphicWidth;f.graphicHeight=f.backgroundHeight||f.graphicHeight;f.backgroundGraphic=null;f.backgroundXOffset=null;f.backgroundYOffset=null;f.backgroundGraphicZIndex=null;return this.redrawNode(e+this.BACKGROUND_ID_SUFFIX,d,f,null)},drawGeometryNode:function(g,f,j){var j=j||g._style,i={isFilled:void 0===j.fill?!0:j.fill,isStroked:void 0===j.stroke?!!j.strokeWidth:j.stroke},h;switch(f.CLASS_NAME){case"OpenLayers.Geometry.Point":!1===j.graphic&&(i.isFilled=!1,i.isStroked=!1);h=this.drawPoint(g,f);break;case"OpenLayers.Geometry.LineString":i.isFilled=!1;h=this.drawLineString(g,f);break;case"OpenLayers.Geometry.LinearRing":h=this.drawLinearRing(g,f);break;case"OpenLayers.Geometry.Polygon":h=this.drawPolygon(g,f);break;case"OpenLayers.Geometry.Rectangle":h=this.drawRectangle(g,f)}g._options=i;return !1!=h?{node:this.setStyle(g,j,i,f),complete:h}:!1},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(d){var c=document.getElementById(d+this.LABEL_ID_SUFFIX);c&&this.textRoot.removeChild(c);(d=document.getElementById(d+this.LABEL_OUTLINE_SUFFIX))&&this.textRoot.removeChild(d)},getFeatureIdFromEvent:function(e){var d=e.target,f=d&&d.correspondingUseElement;return(f?f:d||e.srcElement)._featureId},eraseGeometry:function(f,e){if("OpenLayers.Geometry.MultiPoint"==f.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==f.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==f.CLASS_NAME||"OpenLayers.Geometry.Collection"==f.CLASS_NAME){for(var h=0,g=f.components.length;h<g;h++){this.eraseGeometry(f.components[h],e)}}else{if((h=OpenLayers.Util.getElement(f.id))&&h.parentNode){if(h.geometry&&(h.geometry.destroy(),h.geometry=null),h.parentNode.removeChild(h),this.indexer&&this.indexer.remove(h),h._style.backgroundGraphic){(h=OpenLayers.Util.getElement(f.id+this.BACKGROUND_ID_SUFFIX))&&h.parentNode&&h.parentNode.removeChild(h)}}}},nodeFactory:function(e,d){var f=OpenLayers.Util.getElement(e);f?this.nodeTypeCompare(f,d)||(f.parentNode.removeChild(f),f=this.nodeFactory(e,d)):f=this.createNode(d,e);return f},nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(d){var c=this.root;d.root.parentNode==this.rendererRoot&&(c=d.root);c.parentNode.removeChild(c);d.rendererRoot.appendChild(c)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(b){return"circle"!=b&&!!b},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,initialize:function(b){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,b);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"))},destroy:function(){this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null);this.eventListeners=null;this.handler&&(this.handler.destroy(),this.handler=null);if(this.handlers){for(var b in this.handlers){this.handlers.hasOwnProperty(b)&&"function"==typeof this.handlers[b].destroy&&this.handlers[b].destroy()}this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null);this.div=null},setMap:function(b){this.map=b;this.handler&&this.handler.setMap(b)},draw:function(b){if(null==this.div&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title)){this.div.title=this.title}null!=b&&(this.position=b.clone());this.moveTo(this.position);return this.div},moveTo:function(b){null!=b&&null!=this.div&&(this.div.style.left=b.x+"px",this.div.style.top=b.y+"px")},activate:function(){if(this.active){return !1}this.handler&&this.handler.activate();this.active=!0;this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return !0},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),!0):!1},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.controls=[];this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var d,c=this.controls.length-1;0<=c;c--){d=this.controls[c],d.events&&d.events.un({activate:this.iconOn,deactivate:this.iconOff}),d.panel_div=null}this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var e,d=0,f=this.controls.length;d<f;d++){e=this.controls[d],(e===this.defaultControl||this.saveState&&this.activeState[e.id])&&e.activate()}!0===this.saveState&&(this.defaultControl=null);this.redraw();return !0}return !1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var e,d=0,f=this.controls.length;d<f;d++){e=this.controls[d],this.activeState[e.id]=e.deactivate()}this.redraw();return !0}return !1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick);this.addControlsToMap(this.controls);return this.div},redraw:function(){for(var d=this.div.childNodes.length-1;0<=d;d--){this.div.removeChild(this.div.childNodes[d])}this.div.innerHTML="";if(this.active){for(var d=0,c=this.controls.length;d<c;d++){this.div.appendChild(this.controls[d].panel_div)}}},activateControl:function(f){if(!this.active){return !1}if(f.type==OpenLayers.Control.TYPE_BUTTON){f.trigger()}else{if(f.type==OpenLayers.Control.TYPE_TOGGLE){f.active?f.deactivate():f.activate()}else{if(this.allowDepress&&f.active){f.deactivate()}else{for(var e,h=0,g=this.controls.length;h<g;h++){e=this.controls[h],e!=f&&(e.type===OpenLayers.Control.TYPE_TOOL||null==e.type)&&e.deactivate()}f.activate()}}}},addControls:function(g){OpenLayers.Util.isArray(g)||(g=[g]);this.controls=this.controls.concat(g);for(var f=0,j=g.length;f<j;f++){var i=g[f],h=this.createControlMarkup(i);OpenLayers.Element.addClass(h,i.displayClass+"ItemInactive");OpenLayers.Element.addClass(h,"olButton");""!=i.title&&!h.title&&(h.title=i.title);i.panel_div=h}this.map&&(this.addControlsToMap(g),this.redraw())},createControlMarkup:function(){return document.createElement("div")},addControlsToMap:function(f){for(var e,h=0,g=f.length;h<g;h++){e=f[h],!0===e.autoActivate?(e.autoActivate=!1,this.map.addControl(e),e.autoActivate=!0):(this.map.addControl(e),e.deactivate()),e.events.on({activate:this.iconOn,deactivate:this.iconOff})}},iconOn:function(){var b=this.panel_div;b.className=b.className.replace(RegExp("\\b("+this.displayClass+"Item)Inactive\\b"),"$1Active")},iconOff:function(){var b=this.panel_div;b.className=b.className.replace(RegExp("\\b("+this.displayClass+"Item)Active\\b"),"$1Inactive")},onButtonClick:function(e){for(var d=this.controls,e=e.buttonElement,f=d.length-1;0<=f;--f){if(d[f].panel_div===e){this.activateControl(d[f]);break}}},getControlsBy:function(e,d){var f="function"==typeof d.test;return OpenLayers.Array.filter(this.controls,function(a){return a[e]==d||f&&d.test(a[e])})},getControlsByName:function(b){return this.getControlsBy("name",b)},getControlsByClass:function(b){return this.getControlsBy("CLASS_NAME",b)},CLASS_NAME:"OpenLayers.Control.Panel"});OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(b){OpenLayers.Util.extend(this,b);this.options=b;this.active=!1},destroy:function(){this.deactivate();this.options=this.layer=null},setLayer:function(b){this.layer=b},activate:function(){return !this.active?this.active=!0:!1},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){if(OpenLayers.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({refresh:this.load,scope:this});if(!0==this.layer.visibility||this.preload){this.load()}else{this.layer.events.on({visibilitychanged:this.load,scope:this})}return !0}return !1},deactivate:function(){var b=OpenLayers.Strategy.prototype.deactivate.call(this);b&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this});return b},load:function(d){var c=this.layer;c.events.triggerEvent("loadstart");c.protocol.read(OpenLayers.Util.applyDefaults({callback:OpenLayers.Function.bind(this.merge,this,c.map.getProjectionObject()),filter:c.filter},d));c.events.un({visibilitychanged:this.load,scope:this})},merge:function(i,h){var n=this.layer;n.destroyFeatures();var m=h.features;if(m&&0<m.length){if(!i.equals(n.projection)){for(var l,k=0,j=m.length;k<j;++k){(l=m[k].geometry)&&l.transform(n.projection,i)}}n.addFeatures(m)}n.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"-",zoomOutId:"olZoomOutLink",draw:function(){var f=OpenLayers.Control.prototype.draw.apply(this),e=this.getOrCreateLinks(f),h=e.zoomIn,e=e.zoomOut,g=this.map.events;e.parentNode!==f&&(g=this.events,g.attachToElement(e.parentNode));g.register("buttonclick",this,this.onZoomClick);this.zoomInLink=h;this.zoomOutLink=e;return f},getOrCreateLinks:function(e){var d=document.getElementById(this.zoomInId),f=document.getElementById(this.zoomOutId);d||(d=document.createElement("a"),d.href="#zoomIn",d.appendChild(document.createTextNode(this.zoomInText)),d.className="olControlZoomIn",e.appendChild(d));OpenLayers.Element.addClass(d,"olButton");f||(f=document.createElement("a"),f.href="#zoomOut",f.appendChild(document.createTextNode(this.zoomOutText)),f.className="olControlZoomOut",e.appendChild(f));OpenLayers.Element.addClass(f,"olButton");return{zoomIn:d,zoomOut:f}},onZoomClick:function(b){b=b.buttonElement;b===this.zoomInLink?this.map.zoomIn():b===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick);delete this.zoomInLink;delete this.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var e=0;if(this.components&&0<this.components.length){for(var e=e+Math.abs(this.components[0].getArea()),d=1,f=this.components.length;d<f;d++){e-=Math.abs(this.components[d].getArea())}}return e},getGeodesicArea:function(f){var e=0;if(this.components&&0<this.components.length){for(var e=e+Math.abs(this.components[0].getGeodesicArea(f)),h=1,g=this.components.length;h<g;h++){e-=Math.abs(this.components[h].getGeodesicArea(f))}}return e},containsPoint:function(g){var f=this.components.length,j=!1;if(0<f&&(j=this.components[0].containsPoint(g),1!==j&&j&&1<f)){for(var i,h=1;h<f;++h){if(i=this.components[h].containsPoint(g)){j=1===i?1:!1;break}}}return j},intersects:function(g){var f=!1,j,i;if("OpenLayers.Geometry.Point"==g.CLASS_NAME){f=this.containsPoint(g)}else{if("OpenLayers.Geometry.LineString"==g.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==g.CLASS_NAME){j=0;for(i=this.components.length;j<i&&!(f=g.intersects(this.components[j]));++j){}if(!f){j=0;for(i=g.components.length;j<i&&!(f=this.containsPoint(g.components[j]));++j){}}}else{j=0;for(i=g.components.length;j<i&&!(f=this.intersects(g.components[j]));++j){}}}if(!f&&"OpenLayers.Geometry.Polygon"==g.CLASS_NAME){var h=this.components[0];j=0;for(i=h.components.length;j<i&&!(f=g.containsPoint(h.components[j]));++j){}}return f},distanceTo:function(d,c){return c&&!1===c.edge&&this.intersects(d)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[d,c])},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(j,i,p,o){var n=Math.PI*(1/p-0.5);o&&(n+=o/180*Math.PI);for(var m,l=[],k=0;k<p;++k){m=n+2*k*Math.PI/p,o=j.x+i*Math.cos(m),m=j.y+i*Math.sin(m),l.push(new OpenLayers.Geometry.Point(o,m))}j=new OpenLayers.Geometry.LinearRing(l);return new OpenLayers.Geometry.Polygon([j])};OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(e,d,f){this.layer=e;this.lonlat=d;this.data=null!=f?f:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup);null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker);this.data=this.lonlat=this.id=this.layer=null;null!=this.marker&&(this.destroyMarker(this.marker),this.marker=null);null!=this.popup&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var b=!1;null!=this.layer&&null!=this.layer.map&&(b=this.layer.map.getExtent().containsLonLat(this.lonlat));return b},createMarker:function(){null!=this.lonlat&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon));return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(b){null!=this.lonlat&&(this.popup||(this.popup=new (this.popupClass?this.popupClass:OpenLayers.Popup.Anchored)(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,this.marker?this.marker.icon:null,b)),null!=this.data.overflow&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this);return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(e,d,f){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,d]);this.lonlat=null;this.geometry=e?e:null;this.state=null;this.attributes={};d&&(this.attributes=OpenLayers.Util.extend(this.attributes,d));this.style=f?f:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null);this.modified=this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(d){var c=!1;this.layer&&this.layer.map&&(c=this.layer.map.getExtent(),d?(d=this.geometry.getBounds(),c=c.intersectsBounds(d)):c=c.toGeometry().intersects(this.geometry));return c},getVisibility:function(){return !(this.style&&"none"==this.style.display||!this.layer||this.layer&&this.layer.styleMap&&"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(f,e,h){var g=!1;this.geometry&&(g=this.geometry.atPoint(f,e,h));return g},destroyPopup:function(){},move:function(e){if(this.layer&&this.geometry.move){var e="OpenLayers.LonLat"==e.CLASS_NAME?this.layer.getViewPortPxFromLonLat(e):e,d=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),f=this.layer.map.getResolution();this.geometry.move(f*(e.x-d.x),f*(d.y-e.y));this.layer.drawFeature(this);return d}},toState:function(b){if(b==OpenLayers.State.UPDATE){switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=b}}else{if(b==OpenLayers.State.INSERT){switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=b}}else{if(b==OpenLayers.State.DELETE){switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=b}}else{b==OpenLayers.State.UNKNOWN&&(this.state=b)}}}},CLASS_NAME:"OpenLayers.Feature.Vector"});OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(d,c){OpenLayers.Util.extend(this,c);this.rules=[];c&&c.rules&&this.addRules(c.rules);this.setDefaultStyle(d||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var d=0,c=this.rules.length;d<c;d++){this.rules[d].destroy(),this.rules[d]=null}this.defaultStyle=this.rules=null},createSymbolizer:function(j){for(var i=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),j),p=this.rules,o,n=[],m=!1,l=0,k=p.length;l<k;l++){o=p[l],o.evaluate(j)&&(o instanceof OpenLayers.Rule&&o.elseFilter?n.push(o):(m=!0,this.applySymbolizer(o,i,j)))}if(!1==m&&0<n.length){m=!0;l=0;for(k=n.length;l<k;l++){this.applySymbolizer(n[l],i,j)}}0<p.length&&!1==m&&(i.display="none");null!=i.label&&"string"!==typeof i.label&&(i.label=""+i.label);return i},applySymbolizer:function(f,e,h){var g=h.geometry?this.getSymbolizerPrefix(h.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],f=f.symbolizer[g]||f.symbolizer;!0===this.defaultsPerSymbolizer&&(g=this.defaultStyle,OpenLayers.Util.applyDefaults(f,{pointRadius:g.pointRadius}),(!0===f.stroke||!0===f.graphic)&&OpenLayers.Util.applyDefaults(f,{strokeWidth:g.strokeWidth,strokeColor:g.strokeColor,strokeOpacity:g.strokeOpacity,strokeDashstyle:g.strokeDashstyle,strokeLinecap:g.strokeLinecap}),(!0===f.fill||!0===f.graphic)&&OpenLayers.Util.applyDefaults(f,{fillColor:g.fillColor,fillOpacity:g.fillOpacity}),!0===f.graphic&&OpenLayers.Util.applyDefaults(f,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset}));return this.createLiterals(OpenLayers.Util.extend(e,f),h)},createLiterals:function(f,e){var h=OpenLayers.Util.extend({},e.attributes||e.data);OpenLayers.Util.extend(h,this.context);for(var g in this.propertyStyles){f[g]=OpenLayers.Style.createLiteral(f[g],h,e,g)}return f},findPropertyStyles:function(){var i={};this.addPropertyStyles(i,this.defaultStyle);for(var h=this.rules,n,m,l=0,k=h.length;l<k;l++){n=h[l].symbolizer;for(var j in n){if(m=n[j],"object"==typeof m){this.addPropertyStyles(i,m)}else{this.addPropertyStyles(i,n);break}}}return i},addPropertyStyles:function(f,e){var h,g;for(g in e){h=e[g],"string"==typeof h&&h.match(/\$\{\w+\}/)&&(f[g]=!0)}return f},addRules:function(b){Array.prototype.push.apply(this.rules,b);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(b){this.defaultStyle=b;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(f){for(var e=OpenLayers.Style.SYMBOLIZER_PREFIXES,h=0,g=e.length;h<g;h++){if(-1!=f.CLASS_NAME.indexOf(e[h])){return e[h]}}},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.rules){e.rules=[];for(var d=0,f=this.rules.length;d<f;++d){e.rules.push(this.rules[d].clone())}}e.context=this.context&&OpenLayers.Util.extend({},this.context);d=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(d,e)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(f,e,h,g){"string"==typeof f&&-1!=f.indexOf("${")&&(f=OpenLayers.String.format(f,e,[h,g]),f=isNaN(f)||!f?f:parseFloat(f));return f};OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Filter=OpenLayers.Class({initialize:function(b){OpenLayers.Util.extend(this,b)},destroy:function(){},evaluate:function(){return !0},clone:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"});OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(e){var d=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(e.geometry){var f=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&&(f=this.value.toGeometry());e.geometry.intersects(f)&&(d=!0)}break;default:throw Error("evaluate is not implemented for this filter type.")}return d},clone:function(){var b=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(b)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var b=OpenLayers.Strategy.prototype.activate.call(this);b&&(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update());return b},deactivate:function(){var b=OpenLayers.Strategy.prototype.deactivate.call(this);b&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this});return b},update:function(d){var c=this.getMapBounds();if(null!==c&&(d&&d.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(c))){this.calculateBounds(c),this.resolution=this.layer.map.getResolution(),this.triggerRead(d)}},getMapBounds:function(){if(null===this.layer.map){return null}var b=this.layer.map.getExtent();b&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(b=b.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection));return b},invalidBounds:function(b){b||(b=this.getMapBounds());b=!this.bounds||!this.bounds.containsBounds(b);!b&&this.resFactor&&(b=this.resolution/this.layer.map.getResolution(),b=b>=this.resFactor||b<=1/this.resFactor);return b},calculateBounds:function(e){e||(e=this.getMapBounds());var d=e.getCenterLonLat(),f=e.getWidth()*this.ratio,e=e.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(d.lon-f/2,d.lat-e/2,d.lon+f/2,d.lat+e/2)},triggerRead:function(b){this.response&&!(b&&!0===b.noAbort)&&(this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend"));this.layer.events.triggerEvent("loadstart");this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:this.createFilter(),callback:this.merge,scope:this},b))},createFilter:function(){var b=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&&(b=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,b]}));return b},merge:function(h){this.layer.destroyFeatures();if((h=h.features)&&0<h.length){var g=this.layer.projection,l=this.layer.map.getProjectionObject();if(!l.equals(g)){for(var k,j=0,i=h.length;j<i;++j){(k=h[j].geometry)&&k.transform(g,l)}}this.layer.addFeatures(h)}this.response=null;this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.BBOX"});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,touch:!1,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(f,e,h,g){OpenLayers.Handler.prototype.initialize.apply(this,[f,h,g]);this.layer=e},touchstart:function(b){this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this}));return OpenLayers.Event.isMultiTouch(b)?!0:this.mousedown(b)},touchmove:function(b){OpenLayers.Event.stop(b)},mousedown:function(b){if(OpenLayers.Event.isLeftClick(b)||OpenLayers.Event.isSingleTouch(b)){this.down=b.xy}return this.handle(b)?!this.stopDown:!0},mouseup:function(b){this.up=b.xy;return this.handle(b)?!this.stopUp:!0},click:function(b){return this.handle(b)?!this.stopClick:!0},mousemove:function(b){if(!this.callbacks.over&&!this.callbacks.out){return !0}this.handle(b);return !0},dblclick:function(b){return !this.handle(b)},geometryTypeMatches:function(b){return null==this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,b.geometry.CLASS_NAME)},handle:function(g){this.feature&&!this.feature.layer&&(this.feature=null);var f=g.type,j=!1,i=!!this.feature,h="click"==f||"dblclick"==f||"touchstart"==f;if((this.feature=this.layer.getFeatureFromEvent(g))&&!this.feature.layer){this.feature=null}this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=null);this.feature?("touchstart"===f&&OpenLayers.Event.stop(g),g=this.feature!=this.lastFeature,this.geometryTypeMatches(this.feature)?(i&&g?(this.lastFeature&&this.triggerCallback(f,"out",[this.lastFeature]),this.triggerCallback(f,"in",[this.feature])):(!i||h)&&this.triggerCallback(f,"in",[this.feature]),this.lastFeature=this.feature,j=!0):(this.lastFeature&&(i&&g||h)&&this.triggerCallback(f,"out",[this.lastFeature]),this.feature=null)):this.lastFeature&&(i||h)&&this.triggerCallback(f,"out",[this.lastFeature]);return j},triggerCallback:function(e,d,f){(d=this.EVENTMAP[e][d])&&("click"==e&&this.up&&this.down?Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2))<=this.clickTolerance&&this.callback(d,f):this.callback(d,f))},activate:function(){var b=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),b=!0);return b},deactivate:function(){var b=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.up=this.down=this.lastFeature=this.feature=null,this.touch=!1,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),b=!0);return b},handleMapEvents:function(b){("removelayer"==b.type||"order"==b.property)&&this.moveLayerToTop()},moveLayerToTop:function(){this.layer.setZIndex(Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1)},moveLayerBack:function(){var b=this.layer.getZIndex()-1;b>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(b):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"});OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(e,d){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(e instanceof OpenLayers.Style){this.styles["default"]=e,this.styles.select=e,this.styles.temporary=e,this.styles["delete"]=e}else{if("object"==typeof e){for(var f in e){if(e[f] instanceof OpenLayers.Style){this.styles[f]=e[f]}else{if("object"==typeof e[f]){this.styles[f]=new OpenLayers.Style(e[f])}else{this.styles["default"]=new OpenLayers.Style(e);this.styles.select=new OpenLayers.Style(e);this.styles.temporary=new OpenLayers.Style(e);this.styles["delete"]=new OpenLayers.Style(e);break}}}}}OpenLayers.Util.extend(this,d)},destroy:function(){for(var b in this.styles){this.styles[b].destroy()}this.styles=null},createSymbolizer:function(e,d){e||(e=new OpenLayers.Feature.Vector);this.styles[d]||(d="default");e.renderIntent=d;var f={};this.extendDefault&&"default"!=d&&(f=this.styles["default"].createSymbolizer(e));return OpenLayers.Util.extend(f,this.styles[d].createSymbolizer(e))},addUniqueValueRules:function(h,g,l,k){var j=[],i;for(i in l){j.push(new OpenLayers.Rule({symbolizer:l[i],context:k,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:g,value:i})}))}this.styles[h].addRules(j)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(f,e){OpenLayers.Layer.prototype.initialize.apply(this,arguments);(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||!this.renderer.supported()){this.renderer=null,this.displayError()}this.styleMap||(this.styleMap=new OpenLayers.StyleMap);this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies){for(var h=0,g=this.strategies.length;h<g;h++){this.strategies[h].setLayer(this)}}},destroy:function(){if(this.strategies){var e,d,f;d=0;for(f=this.strategies.length;d<f;d++){e=this.strategies[d],e.autoDestroy&&e.destroy()}this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=null);this.destroyFeatures();this.unrenderedFeatures=this.selectedFeatures=this.features=null;this.renderer&&this.renderer.destroy();this.drawn=this.geometryType=this.renderer=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(g){null==g&&(g=new OpenLayers.Layer.Vector(this.name,this.getOptions()));for(var g=OpenLayers.Layer.prototype.clone.apply(this,[g]),f=this.features,j=f.length,i=Array(j),h=0;h<j;++h){i[h]=f[h].clone()}g.features=i;return g},refresh:function(b){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",b)},assignRenderer:function(){for(var e=0,d=this.renderers.length;e<d;e++){var f=this.renderers[e];if((f="function"==typeof f?f:OpenLayers.Renderer[f])&&f.prototype.supported()){this.renderer=new f(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(d){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(this.renderer){this.renderer.map=this.map;var c=this.map.getSize();c.w*=this.ratio;c.h*=this.ratio;this.renderer.setSize(c)}else{this.map.removeLayer(this)}},afterAdd:function(){if(this.strategies){var e,d,f;d=0;for(f=this.strategies.length;d<f;d++){e=this.strategies[d],e.autoActivate&&e.activate()}}},removeMap:function(){this.drawn=!1;if(this.strategies){var e,d,f;d=0;for(f=this.strategies.length;d<f;d++){e=this.strategies[d],e.autoActivate&&e.deactivate()}}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var b=this.map.getSize();b.w*=this.ratio;b.h*=this.ratio;this.renderer.setSize(b)},moveTo:function(h,g,l){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var k=!0;if(!l){this.renderer.root.style.visibility="hidden";var k=this.map.getSize(),j=k.w,k=k.h,j=j/2*this.ratio-j/2,k=k/2*this.ratio-k/2,j=j+parseInt(this.map.layerContainerDiv.style.left,10),j=-Math.round(j),k=k+parseInt(this.map.layerContainerDiv.style.top,10),k=-Math.round(k);this.div.style.left=j+"px";this.div.style.top=k+"px";k=this.renderer.setExtent(this.map.getExtent().scale(this.ratio),g);this.renderer.root.style.visibility="visible";!0===OpenLayers.IS_GECKO&&(this.div.scrollLeft=this.div.scrollLeft);if(!g&&k){for(var i in this.unrenderedFeatures){j=this.unrenderedFeatures[i],this.drawFeature(j)}}}if(!this.drawn||g||!k){this.drawn=!0;i=0;for(k=this.features.length;i<k;i++){this.renderer.locked=i!==k-1,j=this.features[i],this.drawFeature(j)}}},display:function(d){OpenLayers.Layer.prototype.display.apply(this,arguments);var c=this.div.style.display;c!=this.renderer.root.style.display&&(this.renderer.root.style.display=c)},addFeatures:function(i,h){OpenLayers.Util.isArray(i)||(i=[i]);var n=!h||!h.silent;if(n){var m={features:i};if(!1===this.events.triggerEvent("beforefeaturesadded",m)){return}i=m.features}for(var m=[],l=0,k=i.length;l<k;l++){this.renderer.locked=l!=i.length-1?!0:!1;var j=i[l];if(this.geometryType&&!(j.geometry instanceof this.geometryType)){throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME)}j.layer=this;!j.style&&this.style&&(j.style=OpenLayers.Util.extend({},this.style));if(n){if(!1===this.events.triggerEvent("beforefeatureadded",{feature:j})){continue}this.preFeatureInsert(j)}m.push(j);this.features.push(j);this.drawFeature(j);n&&(this.events.triggerEvent("featureadded",{feature:j}),this.onFeatureInsert(j))}n&&this.events.triggerEvent("featuresadded",{features:m})},removeFeatures:function(g,f){if(g&&0!==g.length){if(g===this.features){return this.removeAllFeatures(f)}OpenLayers.Util.isArray(g)||(g=[g]);g===this.selectedFeatures&&(g=g.slice());var j=!f||!f.silent;j&&this.events.triggerEvent("beforefeaturesremoved",{features:g});for(var i=g.length-1;0<=i;i--){this.renderer.locked=0!=i&&g[i-1].geometry?!0:!1;var h=g[i];delete this.unrenderedFeatures[h.id];j&&this.events.triggerEvent("beforefeatureremoved",{feature:h});this.features=OpenLayers.Util.removeItem(this.features,h);h.layer=null;h.geometry&&this.renderer.eraseFeatures(h);-1!=OpenLayers.Util.indexOf(this.selectedFeatures,h)&&OpenLayers.Util.removeItem(this.selectedFeatures,h);j&&this.events.triggerEvent("featureremoved",{feature:h})}j&&this.events.triggerEvent("featuresremoved",{features:g})}},removeAllFeatures:function(f){var f=!f||!f.silent,e=this.features;f&&this.events.triggerEvent("beforefeaturesremoved",{features:e});for(var h,g=e.length-1;0<=g;g--){h=e[g],f&&this.events.triggerEvent("beforefeatureremoved",{feature:h}),h.layer=null,f&&this.events.triggerEvent("featureremoved",{feature:h})}this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures=[];f&&this.events.triggerEvent("featuresremoved",{features:e})},destroyFeatures:function(e,d){void 0==e&&(e=this.features);if(e){this.removeFeatures(e,d);for(var f=e.length-1;0<=f;f--){e[f].destroy()}}},drawFeature:function(e,d){if(this.drawn){if("object"!=typeof d){!d&&e.state===OpenLayers.State.DELETE&&(d="delete");var f=d||e.renderIntent;(d=e.style||this.style)||(d=this.styleMap.createSymbolizer(e,f))}f=this.renderer.drawFeature(e,d);!1===f||null===f?this.unrenderedFeatures[e.id]=e:delete this.unrenderedFeatures[e.id]}},eraseFeatures:function(b){this.renderer.eraseFeatures(b)},getFeatureFromEvent:function(d){if(!this.renderer){throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.")}var c=null;(d=this.renderer.getFeatureIdFromEvent(d))&&(c="string"===typeof d?this.getFeatureById(d):d);return c},getFeatureBy:function(g,f){for(var j=null,i=0,h=this.features.length;i<h;++i){if(this.features[i][g]==f){j=this.features[i];break}}return j},getFeatureById:function(b){return this.getFeatureBy("id",b)},getFeatureByFid:function(b){return this.getFeatureBy("fid",b)},getFeaturesByAttribute:function(h,g){var l,k,j=this.features.length,i=[];for(l=0;l<j;l++){(k=this.features[l])&&k.attributes&&k.attributes[h]===g&&i.push(k)}return i},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var g=null,f=this.features;if(f&&0<f.length){for(var j=null,i=0,h=f.length;i<h;i++){if(j=f[i].geometry){null===g&&(g=new OpenLayers.Bounds),g.extend(j.getBounds())}}}return g},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(f){for(var e=this.layers,h,g=0;g<e.length;g++){if(h=e[g].getFeatureFromEvent(f)){return h}}},setMap:function(b){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();b.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(b){b.events.unregister("changelayer",this,this.handleChangeLayer);this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var d,c=0;c<this.map.layers.length;++c){d=this.map.layers[c],-1!=OpenLayers.Util.indexOf(this.layers,d)&&d.renderer.moveRoot(this.renderer)}},resetRoots:function(){for(var d,c=0;c<this.layers.length;++c){d=this.layers[c],this.renderer&&d.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(d.renderer)}},handleChangeLayer:function(d){var c=d.layer;"order"==d.property&&-1!=OpenLayers.Util.indexOf(this.layers,c)&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(e,d){OpenLayers.Control.prototype.initialize.apply(this,[d]);null===this.scope&&(this.scope=this);this.initLayer(e);var f={click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(f.over=this.overFeature,f.out=this.outFeature);this.callbacks=OpenLayers.Util.extend(f,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(b){OpenLayers.Util.isArray(b)?(this.layers=b,this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:b})):this.layer=b},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer);OpenLayers.Control.prototype.destroy.apply(this,arguments);this.layers&&this.layer.destroy()},activate:function(){this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate());return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.active&&(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer));return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(h){for(var g=this.layers||[this.layer],l,k,j=0;j<g.length;++j){l=g[j];for(var i=l.selectedFeatures.length-1;0<=i;--i){k=l.selectedFeatures[i],(!h||h.except!=k)&&this.unselect(k)}}},clickFeature:function(b){this.hover||(-1<OpenLayers.Util.indexOf(b.layer.selectedFeatures,b)?this.toggleSelect()?this.unselect(b):this.multipleSelect()||this.unselectAll({except:b}):(this.multipleSelect()||this.unselectAll({except:b}),this.select(b)))},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(d){var c=d.layer;this.hover&&(this.highlightOnly?this.highlight(d):-1==OpenLayers.Util.indexOf(c.selectedFeatures,d)&&this.select(d))},outFeature:function(d){if(this.hover){if(this.highlightOnly){if(d._lastHighlighter==this.id){if(d._prevHighlighter&&d._prevHighlighter!=this.id){delete d._lastHighlighter;var c=this.map.getControl(d._prevHighlighter);c&&c.highlight(d)}else{this.unhighlight(d)}}}else{this.unselect(d)}}},highlight:function(d){var c=d.layer;!1!==this.events.triggerEvent("beforefeaturehighlighted",{feature:d})&&(d._prevHighlighter=d._lastHighlighter,d._lastHighlighter=this.id,c.drawFeature(d,this.selectStyle||this.renderIntent),this.events.triggerEvent("featurehighlighted",{feature:d}))},unhighlight:function(d){var c=d.layer;void 0==d._prevHighlighter?delete d._lastHighlighter:(d._prevHighlighter!=this.id&&(d._lastHighlighter=d._prevHighlighter),delete d._prevHighlighter);c.drawFeature(d,d.style||d.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:d})},select:function(e){var d=this.onBeforeSelect.call(this.scope,e),f=e.layer;!1!==d&&(d=f.events.triggerEvent("beforefeatureselected",{feature:e}),!1!==d&&(f.selectedFeatures.push(e),this.highlight(e),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=f.selectedFeatures[0]),f.events.triggerEvent("featureselected",{feature:e}),this.onSelect.call(this.scope,e)))},unselect:function(d){var c=d.layer;this.unhighlight(d);OpenLayers.Util.removeItem(c.selectedFeatures,d);c.events.triggerEvent("featureunselected",{feature:d});this.onUnselect.call(this.scope,d)},selectBox:function(j){if(j instanceof OpenLayers.Bounds){var i=this.map.getLonLatFromPixel({x:j.left,y:j.bottom}),j=this.map.getLonLatFromPixel({x:j.right,y:j.top}),i=new OpenLayers.Bounds(i.lon,i.lat,j.lon,j.lat);this.multipleSelect()||this.unselectAll();j=this.multiple;this.multiple=!0;var p=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:p});for(var o,n=0;n<p.length;++n){o=p[n];for(var m=0,l=o.features.length;m<l;++m){var k=o.features[m];k.getVisibility()&&(null==this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,k.geometry.CLASS_NAME))&&i.toGeometry().intersects(k.geometry)&&-1==OpenLayers.Util.indexOf(o.selectedFeatures,k)&&this.select(k)}}this.multiple=j;this.events.triggerEvent("boxselectionend",{layers:p})}},setMap:function(b){this.handlers.feature.setMap(b);this.box&&this.handlers.box.setMap(b);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(d){var c=this.active;this.unselectAll();this.deactivate();this.layers&&(this.layer.destroy(),this.layers=null);this.initLayer(d);this.handlers.feature.layer=this.layer;c&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var f=[];if(this.map&&this.map.layers){for(var e=0,h=this.map.layers.length;e<h;e++){var g=this.map.layers[e];g.attribution&&g.getVisibility()&&-1===OpenLayers.Util.indexOf(f,g.attribution)&&f.push(g.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:f.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(b){OpenLayers.Util.extend(this,b)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=void 0;this.points=[]},update:function(b){this.points.unshift({xy:b,tick:(new Date).getTime()});this.points.length>this.nbPoints&&this.points.pop()},end:function(h){for(var g,l=(new Date).getTime(),k=0,j=this.points.length,i;k<j;k++){i=this.points[k];if(l-i.tick>this.delay){break}g=i}if(g&&(k=(new Date).getTime()-g.tick,l=Math.sqrt(Math.pow(h.x-g.xy.x,2)+Math.pow(h.y-g.xy.y,2)),k=l/k,!(0==k||k<this.threshold))){return l=Math.asin((h.y-g.xy.y)/l),g.xy.x<=h.x&&(l=Math.PI-l),{speed:k,theta:l}}},move:function(j,i){var p=j.speed,o=Math.cos(j.theta),n=-Math.sin(j.theta),m=(new Date).getTime(),l=0,k=0;this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(function(){if(null!=this.timerId){var c=(new Date).getTime()-m,e=-this.deceleration*Math.pow(c,2)/2+p*c,d=e*o,e=e*n,f,b;f=!1;0>=-this.deceleration*c+p&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,f=!0);c=d-l;b=e-k;l=d;k=e;i(c,b,f)}},this))},CLASS_NAME:"OpenLayers.Kinetic"});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(b){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[b])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(e){var d,f;switch(this.type){case OpenLayers.Filter.Logical.AND:d=0;for(f=this.filters.length;d<f;d++){if(!1==this.filters[d].evaluate(e)){return !1}}return !0;case OpenLayers.Filter.Logical.OR:d=0;for(f=this.filters.length;d<f;d++){if(!0==this.filters[d].evaluate(e)){return !0}}return !1;case OpenLayers.Filter.Logical.NOT:return !this.filters[0].evaluate(e)}},clone:function(){for(var e=[],d=0,f=this.filters.length;d<f;++d){e.push(this.filters[d].clone())}return new OpenLayers.Filter.Logical({type:this.type,filters:e})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,touch:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(f,e,h){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(!0===this.documentDrag){var g=this;this._docMove=function(b){g.mousemove({xy:{x:b.clientX,y:b.clientY},element:document})};this._docUp=function(b){g.mouseup({xy:{x:b.clientX,y:b.clientY}})}}},dragstart:function(d){var c=!0;this.dragging=!1;this.checkModifiers(d)&&(OpenLayers.Event.isLeftClick(d)||OpenLayers.Event.isSingleTouch(d))?(this.started=!0,this.last=this.start=d.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(d),this.callback("down",[d.xy]),OpenLayers.Event.stop(d),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,c=!this.stopDown):(this.started=!1,this.last=this.start=null);return c},dragmove:function(b){this.lastMoveEvt=b;if(this.started&&!this.timeoutId&&(b.xy.x!=this.last.x||b.xy.y!=this.last.y)){!0===this.documentDrag&&this.documentEvents&&(b.element===document?(this.adjustXY(b),this.setEvent(b)):this.removeDocumentEvents()),0<this.interval&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(b),this.callback("move",[b.xy]),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=b.xy}return !0},dragend:function(d){if(this.started){!0===this.documentDrag&&this.documentEvents&&(this.adjustXY(d),this.removeDocumentEvents());var c=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(d);this.callback("up",[d.xy]);c&&this.callback("done",[d.xy]);document.onselectstart=this.oldOnselectstart}return !0},down:function(){},move:function(){},up:function(){},out:function(){},mousedown:function(b){return this.dragstart(b)},touchstart:function(b){this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this}));return this.dragstart(b)},mousemove:function(b){return this.dragmove(b)},touchmove:function(b){return this.dragmove(b)},removeTimeout:function(){this.timeoutId=null;this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(b){return this.dragend(b)},touchend:function(b){b.xy=this.last;return this.dragend(b)},mouseout:function(d){if(this.started&&OpenLayers.Util.mouseLeft(d,this.map.viewPortDiv)){if(!0===this.documentDrag){this.addDocumentEvents()}else{var c=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(d);this.callback("out",[]);c&&this.callback("done",[d.xy]);document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}}return !0},click:function(){return this.start==this.last},activate:function(){var b=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,b=!0);return b},deactivate:function(){var b=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.dragging=this.started=this.touch=!1,this.last=this.start=null,b=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"));return b},adjustXY:function(d){var c=OpenLayers.Util.pagePosition(this.map.viewPortDiv);d.xy.x-=c[0];d.xy.y-=c[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=!0;OpenLayers.Event.observe(document,"mousemove",this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=!1;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(e,d,f){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=null)},setMap:function(b){OpenLayers.Handler.prototype.setMap.apply(this,arguments);this.dragHandler&&this.dragHandler.setMap(b)},startBox:function(){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(h){var g=this.dragHandler.start.x,l=this.dragHandler.start.y,k=Math.abs(g-h.x),j=Math.abs(l-h.y),i=this.getBoxOffsets();this.zoomBox.style.width=k+i.width+1+"px";this.zoomBox.style.height=j+i.height+1+"px";this.zoomBox.style.left=(h.x<g?g-k-i.left:g-i.left)+"px";this.zoomBox.style.top=(h.y<l?l-j-i.top:l-i.top)+"px"},endBox:function(g){var f;if(5<Math.abs(this.dragHandler.start.x-g.x)||5<Math.abs(this.dragHandler.start.y-g.y)){var j=this.dragHandler.start;f=Math.min(j.y,g.y);var i=Math.max(j.y,g.y),h=Math.min(j.x,g.x),g=Math.max(j.x,g.x);f=new OpenLayers.Bounds(h,i,g,f)}else{f=this.dragHandler.start.clone()}this.removeBox();this.callback("done",[f])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var g=document.createElement("div");g.style.position="absolute";g.style.border="1px solid black";g.style.width="3px";document.body.appendChild(g);var f=3==g.clientWidth;document.body.removeChild(g);var g=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),j=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),i=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width")),h=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:g,right:j,top:i,bottom:h,width:!1===f?g+j:0,height:!1===f?i+h:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(h){if(h instanceof OpenLayers.Bounds){var g;if(this.out){g=Math.abs(h.right-h.left);var l=Math.abs(h.top-h.bottom);g=Math.min(this.map.size.h/l,this.map.size.w/g);var l=this.map.getExtent(),k=this.map.getLonLatFromPixel(h.getCenterPixel()),h=k.lon-l.getWidth()/2*g,j=k.lon+l.getWidth()/2*g,i=k.lat-l.getHeight()/2*g;g=k.lat+l.getHeight()/2*g;g=new OpenLayers.Bounds(h,i,j,g)}else{g=this.map.getLonLatFromPixel({x:h.left,y:h.bottom}),l=this.map.getLonLatFromPixel({x:h.right,y:h.top}),g=new OpenLayers.Bounds(g.lon,g.lat,l.lon,l.lat)}l=this.map.getZoom();this.map.zoomToExtent(g);l==this.map.getZoom()&&!0==this.alwaysZoom&&this.map.zoomTo(l+(this.out?-1:1))}else{this.out?this.map.setCenter(this.map.getLonLatFromPixel(h),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(h),this.map.getZoom()+1)}},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var b={interval:this.kineticInterval};"object"===typeof this.enableKinetic&&(b=OpenLayers.Util.extend(b,this.enableKinetic));this.kinetic=new OpenLayers.Kinetic(b)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(b){this.kinetic&&this.kinetic.update(b);this.panned=!0;this.map.pan(this.handler.last.x-b.x,this.handler.last.y-b.y,{dragging:!0,animate:!1})},panMapDone:function(e){if(this.panned){var d=null;this.kinetic&&(d=this.kinetic.end(e));this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!!d,animate:!1});if(d){var f=this;this.kinetic.move(d,function(g,c,h){f.map.pan(g,c,{dragging:!h,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,touch:!1,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(b){this.touch||(this.unregisterMouseListeners(),this.touch=!0);this.down=this.getEventInfo(b);this.last=this.getEventInfo(b);return !0},touchmove:function(b){this.last=this.getEventInfo(b);return !0},touchend:function(b){this.down&&(b.xy=this.last.xy,b.lastTouches=this.last.touches,this.handleSingle(b),this.down=null);return !0},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(b){this.down=this.getEventInfo(b);this.last=this.getEventInfo(b);return !0},mouseup:function(d){var c=!0;this.checkModifiers(d)&&(this.control.handleRightClicks&&OpenLayers.Event.isRightClick(d))&&(c=this.rightclick(d));return c},rightclick:function(b){if(this.passesTolerance(b)){if(null!=this.rightclickTimerId){return this.clearTimer(),this.callback("dblrightclick",[b]),!this.stopDouble}b=this["double"]?OpenLayers.Util.extend({},b):this.callback("rightclick",[b]);b=OpenLayers.Function.bind(this.delayedRightCall,this,b);this.rightclickTimerId=window.setTimeout(b,this.delay)}return !this.stopSingle},delayedRightCall:function(b){this.rightclickTimerId=null;b&&this.callback("rightclick",[b])},click:function(b){this.last||(this.last=this.getEventInfo(b));this.handleSingle(b);return !this.stopSingle},dblclick:function(b){this.handleDouble(b);return !this.stopDouble},handleDouble:function(b){this.passesDblclickTolerance(b)&&(this["double"]&&this.callback("dblclick",[b]),this.clearTimer())},handleSingle:function(b){this.passesTolerance(b)&&(null!=this.timerId?(this.last.touches&&1===this.last.touches.length&&(this["double"]&&OpenLayers.Event.stop(b),this.handleDouble(b)),(!this.last.touches||2!==this.last.touches.length)&&this.clearTimer()):(this.first=this.getEventInfo(b),this.queuePotentialClick(this.single?OpenLayers.Util.extend({},b):null)))},queuePotentialClick:function(b){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,b),this.delay)},passesTolerance:function(e){var d=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(d=this.pixelTolerance>=this.down.xy.distanceTo(e.xy))&&this.touch&&this.down.touches.length===this.last.touches.length){for(var e=0,f=this.down.touches.length;e<f;++e){if(this.getTouchDistance(this.down.touches[e],this.last.touches[e])>this.pixelTolerance){d=!1;break}}}return d},getTouchDistance:function(d,c){return Math.sqrt(Math.pow(d.clientX-c.clientX,2)+Math.pow(d.clientY-c.clientY,2))},passesDblclickTolerance:function(){var b=!0;this.down&&this.first&&(b=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance);return b},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);null!=this.rightclickTimerId&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(b){this.timerId=null;b&&this.callback("click",[b])},getEventInfo:function(g){var f;if(g.touches){var j=g.touches.length;f=Array(j);for(var i,h=0;h<j;h++){i=g.touches[h],f[h]={clientX:i.clientX,clientY:i.clientY}}}return{xy:g.xy,touches:f}},deactivate:function(){var b=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.last=this.first=this.down=null,this.touch=!1,b=!0);return b},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(b){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;this.zoomBox&&this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&&this.pinchZoom.destroy();this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&&this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&&this.zoomBox.activate();this.pinchZoom&&this.pinchZoom.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&&this.pinchZoom.deactivate();this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":!0,stopDouble:!0});this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions);OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions)))},defaultClick:function(b){b.lastTouches&&2==b.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(b){this.map.setCenter(this.map.getLonLatFromViewPortPx(b.xy),this.map.zoom+1)},defaultDblRightClick:function(b){this.map.setCenter(this.map.getLonLatFromViewPortPx(b.xy),this.map.zoom-1)},wheelChange:function(i,h){var n=this.map.getZoom(),m=this.map.getZoom()+Math.round(h),m=Math.max(m,0),m=Math.min(m,this.map.getNumZoomLevels());if(m!==n){var l=this.map.getSize(),n=l.w/2-i.xy.x,l=i.xy.y-l.h/2,k=this.map.baseLayer.getResolutionForZoom(m),j=this.map.getLonLatFromPixel(i.xy);this.map.setCenter(new OpenLayers.LonLat(j.lon+n*k,j.lat+l*k),m)}},wheelUp:function(d,c){this.wheelChange(d,c||1)},wheelDown:function(d,c){this.wheelChange(d,c||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0;this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0;this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(g,f,j,i){var h=[],j=OpenLayers.Util.upperCaseObject(j);1.3<=parseFloat(j.VERSION)&&!j.EXCEPTIONS&&(j.EXCEPTIONS="INIMAGE");h.push(g,f,j,i);OpenLayers.Layer.Grid.prototype.initialize.apply(this,h);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()){if(null==i||!i.isBaseLayer){this.isBaseLayer=!1}"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png")}},clone:function(b){null==b&&(b=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions()));return b=OpenLayers.Layer.Grid.prototype.clone.apply(this,[b])},reverseAxisOrder:function(){var b=this.projection.getCode();return 1.3<=parseFloat(this.params.VERSION)&&!(!this.yx[b]&&!OpenLayers.Projection.defaults[b].yx)},getURL:function(f){var f=this.adjustBounds(f),e=this.getImageSize(),h={},g=this.reverseAxisOrder();h.BBOX=this.encodeBBOX?f.toBBOX(null,g):f.toArray(g);h.WIDTH=e.w;h.HEIGHT=e.h;return this.getFullRequestString(h)},mergeNewParams:function(b){b=[OpenLayers.Util.upperCaseObject(b)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,b)},getFullRequestString:function(e,d){var f=this.map.getProjectionObject(),f=this.projection&&this.projection.equals(f)?this.projection.getCode():f.getCode(),f="none"==f?null:f;1.3<=parseFloat(this.params.VERSION)?this.params.CRS=f:this.params.SRS=f;"boolean"==typeof this.params.TRANSPARENT&&(e.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE");return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15000,translationParameters:null,symbolMetrics:null,initialize:function(b){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))},inValidRange:function(e,d,f){e+=f?0:this.translationParameters.x;d+=f?0:this.translationParameters.y;return e>=-this.MAX_PIXEL&&e<=this.MAX_PIXEL&&d>=-this.MAX_PIXEL&&d<=this.MAX_PIXEL},setExtent:function(g,f){var j=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),i=this.getResolution(),h=-g.left/i,i=g.top/i;if(f){return this.left=h,this.top=i,this.rendererRoot.setAttributeNS(null,"viewBox","0 0 "+this.size.w+" "+this.size.h),this.translate(this.xOffset,0),!0}(h=this.translate(h-this.left+this.xOffset,i-this.top))||this.setExtent(g,!0);return j&&h},translate:function(e,d){if(this.inValidRange(e,d,!0)){var f="";if(e||d){f="translate("+e+","+d+")"}this.root.setAttributeNS(null,"transform",f);this.translationParameters={x:e,y:d};return !0}return !1},setSize:function(b){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(e,d){var f=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":f=d.externalGraphic?"image":this.isComplexSymbol(d.graphicName)?"svg":"circle";break;case"OpenLayers.Geometry.Rectangle":f="rect";break;case"OpenLayers.Geometry.LineString":f="polyline";break;case"OpenLayers.Geometry.LinearRing":f="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":f="path"}return f},setStyle:function(t,s,r){var s=s||t._style,r=r||t._options,q=parseFloat(t.getAttributeNS(null,"r")),p=1,o;if("OpenLayers.Geometry.Point"==t._geometryClass&&q){t.style.visibility="";if(!1===s.graphic){t.style.visibility="hidden"}else{if(s.externalGraphic){o=this.getPosition(t);s.graphicTitle&&(t.setAttributeNS(null,"title",s.graphicTitle),q=t.getElementsByTagName("title"),0<q.length?q[0].firstChild.textContent=s.graphicTitle:(q=this.nodeFactory(null,"title"),q.textContent=s.graphicTitle,t.appendChild(q)));s.graphicWidth&&s.graphicHeight&&t.setAttributeNS(null,"preserveAspectRatio","none");var q=s.graphicWidth||s.graphicHeight,n=s.graphicHeight||s.graphicWidth,q=q?q:2*s.pointRadius,n=n?n:2*s.pointRadius,m=void 0!=s.graphicYOffset?s.graphicYOffset:-(0.5*n),l=s.graphicOpacity||s.fillOpacity;t.setAttributeNS(null,"x",(o.x+(void 0!=s.graphicXOffset?s.graphicXOffset:-(0.5*q))).toFixed());t.setAttributeNS(null,"y",(o.y+m).toFixed());t.setAttributeNS(null,"width",q);t.setAttributeNS(null,"height",n);t.setAttributeNS(this.xlinkns,"href",s.externalGraphic);t.setAttributeNS(null,"style","opacity: "+l);t.onclick=OpenLayers.Renderer.SVG.preventDefault}else{if(this.isComplexSymbol(s.graphicName)){var q=3*s.pointRadius,n=2*q,k=this.importSymbol(s.graphicName);o=this.getPosition(t);p=3*this.symbolMetrics[k.id][0]/n;m=t.parentNode;l=t.nextSibling;m&&m.removeChild(t);t.firstChild&&t.removeChild(t.firstChild);t.appendChild(k.firstChild.cloneNode(!0));t.setAttributeNS(null,"viewBox",k.getAttributeNS(null,"viewBox"));t.setAttributeNS(null,"width",n);t.setAttributeNS(null,"height",n);t.setAttributeNS(null,"x",o.x-q);t.setAttributeNS(null,"y",o.y-q);l?m.insertBefore(t,l):m&&m.appendChild(t)}else{t.setAttributeNS(null,"r",s.pointRadius)}}}q=s.rotation;if((void 0!==q||void 0!==t._rotation)&&o){t._rotation=q,q|=0,"svg"!==t.nodeName?t.setAttributeNS(null,"transform","rotate("+q+" "+o.x+" "+o.y+")"):(o=this.symbolMetrics[k.id],t.firstChild.setAttributeNS(null,"transform","rotate("+q+" "+o[1]+" "+o[2]+")"))}}r.isFilled?(t.setAttributeNS(null,"fill",s.fillColor),t.setAttributeNS(null,"fill-opacity",s.fillOpacity)):t.setAttributeNS(null,"fill","none");r.isStroked?(t.setAttributeNS(null,"stroke",s.strokeColor),t.setAttributeNS(null,"stroke-opacity",s.strokeOpacity),t.setAttributeNS(null,"stroke-width",s.strokeWidth*p),t.setAttributeNS(null,"stroke-linecap",s.strokeLinecap||"round"),t.setAttributeNS(null,"stroke-linejoin","round"),s.strokeDashstyle&&t.setAttributeNS(null,"stroke-dasharray",this.dashStyle(s,p))):t.setAttributeNS(null,"stroke","none");s.pointerEvents&&t.setAttributeNS(null,"pointer-events",s.pointerEvents);null!=s.cursor&&t.setAttributeNS(null,"cursor",s.cursor);return t},dashStyle:function(f,e){var h=f.strokeWidth*e,g=f.strokeDashstyle;switch(g){case"solid":return"none";case"dot":return[1,4*h].join();case"dash":return[4*h,4*h].join();case"dashdot":return[4*h,4*h,1,4*h].join();case"longdash":return[8*h,4*h].join();case"longdashdot":return[8*h,4*h,1,4*h].join();default:return OpenLayers.String.trim(g).replace(/\s+/g,",")}},createNode:function(e,d){var f=document.createElementNS(this.xmlns,e);d&&f.setAttributeNS(null,"id",d);return f},nodeTypeCompare:function(d,c){return c==d.nodeName},createRenderRoot:function(){var b=this.nodeFactory(this.container.id+"_svgRoot","svg");b.style.display="block";return b},createRoot:function(b){return this.nodeFactory(this.container.id+b,"g")},createDefs:function(){var b=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(b);return b},drawPoint:function(d,c){return this.drawCircle(d,c,1)},drawCircle:function(g,f,j){var i=this.getResolution(),h=(f.x-this.featureDx)/i+this.left,f=this.top-f.y/i;return this.inValidRange(h,f)?(g.setAttributeNS(null,"cx",h),g.setAttributeNS(null,"cy",f),g.setAttributeNS(null,"r",j),g):!1},drawLineString:function(e,d){var f=this.getComponentsString(d.components);return f.path?(e.setAttributeNS(null,"points",f.path),f.complete?e:null):!1},drawLinearRing:function(e,d){var f=this.getComponentsString(d.components);return f.path?(e.setAttributeNS(null,"points",f.path),f.complete?e:null):!1},drawPolygon:function(r,q){for(var p="",o=!0,n=!0,m,l,k=0,j=q.components.length;k<j;k++){p+=" M",m=this.getComponentsString(q.components[k].components," "),(l=m.path)?(p+=" "+l,n=m.complete&&n):o=!1}return o?(r.setAttributeNS(null,"d",p+" z"),r.setAttributeNS(null,"fill-rule","evenodd"),n?r:null):!1},drawRectangle:function(g,f){var j=this.getResolution(),i=(f.x-this.featureDx)/j+this.left,h=this.top-f.y/j;return this.inValidRange(i,h)?(g.setAttributeNS(null,"x",i),g.setAttributeNS(null,"y",h),g.setAttributeNS(null,"width",f.width/j),g.setAttributeNS(null,"height",f.height/j),g):!1},drawText:function(x,w,v){var u=!!w.labelOutlineWidth;if(u){var t=OpenLayers.Util.extend({},w);t.fontColor=t.labelOutlineColor;t.fontStrokeColor=t.labelOutlineColor;t.fontStrokeWidth=w.labelOutlineWidth;delete t.labelOutlineWidth;this.drawText(x,t,v)}var s=this.getResolution(),t=(v.x-this.featureDx)/s+this.left,r=v.y/s-this.top,u=u?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,s=this.nodeFactory(x+u,"text");s.setAttributeNS(null,"x",t);s.setAttributeNS(null,"y",-r);w.fontColor&&s.setAttributeNS(null,"fill",w.fontColor);w.fontStrokeColor&&s.setAttributeNS(null,"stroke",w.fontStrokeColor);w.fontStrokeWidth&&s.setAttributeNS(null,"stroke-width",w.fontStrokeWidth);w.fontOpacity&&s.setAttributeNS(null,"opacity",w.fontOpacity);w.fontFamily&&s.setAttributeNS(null,"font-family",w.fontFamily);w.fontSize&&s.setAttributeNS(null,"font-size",w.fontSize);w.fontWeight&&s.setAttributeNS(null,"font-weight",w.fontWeight);w.fontStyle&&s.setAttributeNS(null,"font-style",w.fontStyle);!0===w.labelSelect?(s.setAttributeNS(null,"pointer-events","visible"),s._featureId=x):s.setAttributeNS(null,"pointer-events","none");r=w.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;s.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[r[0]]||"middle");!0===OpenLayers.IS_GECKO&&s.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[r[1]]||"central");for(var q=w.label.split("\n"),p=q.length;s.childNodes.length>p;){s.removeChild(s.lastChild)}for(var n=0;n<p;n++){var m=this.nodeFactory(x+u+"_tspan_"+n,"tspan");!0===w.labelSelect&&(m._featureId=x,m._geometry=v,m._geometryClass=v.CLASS_NAME);!1===OpenLayers.IS_GECKO&&m.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[r[1]]||"-35%");m.setAttribute("x",t);if(0==n){var l=OpenLayers.Renderer.SVG.LABEL_VFACTOR[r[1]];null==l&&(l=-0.5);m.setAttribute("dy",l*(p-1)+"em")}else{m.setAttribute("dy","1em")}m.textContent=""===q[n]?" ":q[n];m.parentNode||s.appendChild(m)}s.parentNode||this.textRoot.appendChild(s)},getComponentsString:function(j,i){for(var p=[],o=!0,n=j.length,m=[],l,k=0;k<n;k++){l=j[k],p.push(l),(l=this.getShortString(l))?m.push(l):(0<k&&this.getShortString(j[k-1])&&m.push(this.clipLine(j[k],j[k-1])),k<n-1&&this.getShortString(j[k+1])&&m.push(this.clipLine(j[k],j[k+1])),o=!1)}return{path:m.join(i||","),complete:o}},clipLine:function(r,q){if(q.equals(r)){return""}var p=this.getResolution(),o=this.MAX_PIXEL-this.translationParameters.x,n=this.MAX_PIXEL-this.translationParameters.y,m=(q.x-this.featureDx)/p+this.left,l=this.top-q.y/p,k=(r.x-this.featureDx)/p+this.left,p=this.top-r.y/p,j;if(k<-o||k>o){j=(p-l)/(k-m),k=0>k?-o:o,p=l+(k-m)*j}if(p<-n||p>n){j=(k-m)/(p-l),p=0>p?-n:n,k=m+(p-l)*j}return k+","+p},getShortString:function(e){var d=this.getResolution(),f=(e.x-this.featureDx)/d+this.left,e=this.top-e.y/d;return this.inValidRange(f,e)?f+","+e:!1},getPosition:function(b){return{x:parseFloat(b.getAttributeNS(null,"cx")),y:parseFloat(b.getAttributeNS(null,"cy"))}},importSymbol:function(r){this.defs||(this.defs=this.createDefs());var q=this.container.id+"-"+r,p=document.getElementById(q);if(null!=p){return p}var o=OpenLayers.Renderer.symbol[r];if(!o){throw Error(r+" is not a valid symbol name")}var r=this.nodeFactory(q,"symbol"),n=this.nodeFactory(null,"polygon");r.appendChild(n);for(var p=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),m=[],l,k,j=0;j<o.length;j+=2){l=o[j],k=o[j+1],p.left=Math.min(p.left,l),p.bottom=Math.min(p.bottom,k),p.right=Math.max(p.right,l),p.top=Math.max(p.top,k),m.push(l,",",k)}n.setAttributeNS(null,"points",m.join(" "));o=p.getWidth();n=p.getHeight();r.setAttributeNS(null,"viewBox",[p.left-o,p.bottom-n,3*o,3*n].join(" "));this.symbolMetrics[q]=[Math.max(o,n),p.getCenterLonLat().lon,p.getCenterLonLat().lat];this.defs.appendChild(r);return r},getFeatureIdFromEvent:function(d){var c=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);c||(c=d.target,c=c.parentNode&&c!=this.rendererRoot?c.parentNode._featureId:void 0);return c},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};OpenLayers.Renderer.SVG.preventDefault=function(b){b.preventDefault&&b.preventDefault()};OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(b){OpenLayers.Util.extend(this,b);this.options=b},destroy:function(){},read:function(){throw Error("Read not implemented.")},write:function(){throw Error("Write not implemented.")},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return !(!window.JSON||!("function"==typeof JSON.parse&&"function"==typeof JSON.stringify))}(),read:function(a,b){var c;if(this.nativeJSON){c=JSON.parse(a,b)}else{try{if(/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(c=eval("("+a+")"),"function"===typeof b)){var d=function(a,c){if(c&&"object"===typeof c){for(var e in c){c.hasOwnProperty(e)&&(c[e]=d(e,c[e]))}}return b(a,c)};c=d("",c)}}catch(e){}}this.keepData&&(this.data=c);return c},write:function(g,f){this.pretty=!!f;var j=null,i=typeof g;if(this.serialize[i]){try{j=!this.pretty&&this.nativeJSON?JSON.stringify(g):this.serialize[i].apply(this,[g])}catch(h){OpenLayers.Console.error("Trouble serializing: "+h)}}return j},writeIndent:function(){var d=[];if(this.pretty){for(var c=0;c<this.level;++c){d.push(this.indent)}}return d.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(h){if(null==h){return"null"}if(h.constructor==Date){return this.serialize.date.apply(this,[h])}if(h.constructor==Array){return this.serialize.array.apply(this,[h])}var g=["{"];this.level+=1;var l,k,j,i=!1;for(l in h){h.hasOwnProperty(l)&&(k=OpenLayers.Format.JSON.prototype.write.apply(this,[l,this.pretty]),j=OpenLayers.Format.JSON.prototype.write.apply(this,[h[l],this.pretty]),null!=k&&null!=j&&(i&&g.push(","),g.push(this.writeNewline(),this.writeIndent(),k,":",this.writeSpace(),j),i=!0))}this.level-=1;g.push(this.writeNewline(),this.writeIndent(),"}");return g.join("")},array:function(g){var f,j=["["];this.level+=1;for(var i=0,h=g.length;i<h;++i){f=OpenLayers.Format.JSON.prototype.write.apply(this,[g[i],this.pretty]),null!=f&&(0<i&&j.push(","),j.push(this.writeNewline(),this.writeIndent(),f))}this.level-=1;j.push(this.writeNewline(),this.writeIndent(),"]");return j.join("")},string:function(d){var c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(d)?'"'+d.replace(/([\x00-\x1f\\"])/g,function(b,g){var f=c[g];if(f){return f}f=g.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)})+'"':'"'+d+'"'},number:function(b){return isFinite(b)?""+b:"null"},"boolean":function(b){return""+b},date:function(d){function c(b){return 10>b?"0"+b:b}return'"'+d.getFullYear()+"-"+c(d.getMonth()+1)+"-"+c(d.getDate())+"T"+c(d.getHours())+":"+c(d.getMinutes())+":"+c(d.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(v,u,t){var u=u?u:"FeatureCollection",s=null,r=null;if(r="string"==typeof v?OpenLayers.Format.JSON.prototype.read.apply(this,[v,t]):v){if("string"!=typeof r.type){OpenLayers.Console.error("Bad GeoJSON - no type: "+v)}else{if(this.isValidType(r,u)){switch(u){case"Geometry":try{s=this.parseGeometry(r)}catch(q){OpenLayers.Console.error(q)}break;case"Feature":try{s=this.parseFeature(r),s.type="Feature"}catch(p){OpenLayers.Console.error(p)}break;case"FeatureCollection":switch(s=[],r.type){case"Feature":try{s.push(this.parseFeature(r))}catch(o){s=null,OpenLayers.Console.error(o)}break;case"FeatureCollection":v=0;for(u=r.features.length;v<u;++v){try{s.push(this.parseFeature(r.features[v]))}catch(n){s=null,OpenLayers.Console.error(n)}}break;default:try{var m=this.parseGeometry(r);s.push(new OpenLayers.Feature.Vector(m))}catch(l){s=null,OpenLayers.Console.error(l)}}}}}}else{OpenLayers.Console.error("Bad JSON: "+v)}return s},isValidType:function(e,d){var f=!1;switch(d){case"Geometry":-1==OpenLayers.Util.indexOf("Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection".split(" "),e.type)?OpenLayers.Console.error("Unsupported geometry type: "+e.type):f=!0;break;case"FeatureCollection":f=!0;break;default:e.type==d?f=!0:OpenLayers.Console.error("Cannot convert types from "+e.type+" to "+d)}return f},parseFeature:function(g){var f,j,i;j=g.properties?g.properties:{};i=g.geometry&&g.geometry.bbox||g.bbox;try{f=this.parseGeometry(g.geometry)}catch(h){throw h}f=new OpenLayers.Feature.Vector(f,j);i&&(f.bounds=OpenLayers.Bounds.fromArray(i));g.id&&(f.fid=g.id);return f},parseGeometry:function(g){if(null==g){return null}var f,j=!1;if("GeometryCollection"==g.type){if(!OpenLayers.Util.isArray(g.geometries)){throw"GeometryCollection must have geometries array: "+g}f=g.geometries.length;for(var j=Array(f),i=0;i<f;++i){j[i]=this.parseGeometry.apply(this,[g.geometries[i]])}f=new OpenLayers.Geometry.Collection(j);j=!0}else{if(!OpenLayers.Util.isArray(g.coordinates)){throw"Geometry must have coordinates array: "+g}if(!this.parseCoords[g.type.toLowerCase()]){throw"Unsupported geometry type: "+g.type}try{f=this.parseCoords[g.type.toLowerCase()].apply(this,[g.coordinates])}catch(h){throw h}}this.internalProjection&&(this.externalProjection&&!j)&&f.transform(this.externalProjection,this.internalProjection);return f},parseCoords:{point:function(b){if(!1==this.ignoreExtraDims&&2!=b.length){throw"Only 2D points are supported: "+b}return new OpenLayers.Geometry.Point(b[0],b[1])},multipoint:function(h){for(var g=[],l=null,k=0,j=h.length;k<j;++k){try{l=this.parseCoords.point.apply(this,[h[k]])}catch(i){throw i}g.push(l)}return new OpenLayers.Geometry.MultiPoint(g)},linestring:function(h){for(var g=[],l=null,k=0,j=h.length;k<j;++k){try{l=this.parseCoords.point.apply(this,[h[k]])}catch(i){throw i}g.push(l)}return new OpenLayers.Geometry.LineString(g)},multilinestring:function(h){for(var g=[],l=null,k=0,j=h.length;k<j;++k){try{l=this.parseCoords.linestring.apply(this,[h[k]])}catch(i){throw i}g.push(l)}return new OpenLayers.Geometry.MultiLineString(g)},polygon:function(i){for(var h=[],n,m,l=0,k=i.length;l<k;++l){try{m=this.parseCoords.linestring.apply(this,[i[l]])}catch(j){throw j}n=new OpenLayers.Geometry.LinearRing(m.components);h.push(n)}return new OpenLayers.Geometry.Polygon(h)},multipolygon:function(h){for(var g=[],l=null,k=0,j=h.length;k<j;++k){try{l=this.parseCoords.polygon.apply(this,[h[k]])}catch(i){throw i}g.push(l)}return new OpenLayers.Geometry.MultiPolygon(g)},box:function(b){if(2!=b.length){throw"GeoJSON box coordinates must have 2 elements"}return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(b[0][0],b[0][1]),new OpenLayers.Geometry.Point(b[1][0],b[0][1]),new OpenLayers.Geometry.Point(b[1][0],b[1][1]),new OpenLayers.Geometry.Point(b[0][0],b[1][1]),new OpenLayers.Geometry.Point(b[0][0],b[0][1])])])}},write:function(h,g){var l={type:null};if(OpenLayers.Util.isArray(h)){l.type="FeatureCollection";var k=h.length;l.features=Array(k);for(var j=0;j<k;++j){var i=h[j];if(!i instanceof OpenLayers.Feature.Vector){throw"FeatureCollection only supports collections of features: "+i}l.features[j]=this.extract.feature.apply(this,[i])}}else{0==h.CLASS_NAME.indexOf("OpenLayers.Geometry")?l=this.extract.geometry.apply(this,[h]):h instanceof OpenLayers.Feature.Vector&&(l=this.extract.feature.apply(this,[h]),h.layer&&h.layer.projection&&(l.crs=this.createCRSObject(h)))}return OpenLayers.Format.JSON.prototype.write.apply(this,[l,g])},createCRSObject:function(d){var d=d.layer.projection.toString(),c={};d.match(/epsg:/i)&&(d=parseInt(d.substring(d.indexOf(":")+1)),c=4326==d?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+d}});return c},extract:{feature:function(d){var c=this.extract.geometry.apply(this,[d.geometry]),c={type:"Feature",properties:d.attributes,geometry:c};null!=d.fid&&(c.id=d.fid);return c},geometry:function(d){if(null==d){return null}this.internalProjection&&this.externalProjection&&(d=d.clone(),d.transform(this.internalProjection,this.externalProjection));var c=d.CLASS_NAME.split(".")[2],d=this.extract[c.toLowerCase()].apply(this,[d]);return"Collection"==c?{type:"GeometryCollection",geometries:d}:{type:c,coordinates:d}},point:function(b){return[b.x,b.y]},multipoint:function(f){for(var e=[],h=0,g=f.components.length;h<g;++h){e.push(this.extract.point.apply(this,[f.components[h]]))}return e},linestring:function(f){for(var e=[],h=0,g=f.components.length;h<g;++h){e.push(this.extract.point.apply(this,[f.components[h]]))}return e},multilinestring:function(f){for(var e=[],h=0,g=f.components.length;h<g;++h){e.push(this.extract.linestring.apply(this,[f.components[h]]))}return e},polygon:function(f){for(var e=[],h=0,g=f.components.length;h<g;++h){e.push(this.extract.linestring.apply(this,[f.components[h]]))}return e},multipolygon:function(f){for(var e=[],h=0,g=f.components.length;h<g;++h){e.push(this.extract.polygon.apply(this,[f.components[h]]))}return e},collection:function(f){for(var e=f.components.length,h=Array(e),g=0;g<e;++g){h[g]=this.extract.geometry.apply(this,[f.components[g]])}return h}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){"number"==typeof this.padding&&(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1,keepInMap:!1,closeOnMove:!1,map:null,initialize:function(h,g,l,k,j,i){null==h&&(h=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=h;this.lonlat=g;this.contentSize=null!=l?l:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);null!=k&&(this.contentHTML=k);this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass;this.groupDiv=OpenLayers.Util.createDiv(this.id+"_GroupDiv",null,null,null,"relative",null,"hidden");h=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(h,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);j&&this.addCloseBox(i);this.registerEvents()},destroy:function(){this.border=this.opacity=this.backgroundColor=this.contentHTML=this.size=this.lonlat=this.id=null;this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide);this.events.destroy();this.events=null;this.closeDiv&&(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv));this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;null!=this.map&&this.map.removePopup(this);this.panMapIfOutOfView=this.padding=this.maxSize=this.minSize=this.autoSize=this.div=this.map=null},draw:function(b){null==b&&null!=this.lonlat&&null!=this.map&&(b=this.map.getLayerPxFromLonLat(this.lonlat));this.closeOnMove&&this.map.events.register("movestart",this,this.hide);!this.disableFirefoxOverflowHack&&"firefox"==OpenLayers.BROWSER_NAME&&(this.map.events.register("movestart",this,function(){var c=document.defaultView.getComputedStyle(this.contentDiv,null).getPropertyValue("overflow");"hidden"!=c&&(this.contentDiv._oldOverflow=c,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var c=this.contentDiv._oldOverflow;c&&(this.contentDiv.style.overflow=c,this.contentDiv._oldOverflow=null)}));this.moveTo(b);!this.autoSize&&!this.size&&this.setSize(this.contentSize);this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();this.panMapIfOutOfView&&this.panIntoView();return this.div},updatePosition:function(){if(this.lonlat&&this.map){var b=this.map.getLayerPxFromLonLat(this.lonlat);b&&this.moveTo(b)}},moveTo:function(b){null!=b&&null!=this.div&&(this.div.style.left=b.x+"px",this.div.style.top=b.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="";this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(g){this.size=g.clone();var f=this.getContentDivPadding(),j=f.left+f.right,i=f.top+f.bottom;this.fixPadding();j+=this.padding.left+this.padding.right;i+=this.padding.top+this.padding.bottom;if(this.closeDiv){var h=parseInt(this.closeDiv.style.width),j=j+(h+f.right)}this.size.w+=j;this.size.h+=i;"msie"==OpenLayers.BROWSER_NAME&&(this.contentSize.w+=f.left+f.right,this.contentSize.h+=f.bottom+f.top);null!=this.div&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px");null!=this.contentDiv&&(this.contentDiv.style.width=g.w+"px",this.contentDiv.style.height=g.h+"px")},updateSize:function(){var g="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",f=this.map?this.map.div:document.body,j=OpenLayers.Util.getRenderedDimensions(g,null,{displayClass:this.displayClass,containerElement:f}),i=this.getSafeContentSize(j),h=null;i.equals(j)?h=j:(j={w:i.w<j.w?i.w:null,h:i.h<j.h?i.h:null},j.w&&j.h?h=i:(g=OpenLayers.Util.getRenderedDimensions(g,j,{displayClass:this.contentDisplayClass,containerElement:f}),"hidden"!=OpenLayers.Element.getStyle(this.contentDiv,"overflow")&&g.equals(i)&&(i=OpenLayers.Util.getScrollbarWidth(),j.w?g.h+=i:g.w+=i),h=this.getSafeContentSize(g)));this.setSize(h)},setBackgroundColor:function(b){void 0!=b&&(this.backgroundColor=b);null!=this.div&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(b){void 0!=b&&(this.opacity=b);null!=this.div&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")")},setBorder:function(b){void 0!=b&&(this.border=b);null!=this.div&&(this.div.style.border=this.border)},setContentHTML:function(b){null!=b&&(this.contentHTML=b);null!=this.contentDiv&&(null!=this.contentHTML&&this.contentHTML!=this.contentDiv.innerHTML)&&(this.contentDiv.innerHTML=this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){for(var g=function(){null!==this.popup.id&&(this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImageLoad))},f=this.contentDiv.getElementsByTagName("img"),j=0,i=f.length;j<i;j++){var h=f[j];if(0==h.width||0==h.height){h._onImgLoad=OpenLayers.Function.bind(g,{popup:this,img:h}),OpenLayers.Event.observe(h,"load",h._onImgLoad)}}},getSafeContentSize:function(g){var g=g.clone(),f=this.getContentDivPadding(),j=f.left+f.right,i=f.top+f.bottom;this.fixPadding();j+=this.padding.left+this.padding.right;i+=this.padding.top+this.padding.bottom;if(this.closeDiv){var h=parseInt(this.closeDiv.style.width),j=j+(h+f.right)}this.minSize&&(g.w=Math.max(g.w,this.minSize.w-j),g.h=Math.max(g.h,this.minSize.h-i));this.maxSize&&(g.w=Math.min(g.w,this.maxSize.w-j),g.h=Math.min(g.h,this.maxSize.h-i));if(this.map&&this.map.size){h=f=0;if(this.keepInMap&&!this.panMapIfOutOfView){switch(h=this.map.getPixelFromLonLat(this.lonlat),this.relativePosition){case"tr":f=h.x;h=this.map.size.h-h.y;break;case"tl":f=this.map.size.w-h.x;h=this.map.size.h-h.y;break;case"bl":f=this.map.size.w-h.x;h=h.y;break;case"br":f=h.x;h=h.y;break;default:f=h.x,h=this.map.size.h-h.y}}i=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-i-h;g.w=Math.min(g.w,this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-j-f);g.h=Math.min(g.h,i)}return g},getContentDivPadding:function(){var b=this._contentDivPadding;if(!b&&(null==this.div.parentNode&&(this.div.style.display="none",document.body.appendChild(this.div)),this._contentDivPadding=b=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top")),this.div.parentNode==document.body)){document.body.removeChild(this.div),this.div.style.display=""}return b},addCloseBox:function(d){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17});this.closeDiv.className="olPopupCloseBox";var c=this.getContentDivPadding();this.closeDiv.style.right=c.right+"px";this.closeDiv.style.top=c.top+"px";this.groupDiv.appendChild(this.closeDiv);d=d||function(b){this.hide();OpenLayers.Event.stop(b)};OpenLayers.Event.observe(this.closeDiv,"touchend",OpenLayers.Function.bindAsEventListener(d,this));OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(d,this))},panIntoView:function(){var e=this.map.getSize(),d=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),f=d.clone();d.x<this.map.paddingForPopups.left?f.x=this.map.paddingForPopups.left:d.x+this.size.w>e.w-this.map.paddingForPopups.right&&(f.x=e.w-this.map.paddingForPopups.right-this.size.w);d.y<this.map.paddingForPopups.top?f.y=this.map.paddingForPopups.top:d.y+this.size.h>e.h-this.map.paddingForPopups.bottom&&(f.y=e.h-this.map.paddingForPopups.bottom-this.size.h);this.map.pan(d.x-f.x,d.y-f.y)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,!0);this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:function(b){OpenLayers.Event.stop(b,!0)},scope:this})},onmousedown:function(b){this.mousedown=!0;OpenLayers.Event.stop(b,!0)},onmousemove:function(b){this.mousedown&&OpenLayers.Event.stop(b,!0)},onmouseup:function(b){this.mousedown&&(this.mousedown=!1,OpenLayers.Event.stop(b,!0))},onclick:function(b){OpenLayers.Event.stop(b,!0)},onmouseout:function(){this.mousedown=!1},ondblclick:function(b){OpenLayers.Event.stop(b,!0)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white";OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(i,h,n,m,l,k,j){OpenLayers.Popup.prototype.initialize.apply(this,[i,h,n,m,k,j]);this.anchor=null!=l?l:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.relativePosition=this.anchor=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(d){var c=this.relativePosition;this.relativePosition=this.calculateRelativePosition(d);d=this.calculateNewPx(d);OpenLayers.Popup.prototype.moveTo.apply(this,Array(d));this.relativePosition!=c&&this.updateRelativePosition()},setSize:function(b){OpenLayers.Popup.prototype.setSize.apply(this,arguments);this.lonlat&&this.map&&this.moveTo(this.map.getLayerPxFromLonLat(this.lonlat))},calculateRelativePosition:function(b){b=this.map.getLonLatFromLayerPx(b);b=this.map.getExtent().determineQuadrant(b);return OpenLayers.Bounds.oppositeQuadrant(b)},updateRelativePosition:function(){},calculateNewPx:function(e){var e=e.offset(this.anchor.offset),d=this.size||this.contentSize,f="t"==this.relativePosition.charAt(0);e.y+=f?-d.h:this.anchor.size.h;f="l"==this.relativePosition.charAt(1);e.x+=f?-d.w:this.anchor.size.w;return e},CLASS_NAME:"OpenLayers.Popup.Anchored"});OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(i,h,n,m,l,k,j){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);this.fixedRelativePosition&&(this.updateRelativePosition(),this.calculateRelativePosition=function(){return this.relativePosition});this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;k&&(this.closeDiv.style.zIndex=1);this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.isAlphaImage=this.imageSize=this.imageSrc=null;this.fixedRelativePosition=!1;this.positionBlocks=null;for(var d=0;d<this.blocks.length;d++){var c=this.blocks[d];c.image&&c.div.removeChild(c.image);c.image=null;c.div&&this.groupDiv.removeChild(c.div);c.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments)},setBackgroundColor:function(){},setBorder:function(){},setOpacity:function(){},setSize:function(b){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var b=this.getContentDivPadding();this.closeDiv.style.right=b.right+this.padding.right+"px";this.closeDiv.style.top=b.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(d){var c=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return c=c.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var e=null,d;for(d in this.positionBlocks){e=d;break}e=this.positionBlocks[e];for(d=0;d<e.blocks.length;d++){var f={};this.blocks.push(f);f.div=OpenLayers.Util.createDiv(this.id+"_FrameDecorationDiv_"+d,null,null,null,"absolute",null,"hidden",null);f.image=(this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage)(this.id+"_FrameDecorationImg_"+d,null,this.imageSize,this.imageSrc,"absolute",null,null,null);f.div.appendChild(f.image);this.groupDiv.appendChild(f.div)}},updateBlocks:function(){this.blocks||this.createBlocks();if(this.size&&this.relativePosition){for(var t=this.positionBlocks[this.relativePosition],s=0;s<t.blocks.length;s++){var r=t.blocks[s],q=this.blocks[s],p=r.anchor.left,o=r.anchor.bottom,n=r.anchor.right,m=r.anchor.top,l=isNaN(r.size.w)?this.size.w-(n+p):r.size.w,k=isNaN(r.size.h)?this.size.h-(o+m):r.size.h;q.div.style.width=(0>l?0:l)+"px";q.div.style.height=(0>k?0:k)+"px";q.div.style.left=null!=p?p+"px":"";q.div.style.bottom=null!=o?o+"px":"";q.div.style.right=null!=n?n+"px":"";q.div.style.top=null!=m?m+"px":"";q.image.style.left=r.position.x+"px";q.image.style.top=r.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){this.type||(this.type=google.maps.MapTypeId.ROADMAP);var d,c=OpenLayers.Layer.Google.cache[this.map.id];c?(d=c.mapObject,++c.count):(c=this.map.viewPortDiv,d=document.createElement("div"),d.id=this.map.id+"_GMapContainer",d.style.position="absolute",d.style.width="100%",d.style.height="100%",c.appendChild(d),c=this.map.getCenter(),d=new google.maps.Map(d,{center:c?new google.maps.LatLng(c.lat,c.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1}),c={mapObject:d,count:1},OpenLayers.Layer.Google.cache[this.map.id]=c,this.repositionListener=google.maps.event.addListenerOnce(d,"center_changed",OpenLayers.Function.bind(this.repositionMapElements,this)));this.mapObject=d;this.setGMapVisibility(this.visibility)},repositionMapElements:function(){google.maps.event.trigger(this.mapObject,"resize");var g=this.mapObject.getDiv().firstChild;if(!g||3>g.childNodes.length){return this.repositionTimer=window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements,this),250),!1}for(var f=OpenLayers.Layer.Google.cache[this.map.id],j=this.map.viewPortDiv,i=g.children.length-1;0<=i;--i){if(1000001==g.children[i].style.zIndex){var h=g.children[i];j.appendChild(h);h.style.zIndex="1100";h.style.bottom="";h.className="olLayerGoogleCopyright olLayerGoogleV3";h.style.display="";f.termsOfUse=h}1000000==g.children[i].style.zIndex&&(h=g.children[i],j.appendChild(h),h.style.zIndex="1100",h.style.bottom="",h.className="olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint",h.style.display="",f.poweredBy=h);10000002==g.children[i].style.zIndex&&j.appendChild(g.children[i])}this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility){google.maps.event.trigger(this.mapObject,"resize")}else{var d=OpenLayers.Layer.Google.cache[this.map.id];if(!d.resized){var c=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){google.maps.event.trigger(c.mapObject,"resize");c.moveTo(c.map.getCenter(),c.map.getZoom());delete d.resized})}d.resized=!0}},setGMapVisibility:function(h){var g=OpenLayers.Layer.Google.cache[this.map.id];if(g){for(var l=this.type,k=this.map.layers,j,i=k.length-1;0<=i;--i){if(j=k[i],j instanceof OpenLayers.Layer.Google&&!0===j.visibility&&!0===j.inRange){l=j.type;h=!0;break}}k=this.mapObject.getDiv();!0===h?(this.mapObject.setMapTypeId(l),k.style.left="",g.termsOfUse&&g.termsOfUse.style&&(g.termsOfUse.style.left="",g.termsOfUse.style.display="",g.poweredBy.style.display=""),g.displayed=this.id):(delete g.displayed,k.style.left="-9999px",g.termsOfUse&&g.termsOfUse.style&&(g.termsOfUse.style.display="none",g.termsOfUse.style.left="-9999px",g.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(d){var c=null;null!=d&&(c=this.sphericalMercator?this.inverseMercator(d.bottom,d.left):new OpenLayers.LonLat(d.bottom,d.left),d=this.sphericalMercator?this.inverseMercator(d.top,d.right):new OpenLayers.LonLat(d.top,d.right),c=new google.maps.LatLngBounds(new google.maps.LatLng(c.lat,c.lon),new google.maps.LatLng(d.lat,d.lon)));return c},getMapObjectLonLatFromMapObjectPixel:function(g){var f=this.map.getSize(),j=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),i=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),h=this.map.getResolution(),g=new OpenLayers.LonLat(j+(g.x-f.w/2)*h,i-(g.y-f.h/2)*h);this.wrapDateLine&&(g=g.wrapDateLine(this.maxExtent));return this.getMapObjectLonLatFromLonLat(g.lon,g.lat)},getMapObjectPixelFromMapObjectLonLat:function(f){var e=this.getLongitudeFromMapObjectLonLat(f),f=this.getLatitudeFromMapObjectLonLat(f),h=this.map.getResolution(),g=this.map.getExtent();return this.getMapObjectPixelFromXY(1/h*(e-g.left),1/h*(g.top-f))},setMapObjectCenter:function(e,d){if(!1===this.animationEnabled&&d!=this.mapObject.zoom){var f=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){f.style.visibility=""});f.style.visibility="hidden"}this.mapObject.setOptions({center:e,zoom:d})},getMapObjectZoomFromMapObjectBounds:function(b){return this.mapObject.getBoundsZoomLevel(b)},getMapObjectLonLatFromLonLat:function(e,d){var f;this.sphericalMercator?(f=this.inverseMercator(e,d),f=new google.maps.LatLng(f.lat,f.lon)):f=new google.maps.LatLng(d,e);return f},getMapObjectPixelFromXY:function(d,c){return new google.maps.Point(d,c)},destroy:function(){this.repositionListener&&google.maps.event.removeListener(this.repositionListener);this.repositionTimer&&window.clearTimeout(this.repositionTimer);OpenLayers.Layer.Google.prototype.destroy.apply(this,arguments)}};OpenLayers.ProxyHost="";OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(g,f){var j=0!==g.indexOf("http"),i=!j&&g.match(this.URL_SPLIT_REGEX);if(i){var h=window.location,j=i[1]==h.protocol&&i[3]==h.hostname,i=i[4],h=h.port;if(80!=i&&""!=i||"80"!=h&&""!=h){j=j&&i==h}}j||(f?g="function"==typeof f?f(g):f+encodeURIComponent(g):OpenLayers.Console.warn(OpenLayers.i18n("proxyNeeded"),{url:g}));return g},issue:function(j){var i=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost}),j=OpenLayers.Util.applyDefaults(j,i),i=!1,p;for(p in j.headers){j.headers.hasOwnProperty(p)&&"x-requested-with"===p.toLowerCase()&&(i=!0)}!1===i&&(j.headers["X-Requested-With"]="XMLHttpRequest");var o=new OpenLayers.Request.XMLHttpRequest,n=OpenLayers.Util.urlAppend(j.url,OpenLayers.Util.getParameterString(j.params||{})),n=OpenLayers.Request.makeSameOrigin(n,j.proxy);o.open(j.method,n,j.async,j.user,j.password);for(var m in j.headers){o.setRequestHeader(m,j.headers[m])}var l=this.events,k=this;o.onreadystatechange=function(){o.readyState==OpenLayers.Request.XMLHttpRequest.DONE&&!1!==l.triggerEvent("complete",{request:o,config:j,requestUrl:n})&&k.runCallbacks({request:o,config:j,requestUrl:n})};!1===j.async?o.send(j.data):window.setTimeout(function(){0!==o.readyState&&o.send(j.data)},0);return o},runCallbacks:function(h){var g=h.request,l=h.config,k=l.scope?OpenLayers.Function.bind(l.callback,l.scope):l.callback,j;l.success&&(j=l.scope?OpenLayers.Function.bind(l.success,l.scope):l.success);var i;l.failure&&(i=l.scope?OpenLayers.Function.bind(l.failure,l.scope):l.failure);"file:"==OpenLayers.Util.createUrlObject(l.url).protocol&&g.responseText&&(g.status=200);k(g);if(!g.status||200<=g.status&&300>g.status){this.events.triggerEvent("success",h),j&&j(g)}if(g.status&&(200>g.status||300<=g.status)){this.events.triggerEvent("failure",h),i&&i(g)}},GET:function(b){b=OpenLayers.Util.extend(b,{method:"GET"});return OpenLayers.Request.issue(b)},POST:function(b){b=OpenLayers.Util.extend(b,{method:"POST"});b.headers=b.headers?b.headers:{};"CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(b.headers)||(b.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(b)},PUT:function(b){b=OpenLayers.Util.extend(b,{method:"PUT"});b.headers=b.headers?b.headers:{};"CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(b.headers)||(b.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(b)},DELETE:function(b){b=OpenLayers.Util.extend(b,{method:"DELETE"});return OpenLayers.Request.issue(b)},HEAD:function(b){b=OpenLayers.Util.extend(b,{method:"HEAD"});return OpenLayers.Request.issue(b)},OPTIONS:function(b){b=OpenLayers.Util.extend(b,{method:"OPTIONS"});return OpenLayers.Request.issue(b)}};(function(){function r(){this._object=m&&!j?new m:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function q(){return new r}function p(b){q.onreadystatechange&&q.onreadystatechange.apply(b);b.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function o(z){try{z.responseText=z._object.responseText}catch(y){}try{var x;var w=z._object,v=w.responseXML,u=w.responseText;k&&(u&&v&&!v.documentElement&&w.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/))&&(v=new window.ActiveXObject("Microsoft.XMLDOM"),v.async=!1,v.validateOnParse=!1,v.loadXML(u));x=v&&(k&&0!=v.parseError||!v.documentElement||v.documentElement&&"parsererror"==v.documentElement.tagName)?null:v;z.responseXML=x}catch(t){}try{z.status=z._object.status}catch(s){}try{z.statusText=z._object.statusText}catch(h){}}function n(b){b._object.onreadystatechange=new window.Function}var m=window.XMLHttpRequest,l=!!window.controllers,k=window.document.all&&!window.opera,j=k&&window.navigator.userAgent.match(/MSIE 7.0/);q.prototype=r.prototype;l&&m.wrapped&&(q.wrapped=m.wrapped);q.UNSENT=0;q.OPENED=1;q.HEADERS_RECEIVED=2;q.LOADING=3;q.DONE=4;q.prototype.readyState=q.UNSENT;q.prototype.responseText="";q.prototype.responseXML=null;q.prototype.status=0;q.prototype.statusText="";q.prototype.priority="NORMAL";q.prototype.onreadystatechange=null;q.onreadystatechange=null;q.onopen=null;q.onsend=null;q.onabort=null;q.prototype.open=function(d,h,e,b,c){delete this._headers;arguments.length<3&&(e=true);this._async=e;var t=this,g=this.readyState,s;if(k&&e){s=function(){if(g!=q.DONE){n(t);t.abort()}};window.attachEvent("onunload",s)}q.onopen&&q.onopen.apply(this,arguments);arguments.length>4?this._object.open(d,h,e,b,c):arguments.length>3?this._object.open(d,h,e,b):this._object.open(d,h,e);this.readyState=q.OPENED;p(this);this._object.onreadystatechange=function(){if(!l||e){t.readyState=t._object.readyState;o(t);if(t._aborted){t.readyState=q.UNSENT}else{if(t.readyState==q.DONE){delete t._data;n(t);k&&e&&window.detachEvent("onunload",s)}g!=t.readyState&&p(t);g=t.readyState}}}};q.prototype.send=function(b){q.onsend&&q.onsend.apply(this,arguments);arguments.length||(b=null);if(b&&b.nodeType){b=window.XMLSerializer?(new window.XMLSerializer).serializeToString(b):b.xml;this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")}this._data=b;b:{this._object.send(this._data);if(l&&!this._async){this.readyState=q.OPENED;for(o(this);this.readyState<q.DONE;){this.readyState++;p(this);if(this._aborted){break b}}}}};q.prototype.abort=function(){q.onabort&&q.onabort.apply(this,arguments);if(this.readyState>q.UNSENT){this._aborted=true}this._object.abort();n(this);this.readyState=q.UNSENT;delete this._data};q.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};q.prototype.getResponseHeader=function(b){return this._object.getResponseHeader(b)};q.prototype.setRequestHeader=function(d,c){if(!this._headers){this._headers={}}this._headers[d]=c;return this._object.setRequestHeader(d,c)};q.prototype.addEventListener=function(g,f,s){for(var i=0,h;h=this._listeners[i];i++){if(h[0]==g&&h[1]==f&&h[2]==s){return}}this._listeners.push([g,f,s])};q.prototype.removeEventListener=function(g,f,s){for(var i=0,h;h=this._listeners[i];i++){if(h[0]==g&&h[1]==f&&h[2]==s){break}}h&&this._listeners.splice(i,1)};q.prototype.dispatchEvent=function(e){e={type:e.type,target:this,currentTarget:this,eventPhase:2,bubbles:e.bubbles,cancelable:e.cancelable,timeStamp:e.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};e.type=="readystatechange"&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[e]);for(var d=0,f;f=this._listeners[d];d++){f[0]==e.type&&!f[2]&&(f[1].handleEvent||f[1]).apply(this,[e])}};q.prototype.toString=function(){return"[object XMLHttpRequest]"};q.toString=function(){return"[XMLHttpRequest]"};window.Function.prototype.apply||(window.Function.prototype.apply=function(d,c){c||(c=[]);d.__func=this;d.__func(c[0],c[1],c[2],c[3],c[4]);delete d.__func});OpenLayers.Request.XMLHttpRequest=q})();OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(b){OpenLayers.Filter.prototype.initialize.apply(this,[b]);this.type===OpenLayers.Filter.Comparison.LIKE&&void 0===b.matchCase&&(this.matchCase=null)},evaluate:function(d){d instanceof OpenLayers.Feature.Vector&&(d=d.attributes);var c=!1,d=d[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:c=this.value;c=!this.matchCase&&"string"==typeof d&&"string"==typeof c?d.toUpperCase()==c.toUpperCase():d==c;break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:c=this.value;c=!this.matchCase&&"string"==typeof d&&"string"==typeof c?d.toUpperCase()!=c.toUpperCase():d!=c;break;case OpenLayers.Filter.Comparison.LESS_THAN:c=d<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:c=d>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:c=d<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:c=d>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:c=d>=this.lowerBoundary&&d<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:c=RegExp(this.value,"gi").test(d)}return c},value2regex:function(e,d,f){if("."==e){throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison")}e=e?e:"*";d=d?d:".";this.value=this.value.replace(RegExp("\\"+(f?f:"!")+"(.|$)","g"),"\\$1");this.value=this.value.replace(RegExp("\\"+d,"g"),".");this.value=this.value.replace(RegExp("\\"+e,"g"),".*");this.value=this.value.replace(RegExp("\\\\.\\*","g"),"\\"+e);return this.value=this.value.replace(RegExp("\\\\\\.","g"),"\\"+d)},regex2value:function(){var b=this.value,b=b.replace(/!/g,"!!"),b=b.replace(/(\\)?\\\./g,function(d,e){return e?d:"!."}),b=b.replace(/(\\)?\\\*/g,function(d,e){return e?d:"!*"}),b=b.replace(/\\\\/g,"\\");return b=b.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(i,h,n,m,l,k,j){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png");OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(b){this.symbolizer={};OpenLayers.Util.extend(this,b);this.symbolizers&&delete this.symbolizer;this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var b in this.symbolizer){this.symbolizer[b]=null}this.symbolizer=null;delete this.symbolizers},evaluate:function(f){var e=this.getContext(f),h=!0;if(this.minScaleDenominator||this.maxScaleDenominator){var g=f.layer.map.getScale()}this.minScaleDenominator&&(h=g>=OpenLayers.Style.createLiteral(this.minScaleDenominator,e));h&&this.maxScaleDenominator&&(h=g<OpenLayers.Style.createLiteral(this.maxScaleDenominator,e));h&&this.filter&&(h="OpenLayers.Filter.FeatureId"==this.filter.CLASS_NAME?this.filter.evaluate(f):this.filter.evaluate(e));return h},getContext:function(d){var c=this.context;c||(c=d.attributes||d.data);"function"==typeof this.context&&(c=this.context(d));return c},clone:function(){var f=OpenLayers.Util.extend({},this);if(this.symbolizers){var e=this.symbolizers.length;f.symbolizers=Array(e);for(var h=0;h<e;++h){f.symbolizers[h]=this.symbolizers[h].clone()}}else{f.symbolizer={};for(var g in this.symbolizer){e=this.symbolizer[g],h=typeof e,"object"===h?f.symbolizer[g]=OpenLayers.Util.extend({},e):"string"===h&&(f.symbolizer[g]=e)}}f.filter=this.filter&&this.filter.clone();f.context=this.context&&OpenLayers.Util.extend({},this.context);return new OpenLayers.Rule(f)},CLASS_NAME:"OpenLayers.Rule"});OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(g){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var f=document.createStyleSheet(),j="shape rect oval fill stroke imagedata group textbox".split(" "),i=0,h=j.length;i<h;i++){f.addRule("olv\\:"+j[i],"behavior: url(#default#VML); position: absolute; display: inline-block;")}}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)}},supported:function(){return !!document.namespaces},setExtent:function(i,h){var n=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),m=this.getResolution(),l=i.left/m|0,m=i.top/m-this.size.h|0;h||!this.offset?(this.offset={x:l,y:m},m=l=0):(l-=this.offset.x,m-=this.offset.y);this.root.coordorigin=l-this.xOffset+" "+m;for(var l=[this.root,this.vectorRoot,this.textRoot],k=0,j=l.length;k<j;++k){m=l[k],m.coordsize=this.size.w+" "+this.size.h}this.root.style.flip="y";return n},setSize:function(i){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var h=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],n=this.size.w+"px",m=this.size.h+"px",l,k=0,j=h.length;k<j;++k){l=h[k],l.style.width=n,l.style.height=m}},getNodeType:function(e,d){var f=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":f=d.externalGraphic?"olv:rect":this.isComplexSymbol(d.graphicName)?"olv:shape":"olv:oval";break;case"OpenLayers.Geometry.Rectangle":f="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":f="olv:shape"}return f},setStyle:function(r,q,p,o){var q=q||r._style,p=p||r._options,n=q.fillColor;if("OpenLayers.Geometry.Point"===r._geometryClass){if(q.externalGraphic){p.isFilled=!0;q.graphicTitle&&(r.title=q.graphicTitle);var n=q.graphicWidth||q.graphicHeight,m=q.graphicHeight||q.graphicWidth,n=n?n:2*q.pointRadius,m=m?m:2*q.pointRadius,l=this.getResolution(),k=void 0!=q.graphicXOffset?q.graphicXOffset:-(0.5*n),j=void 0!=q.graphicYOffset?q.graphicYOffset:-(0.5*m);r.style.left=((o.x-this.featureDx)/l-this.offset.x+k|0)+"px";r.style.top=(o.y/l-this.offset.y-(j+m)|0)+"px";r.style.width=n+"px";r.style.height=m+"px";r.style.flip="y";n="none";p.isStroked=!1}else{this.isComplexSymbol(q.graphicName)?(m=this.importSymbol(q.graphicName),r.path=m.path,r.coordorigin=m.left+","+m.bottom,m=m.size,r.coordsize=m+","+m,this.drawCircle(r,o,q.pointRadius),r.style.flip="y"):this.drawCircle(r,o,q.pointRadius)}}p.isFilled?r.fillcolor=n:r.filled="false";o=r.getElementsByTagName("fill");o=0==o.length?null:o[0];if(p.isFilled){o||(o=this.createNode("olv:fill",r.id+"_fill"));o.opacity=q.fillOpacity;if("OpenLayers.Geometry.Point"===r._geometryClass&&q.externalGraphic&&(q.graphicOpacity&&(o.opacity=q.graphicOpacity),o.src=q.externalGraphic,o.type="frame",!q.graphicWidth||!q.graphicHeight)){o.aspect="atmost"}o.parentNode!=r&&r.appendChild(o)}else{o&&r.removeChild(o)}n=q.rotation;if(void 0!==n||void 0!==r._rotation){r._rotation=n,q.externalGraphic?(this.graphicRotate(r,k,j,q),o.opacity=0):"OpenLayers.Geometry.Point"===r._geometryClass&&(r.style.rotation=n||0)}k=r.getElementsByTagName("stroke");k=0==k.length?null:k[0];if(p.isStroked){if(k||(k=this.createNode("olv:stroke",r.id+"_stroke"),r.appendChild(k)),k.on=!0,k.color=q.strokeColor,k.weight=q.strokeWidth+"px",k.opacity=q.strokeOpacity,k.endcap="butt"==q.strokeLinecap?"flat":q.strokeLinecap||"round",q.strokeDashstyle){k.dashstyle=this.dashStyle(q)}}else{r.stroked=!1,k&&(k.on=!1)}"inherit"!=q.cursor&&null!=q.cursor&&(r.style.cursor=q.cursor);return r},graphicRotate:function(v,u,t,s){var s=s||v._style,r=s.rotation||0,q,p;if(!s.graphicWidth||!s.graphicHeight){var o=new Image;o.onreadystatechange=OpenLayers.Function.bind(function(){if("complete"==o.readyState||"interactive"==o.readyState){q=o.width/o.height,p=Math.max(2*s.pointRadius,s.graphicWidth||0,s.graphicHeight||0),u*=q,s.graphicWidth=p*q,s.graphicHeight=p,this.graphicRotate(v,u,t,s)}},this);o.src=s.externalGraphic}else{p=Math.max(s.graphicWidth,s.graphicHeight);q=s.graphicWidth/s.graphicHeight;var n=Math.round(s.graphicWidth||p*q),m=Math.round(s.graphicHeight||p);v.style.width=n+"px";v.style.height=m+"px";var l=document.getElementById(v.id+"_image");l||(l=this.createNode("olv:imagedata",v.id+"_image"),v.appendChild(l));l.style.width=n+"px";l.style.height=m+"px";l.src=s.externalGraphic;l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";l=r*Math.PI/180;r=Math.sin(l);l=Math.cos(l);r="progid:DXImageTransform.Microsoft.Matrix(M11="+l+",M12="+-r+",M21="+r+",M22="+l+",SizingMethod='auto expand')\n";(l=s.graphicOpacity||s.fillOpacity)&&1!=l&&(r+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+l+")\n");v.style.filter=r;r=new OpenLayers.Geometry.Point(-u,-t);n=(new OpenLayers.Bounds(0,0,n,m)).toGeometry();n.rotate(s.rotation,r);n=n.getBounds();v.style.left=Math.round(parseInt(v.style.left)+n.left)+"px";v.style.top=Math.round(parseInt(v.style.top)-n.bottom)+"px"}},postDraw:function(e){e.style.visibility="visible";var d=e._style.fillColor,f=e._style.strokeColor;"none"==d&&e.fillcolor!=d&&(e.fillcolor=d);"none"==f&&e.strokecolor!=f&&(e.strokecolor=f)},setNodeDimension:function(f,e){var h=e.getBounds();if(h){var g=this.getResolution(),h=new OpenLayers.Bounds((h.left-this.featureDx)/g-this.offset.x|0,h.bottom/g-this.offset.y|0,(h.right-this.featureDx)/g-this.offset.x|0,h.top/g-this.offset.y|0);f.style.left=h.left+"px";f.style.top=h.top+"px";f.style.width=h.getWidth()+"px";f.style.height=h.getHeight()+"px";f.coordorigin=h.left+" "+h.top;f.coordsize=h.getWidth()+" "+h.getHeight()}},dashStyle:function(b){b=b.strokeDashstyle;switch(b){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return b;default:return b=b.split(/[ ,]/),2==b.length?1*b[0]>=2*b[1]?"longdash":1==b[0]||1==b[1]?"dot":"dash":4==b.length?1*b[0]>=2*b[1]?"longdashdot":"dashdot":"solid"}},createNode:function(e,d){var f=document.createElement(e);d&&(f.id=d);f.unselectable="on";f.onselectstart=OpenLayers.Function.False;return f},nodeTypeCompare:function(g,f){var j=f,i=j.indexOf(":");-1!=i&&(j=j.substr(i+1));var h=g.nodeName,i=h.indexOf(":");-1!=i&&(h=h.substr(i+1));return j==h},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(b){return this.nodeFactory(this.container.id+b,"olv:group")},drawPoint:function(d,c){return this.drawCircle(d,c,1)},drawCircle:function(f,e,h){if(!isNaN(e.x)&&!isNaN(e.y)){var g=this.getResolution();f.style.left=((e.x-this.featureDx)/g-this.offset.x|0)-h+"px";f.style.top=(e.y/g-this.offset.y|0)-h+"px";e=2*h;f.style.width=e+"px";f.style.height=e+"px";return f}return !1},drawLineString:function(d,c){return this.drawLine(d,c,!1)},drawLinearRing:function(d,c){return this.drawLine(d,c,!0)},drawLine:function(r,q,p){this.setNodeDimension(r,q);for(var o=this.getResolution(),n=q.components.length,m=Array(n),l,k,j=0;j<n;j++){l=q.components[j],k=(l.x-this.featureDx)/o-this.offset.x|0,l=l.y/o-this.offset.y|0,m[j]=" "+k+","+l+" l "}r.path="m"+m.join("")+(p?" x e":" e");return r},drawPolygon:function(B,A){this.setNodeDimension(B,A);var z=this.getResolution(),y=[],x,w,v,u,t,s,r,n,p,q;x=0;for(w=A.components.length;x<w;x++){y.push("m");v=A.components[x].components;u=0===x;s=t=null;r=0;for(n=v.length;r<n;r++){p=v[r],q=(p.x-this.featureDx)/z-this.offset.x|0,p=p.y/z-this.offset.y|0,q=" "+q+","+p,y.push(q),0==r&&y.push(" l"),u||(t?t!=q&&(s?s!=q&&(u=!0):s=q):t=q)}y.push(u?" x ":" ")}y.push("e");B.path=y.join("");return B},drawRectangle:function(e,d){var f=this.getResolution();e.style.left=((d.x-this.featureDx)/f-this.offset.x|0)+"px";e.style.top=(d.y/f-this.offset.y|0)+"px";e.style.width=(d.width/f|0)+"px";e.style.height=(d.height/f|0)+"px";return e},drawText:function(h,g,l){var k=this.nodeFactory(h+this.LABEL_ID_SUFFIX,"olv:rect"),j=this.nodeFactory(h+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),i=this.getResolution();k.style.left=((l.x-this.featureDx)/i-this.offset.x|0)+"px";k.style.top=(l.y/i-this.offset.y|0)+"px";k.style.flip="y";j.innerText=g.label;"inherit"!=g.cursor&&null!=g.cursor&&(j.style.cursor=g.cursor);g.fontColor&&(j.style.color=g.fontColor);g.fontOpacity&&(j.style.filter="alpha(opacity="+100*g.fontOpacity+")");g.fontFamily&&(j.style.fontFamily=g.fontFamily);g.fontSize&&(j.style.fontSize=g.fontSize);g.fontWeight&&(j.style.fontWeight=g.fontWeight);g.fontStyle&&(j.style.fontStyle=g.fontStyle);!0===g.labelSelect&&(k._featureId=h,j._featureId=h,j._geometry=l,j._geometryClass=l.CLASS_NAME);j.style.whiteSpace="nowrap";j.inset="1px,0px,0px,0px";k.parentNode||(k.appendChild(j),this.textRoot.appendChild(k));g=g.labelAlign||"cm";1==g.length&&(g+="m");h=j.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[g.substr(0,1)];j=j.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[g.substr(1,1)];k.style.left=parseInt(k.style.left)-h-1+"px";k.style.top=parseInt(k.style.top)+j+"px"},moveRoot:function(d){var c=this.map.getLayer(d.container.id);c instanceof OpenLayers.Layer.Vector.RootContainer&&(c=this.map.getLayer(this.container.id));c&&c.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);c&&c.redraw()},importSymbol:function(i){var h=this.container.id+"-"+i,n=this.symbolCache[h];if(n){return n}n=OpenLayers.Renderer.symbol[i];if(!n){throw Error(i+" is not a valid symbol name")}for(var i=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),m=["m"],l=0;l<n.length;l+=2){var k=n[l],j=n[l+1];i.left=Math.min(i.left,k);i.bottom=Math.min(i.bottom,j);i.right=Math.max(i.right,k);i.top=Math.max(i.top,j);m.push(k);m.push(j);0==l&&m.push("l")}m.push("x e");n=m.join(" ");m=(i.getWidth()-i.getHeight())/2;0<m?(i.bottom-=m,i.top+=m):(i.left+=m,i.right-=m);n={path:n,size:i.getWidth(),left:i.left,bottom:i.bottom};return this.symbolCache[h]=n},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(b){b=b||{};OpenLayers.Util.extend(this,b);this.options=b},mergeWithDefaultFilter:function(b){return b&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,b]}):b||this.defaultFilter||void 0},destroy:function(){this.format=this.options=null},read:function(b){b=b||{};b.filter=this.mergeWithDefaultFilter(b.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(){},createCallback:function(e,d,f){return OpenLayers.Function.bind(function(){e.apply(this,[d,f])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(b){OpenLayers.Util.extend(this,b)},success:function(){return 0<this.code},CLASS_NAME:"OpenLayers.Protocol.Response"});OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(d){d=d||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var c=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=function(b,e){return c.write(b,e)}}},destroy:function(){this.headers=this.params=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(e){OpenLayers.Protocol.prototype.read.apply(this,arguments);e=e||{};e.params=OpenLayers.Util.applyDefaults(e.params,this.options.params);e=OpenLayers.Util.applyDefaults(e,this.options);e.filter&&this.filterToParams&&(e.params=this.filterToParams(e.filter,e.params));var d=void 0!==e.readWithPOST?e.readWithPOST:this.readWithPOST,f=new OpenLayers.Protocol.Response({requestType:"read"});d?(d=e.headers||{},d["Content-Type"]="application/x-www-form-urlencoded",f.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleRead,f,e),data:OpenLayers.Util.getParameterString(e.params),headers:d})):f.priv=OpenLayers.Request.GET({url:e.url,callback:this.createCallback(this.handleRead,f,e),params:e.params,headers:e.headers});return f},handleRead:function(d,c){this.handleResponse(d,c)},create:function(e,d){var d=OpenLayers.Util.applyDefaults(d,this.options),f=new OpenLayers.Protocol.Response({reqFeatures:e,requestType:"create"});f.priv=OpenLayers.Request.POST({url:d.url,callback:this.createCallback(this.handleCreate,f,d),headers:d.headers,data:this.format.write(e)});return f},handleCreate:function(d,c){this.handleResponse(d,c)},update:function(f,e){var e=e||{},h=e.url||f.url||this.options.url+"/"+f.fid,e=OpenLayers.Util.applyDefaults(e,this.options),g=new OpenLayers.Protocol.Response({reqFeatures:f,requestType:"update"});g.priv=OpenLayers.Request[this.updateWithPOST?"POST":"PUT"]({url:h,callback:this.createCallback(this.handleUpdate,g,e),headers:e.headers,data:this.format.write(f)});return g},handleUpdate:function(d,c){this.handleResponse(d,c)},"delete":function(g,f){var f=f||{},j=f.url||g.url||this.options.url+"/"+g.fid,f=OpenLayers.Util.applyDefaults(f,this.options),i=new OpenLayers.Protocol.Response({reqFeatures:g,requestType:"delete"}),h=this.deleteWithPOST?"POST":"DELETE",j={url:j,callback:this.createCallback(this.handleDelete,i,f),headers:f.headers};this.deleteWithPOST&&(j.data=this.format.write(g));i.priv=OpenLayers.Request[h](j);return i},handleDelete:function(d,c){this.handleResponse(d,c)},handleResponse:function(e,d){var f=e.priv;d.callback&&(200<=f.status&&300>f.status?("delete"!=e.requestType&&(e.features=this.parseFeatures(f)),e.code=OpenLayers.Protocol.Response.SUCCESS):e.code=OpenLayers.Protocol.Response.FAILURE,d.callback.call(d.scope,e))},parseFeatures:function(d){var c=d.responseXML;if(!c||!c.documentElement){c=d.responseText}return !c||0>=c.length?null:this.format.read(c)},commit:function(D,C){function B(f){for(var d=f.features?f.features.length:0,h=Array(d),g=0;g<d;++g){h[g]=f.features[g].fid}q.insertIds=h;A.apply(this,[f])}function A(b){this.callUserCallback(b,C);s=s&&b.success();y++;y>=r&&C.callback&&(q.code=s?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,C.callback.apply(C.scope,[q]))}var C=OpenLayers.Util.applyDefaults(C,this.options),z=[],y=0,x={};x[OpenLayers.State.INSERT]=[];x[OpenLayers.State.UPDATE]=[];x[OpenLayers.State.DELETE]=[];for(var w,v,u=[],t=0,p=D.length;t<p;++t){if(w=D[t],v=x[w.state]){v.push(w),u.push(w)}}var r=(0<x[OpenLayers.State.INSERT].length?1:0)+x[OpenLayers.State.UPDATE].length+x[OpenLayers.State.DELETE].length,s=!0,q=new OpenLayers.Protocol.Response({reqFeatures:u});w=x[OpenLayers.State.INSERT];0<w.length&&z.push(this.create(w,OpenLayers.Util.applyDefaults({callback:B,scope:this},C.create)));w=x[OpenLayers.State.UPDATE];for(t=w.length-1;0<=t;--t){z.push(this.update(w[t],OpenLayers.Util.applyDefaults({callback:A,scope:this},C.update)))}w=x[OpenLayers.State.DELETE];for(t=w.length-1;0<=t;--t){z.push(this["delete"](w[t],OpenLayers.Util.applyDefaults({callback:A,scope:this},C["delete"])))}return z},abort:function(b){b&&b.priv.abort()},callUserCallback:function(e,d){var f=d[e.requestType];f&&f.callback&&f.callback.call(f.scope,e)},CLASS_NAME:"OpenLayers.Protocol.HTTP"});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{roundedCorner:!1,roundedCornerColor:"darkblue",layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(b){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[];this.roundedCorner&&OpenLayers.Console.warn("roundedCorner option is deprecated")},destroy:function(){this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(b){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();this.outsideViewport||this.minimizeControl();this.redraw();return this.div},onButtonClick:function(b){b=b.buttonElement;b===this.minimizeDiv?this.minimizeControl():b===this.maximizeDiv?this.maximizeControl():b._layerSwitcher===this.id&&(b["for"]&&(b=document.getElementById(b["for"])),b.disabled||("radio"==b.type?(b.checked=!0,this.map.setBaseLayer(this.map.getLayer(b._layer))):(b.checked=!b.checked,this.updateMap())))},clearLayersArray:function(b){this[b+"LayersDiv"].innerHTML="";this[b+"Layers"]=[]},checkRedraw:function(){var g=!1;if(!this.layerStates.length||this.map.layers.length!=this.layerStates.length){g=!0}else{for(var f=0,j=this.layerStates.length;f<j;f++){var i=this.layerStates[f],h=this.map.layers[f];if(i.name!=h.name||i.inRange!=h.inRange||i.id!=h.id||i.visibility!=h.visibility){g=!0;break}}}return g},redraw:function(){if(!this.checkRedraw()){return this.div}this.clearLayersArray("base");this.clearLayersArray("data");var t=!1,s=!1,r=this.map.layers.length;this.layerStates=Array(r);for(var q=0;q<r;q++){var p=this.map.layers[q];this.layerStates[q]={name:p.name,visibility:p.visibility,inRange:p.inRange,id:p.id}}var o=this.map.layers.slice();this.ascending||o.reverse();q=0;for(r=o.length;q<r;q++){var p=o[q],n=p.isBaseLayer;if(p.displayInLayerSwitcher){n?s=!0:t=!0;var m=n?p==this.map.baseLayer:p.getVisibility(),l=document.createElement("input");l.id=this.id+"_input_"+p.name;l.name=n?this.id+"_baseLayers":p.name;l.type=n?"radio":"checkbox";l.value=p.name;l.checked=m;l.defaultChecked=m;l.className="olButton";l._layer=p.id;l._layerSwitcher=this.id;!n&&!p.inRange&&(l.disabled=!0);m=document.createElement("label");m["for"]=l.id;OpenLayers.Element.addClass(m,"labelSpan olButton");m._layer=p.id;m._layerSwitcher=this.id;!n&&!p.inRange&&(m.style.color="gray");m.innerHTML=p.name;m.style.verticalAlign=n?"bottom":"baseline";var k=document.createElement("br");(n?this.baseLayers:this.dataLayers).push({layer:p,inputElem:l,labelSpan:m});p=n?this.baseLayersDiv:this.dataLayersDiv;p.appendChild(l);p.appendChild(m);p.appendChild(k)}}this.dataLbl.style.display=t?"":"none";this.baseLbl.style.display=s?"":"none";return this.div},updateMap:function(){for(var e=0,d=this.baseLayers.length;e<d;e++){var f=this.baseLayers[e];f.inputElem.checked&&this.map.setBaseLayer(f.layer,!1)}e=0;for(d=this.dataLayers.length;e<d;e++){f=this.dataLayers[e],f.layer.setVisibility(f.inputElem.checked)}},maximizeControl:function(b){this.div.style.width="";this.div.style.height="";this.showControls(!1);null!=b&&OpenLayers.Event.stop(b)},minimizeControl:function(b){this.div.style.width="0px";this.div.style.height="0px";this.showControls(!0);null!=b&&OpenLayers.Event.stop(b)},showControls:function(b){this.maximizeDiv.style.display=b?"":"none";this.minimizeDiv.style.display=b?"none":"";this.layersDiv.style.display=b?"none":""},loadContents:function(){this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";OpenLayers.Element.addClass(this.layersDiv,"layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer");OpenLayers.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv");this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("Overlays");OpenLayers.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv");this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv));this.div.appendChild(this.layersDiv);this.roundedCorner&&(OpenLayers.Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.roundedCornerColor,blend:!1}),OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,0.75));var b=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,b,"absolute");OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton");this.maximizeDiv.style.display="none";this.div.appendChild(this.maximizeDiv);b=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,b,"absolute");OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton");this.minimizeDiv.style.display="none";this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});